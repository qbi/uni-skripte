% Einige zusätzliche Informationen für rubber
%  rubber erkennt nicht, dass die Datei weg kann, daher sagen wir es ihm
% rubber: clean $base.thm
%  rubber soll nach Änderungen an der Datei nochmal bauen
% rubber: watch $base.thm
% rubber: index.tool      xindy
% rubber: index.language  german-din
%
% scrreprt trifft am Besten die Bedürfnisse eines Skripts, das ganze wird
% zweiseitig (twoside), d.h. es wird zwischen linker und rechter Seite
% unterschieden, und wir verwenden zwischen den Absätzen einen Abstand
% von einer halben Zeile (halfparskip) und dafür keinen Absatzeinzug,
% wobei die letzte Zeile eines Absatzes zu min. 1/4 leer ist.

\RequirePackage[l2tabu,orthodox]{nag}  % nag überprüft den Text auf veraltete
                   % Befehle oder solche, die man nicht in LaTeX verwenden
                   % soll -- l2tabu-Checker in LaTeX
\RequirePackage[ngerman=ngerman-x-latest]{hyphsubst} % einbinden der neuen
                   % Trennmuster, diese korrigieren einige Fehler der alten
                   % und bieten mehr Trennstellen

\documentclass[ngerman,draft,parskip=half*,twoside]{scrreprt}

\usepackage{ifthen}
%\usepackage{index}
\usepackage[final]{graphicx}  % Für Grafiken
\usepackage{xcolor}
\usepackage[draft=false,colorlinks,bookmarksnumbered,linkcolor=blue,breaklinks]{hyperref}

\usepackage[latin1]{inputenc}
\usepackage{babel}
% \usepackage{nicefrac}
% \usepackage{tabularx}

\usepackage{lmodern}		% Latin Modern
% \usepackage{type1ec}           % cm-super
\usepackage[T1]{fontenc}        % T1-Schriften notwendig für PDFs
\usepackage{textcomp}           % wird benötigt, damit der \textbullet
                                % für itemize in lmodern gefunden wird.

\usepackage[intlimits,leqno]{amsmath}
\usepackage[all,warning]{onlyamsmath}  % warnt bei Verwendung von nicht
                                       % amsmath-Umgebungen z.\,B. $$...$$
\usepackage{amssymb}     % wird für \R, \C,... gebraucht
\usepackage{fixmath}     % ISO-konforme griech. Buchstaben
\usepackage[euro]{isonums} % definiert Komma als Dezimaltrennzeichen

\usepackage[amsmath,thmmarks,hyperref]{ntheorem} % für die Theorem-Umgebungen
                                                 % (satz, defini, bemerk)
\usepackage{xspace}      % wird weiter unten gebraucht
\usepackage{slashbox}    % für schräge Striche links oben in der
                         % Tabelle; s. texdoc slashbox

\usepackage{paralist}    % besseres enumerate und itemize und neue
                         % compactenum/compactitem; s. texdoc paralist

\usepackage{svn}         % Zum Auswerten und ordentlichen Darstellen der
                         % SVN-Schlüsselwörter (s. vor \begin{document})
                         % dafür muss in SVN noch das Flag svn:keywords
                         % auf "LastChangedRevision LastChangedDate"
                         % gesetzt werden
% \usepackage{ifpdf}       % Erkennung, ob PDF generiert wird; nützlich zur
                         % Unterscheidung bei Grafiken \input{XYZ.pdf_t}
\usepackage{ellipsis}    % Korrektur für \dots
\usepackage{fixltx2e}
\usepackage[final,babel]{microtype} % Verbesserung der Typographie
\usepackage{mathtools}   % Zur Definition von \abs und \norm
\usepackage[babel]{csquotes}
\usepackage[algochapter,linesnumbered]{algorithm2e}
\usepackage{todonotes}   % definiert den Befehl \todo{} um sich leicht
                         % Markierungen für offene Aufgaben zu setzen; wird
                         % auch für \help (s.u.) verwendet


% Damit auch die Zeichen im Mathemode in Überschriften fett sind
% <news:lzfyyvx3pt.fsf@tfkp12.physik.uni-erlangen.de>
\addtokomafont{sectioning}{\boldmath}

% nach dem Theoremkopf wird ein Zeilenumbruch eingefügt, die Schrift des
% Körpers ist normal und der Kopf wird fett gesetzt
\theoremstyle{break}
\theoremnumbering{arabic}
\theorembodyfont{\normalfont}
\theoremheaderfont{\normalfont\bfseries}

% Das Ende von Umgebungen, für die kein Beweis erbracht wurde, soll mit einer
% leeren Box gekennzeichnet werden. Wenn jedoch ein Beweis erbracht wurde,
% soll kein Zeichen ausgegeben werden (die ausgefüllte Box vom proof wird
% verwendet); man beachte die spezielle Definition von \theoremheaderfont für
% die Umgebung proof
% \newboolean{hasproof}
% \theoremheaderfont{\global\hasprooffalse\normalfont\bfseries}
% \theoremsymbol{\ifthenelse{\boolean{hasproof}}{}{\ensuremath{_\Box}}}

% Die folgenden Umgebungen werden einzeln nummeriert und am Ende jedes
% Kapitels zurückgesetzt
\newtheorem{satz}{Satz}[chapter]
\newtheorem{lemma}{Lemma}[chapter]
\newtheorem{thrm}{Theorem}[chapter]
\newtheorem{bemerk}{Bemerkung}[chapter]
\newtheorem{defini}{Definition}[chapter]
\newtheorem{bsp}{Beispiel}[chapter]
%\newtheorem{festl}{Festlegung}[chapter]

% Die folgenden Theoremumgebungen bekommen keine Nummer
\theoremstyle{nonumberbreak}
\newtheorem{fakt}{Fakt}
\newtheorem{eigen}{Eigenschaften}
\newtheorem{folg}{Folgerung}
\newtheorem{beob}{Beobachtung}
\newtheorem{beha}{Behauptung}


% \theoremheaderfont{\global\hasprooftrue\scshape}
\theoremheaderfont{\scshape}
\theorembodyfont{\normalfont}
% Das Zeichen am Ende eines Beweises
\theoremsymbol{\ensuremath{_\blacksquare}}
% \theoremsymbol{q.\,e.\,d.}
\newtheorem{proof}{Beweis:}

% Hier die Definition, wie \autoref die Umgebungen nennen soll, die mit
% \newtheorem definiert wurden
\newcommand*{\satzautorefname}{Satz}
\newcommand*{\bemerkautorefname}{Bemerkung}
\newcommand*{\definiautorefname}{Definition}
\newcommand*{\bspautorefname}{Beispiel}
\newcommand*{\lemmaautorefname}{Lemma}
\newcommand*{\thrmautorefname}{Theorem}
%\newcommand*{\festlautorefname}{Festlegung}
% Zwischen Unter- und Unterunterabschnitten sollte nicht unterschieden
% werden.
\renewcommand*{\subsectionautorefname}{Abschnitt}
\renewcommand*{\subsubsectionautorefname}{Abschnitt}

\pagestyle{headings}

\newcommand*{\R}{\mathbb{R}}      % reelle Zahlen
\newcommand*{\C}{\mathbb{C}}      % komplexe Zahlen
%\newcommand*{\N}{\mathbb{N}}      % natürliche Zahlen
%\newcommand*{\Q}{\mathbb{Q}}      % gebrochene Zahlen
\newcommand*{\Z}{\mathbb{Z}}      % ganze Zahlen

% Wenn irgendwo Unklarheiten zum Inhalt im Skript auftreten, können sie
% einfach mit \help{Ich verstehe das nicht} hervorgehoben werden. Dies
% macht es leichter sie alle zu finden und auch ganz einfach
% auszublenden, indem man den Befehl einfach leer definiert
\newcommand*{\help}[1]{\todo[color=green!40]{#1}}

% Um wichtige Begriffe im Text überall gleich vorzuheben (gleiches
% Markup), sollte dieser Befehl verwendet werden. Das Argument wird
% automatisch als Indexeintrag verwendet. Dieser kann aber auch als
% optionales Argument selbst bestimmt werden.
% \newcommand*{\highl}[2][]{\textbf{\boldmath{#2}}%
%   \ifthenelse{\equal{#1}{}}{\index{#2}}{\index{#1}}%
% }

% Befehl für die Darstellung der Gliederungsüberschriften im Index
\newcommand*{\lettergroup}[1]{\minisec{#1}}

% Für Leute, die nicht gern o.\,B.\,d.\,A. jedesmal eintippen wollen
\newcommand*{\obda}{o.\,B.\,d.\,A.\xspace}

% Diese Befehle sind dafür gedacht, dass die Symbole für "genau dann wenn"
% im ganzen Dokument gleich aussehen. Außerdem erlaubt es eine schnelle
% Veränderung aller Stellen, falls der Prof. doch nicht mehr gdw nimmt,
% sondern \Leftrightarrow.
\newcommand*{\gdw}{\ifthenelse{\boolean{mmode}}%
			       {\mspace{8mu}gdw\mspace{8mu}}%
			       {$gdw$\xspace}}
% \newcommand*{\gdwdef}{\ifthenelse{\boolean{mmode}}%
% 			       {\mspace{8mu}gdw_{def}\mspace{8mu}}%
% 			       {$gdw_{def}$\xspace}}

% Um sicherzustellen, dass jeder Betrag/jede Norm links und rechts die
% Striche bekommt, sind diese Befehle da. Damit kann man nicht die
% rechten Striche vergessen und es wird etwas übersichtlicher. Aus
% mathtools.pdf, z. B. \abs[\big]{\abs{a}-\abs{b}} \leq \abs{a+b}
\DeclarePairedDelimiter{\abs}{\lvert}{\rvert}
\DeclarePairedDelimiter{\norm}{\lVert}{\rVert}
\DeclarePairedDelimiter{\sprod}{\langle}{\rangle}

% Das original Epsilon sieht nicht so toll aus
\renewcommand*{\epsilon}{\varepsilon}
% ... und mancheinem gefällt auch das Phi nicht
\renewcommand*{\phi}{\varphi}

\DeclareMathOperator{\conv}{conv}      % konvexe Hülle

\makeindex

\SVN $LastChangedRevision$
\SVN $LastChangedDate$

\begin{document}

\title{Algorithmische Geometrie}
\author{Joachim Giesen}
\date{Semester: WS 2008/09}
\maketitle

\clearpage
\chapter*{Vorwort}

{\itshape
  Dieses Dokument wurde als Skript für die auf der
  Titelseite genannte Vorlesung erstellt und wird jetzt im Rahmen des
  Projekts
  \enquote{\href{http://uni-skripte.lug-jena.de/}
  {Vorlesungsskripte der Fakultät für Mathematik}
  \href{http://uni-skripte.lug-jena.de/}{und Informatik}}
  weiter betreut. Das
  Dokument wurde nach bestem Wissen und Gewissen angefertigt. Dennoch
  garantiert weder der auf der Titelseite genannte Dozent, die Personen,
  die an dem Dokument mitgewirkt haben, noch die
  Mitglieder des Projekts für dessen Fehlerfreiheit. Für etwaige Fehler
  und dessen Folgen wird von keiner der genannten Personen eine Haftung
  übernommen. Es steht jeder Person frei, dieses Dokument zu lesen, zu
  verändern oder auf anderen Medien verfügbar zu machen, solange ein
  Verweis auf die Internetadresse des Projekts
  \url{http://uni-skripte.lug-jena.de/}
  enthalten ist.

  Diese Ausgabe trägt die Versionsnummer~\SVNLastChangedRevision{} und ist vom
  \SVNDate{}. Eine neue Ausgabe könnte auf der Webseite des Projekts verfügbar
  sein.

  Jeder ist dazu aufgerufen, Verbesserungen, Erweiterungen und
  Fehlerkorrekturen für das Skript einzureichen bzw. zu melden oder diese
  selbst einzupflegen -- einfach eine E-Mail an die
  \href{mailto:uni-skripte@lug-jena.de}{Mailingliste
  \nolinkurl{<uni-skripte@lug-jena.de>}} senden. Weitere Informationen
  sind unter der oben genannten Internetadresse verfügbar.

  Hiermit möchten wir allen Personen, die an diesem Skript mitgewirkt
  haben, vielmals danken:
  \begin{itemize}
   \item \href{mailto:sietschie@gmail.com}{Christoph Göring
    \nolinkurl{<sietschie@gmail.com>}} (Jahr)
  \end{itemize}
}

\clearpage
\pdfbookmark[0]{Inhaltsverzeichnis}{inhaltsverzeichnis}
\tableofcontents

\clearpage
\pdfbookmark[0]{Auflistung der Sätze}{theoremlist}
\chapter*{Auflistung der Theoreme}

\pdfbookmark[1]{Sätze}{satzlist}
\section*{Sätze}
\theoremlisttype{optname}
\listtheorems{satz}

\pdfbookmark[1]{Definitionen und Festlegungen}{definilist}
\section*{Definitionen und Festlegungen}
% \theoremlisttype{all}
\listtheorems{defini,festl}


%Inhalt:

%1. Grundlagen
%- Hyperebenen, Halbräume
%- Bälle
%- Konvexe Mengen

%2. Geometrische Prädikate
%- Floating point vs exakte arithmetik

%3. Konvexe Hüllen, Delaunay-Diagramme, Voronoi-Diagramme

%4. Flächenrekonstruktion im $R^3$ (selbst implementieren), Meshing

%5. Geometrische Datenanalyse
%- Alpha Shapes
%- Flow Shapes



\chapter{Grundlagen}

\section{Affine Geometrie}

Voraussetzung: Lineare Algebra im $\R^d$

\begin{defini}[Affiner Unterraum]
Eine Teilmenge nennt man affiner Unterraum, wenn entweder $A = \emptyset$ oder $A$ ist ein \enquote{verschobener} linearer Unterraum.
Das heißt $A = V + L$, wobei $L$ ein linearer Unterraum des $\R^d$ ist und $v \in \R^d$ ein Vektor.
\end{defini}

\begin{bsp}

\begin{itemize}
\item Gerade in der Ebene
\item Gerade im $\R^d$
\item Ebene im $\R^3$
\end{itemize}
\end{bsp}

\begin{defini}[Dimension]
$\operatorname{dim } A = - 1$ falls $A = \emptyset$ und $\operatorname{dim } L$ sonst (Dimension des linearen Unterraums).
\end{defini}

\begin{defini}[Affine Kombination von Punkten]
Seien $p_1, p_2, \dotsc, p_n \in \R^d, n \geq 1$ und 
$\lambda_1, \dotsc, \lambda_n \in \R$
mit $\sum_{i=1}^n \lambda_i = 1$
dann nennt man \[\lambda_1 p_1 + \lambda_2 p_2 + \dotsb + \lambda_n p_n\]
eine affine Kombination der Punkte $p_i$.
\end{defini}

\begin{defini}[Affine Hülle]
Sei $S \subseteq \R^d$.
Dann nennt man 
\[\operatorname{aff}(S) \coloneqq \{  \lambda_1 p_1 + \lambda_2 p_2 + \dotsb + \lambda_n p_n \text{ mit } n \geq 1,
p1, \dotsc ,p_n \in S,
\lambda_1,\dotsc, \lambda_n \in \R
\sum_{i=1}^n \lambda_i = 1 \}\]
affine Hülle von S.
\end{defini}

\begin{eigen}
Die affine Hülle ist die kleinste affine Unterraum, der $S$ enthält.
\end{eigen}

\begin{bsp}
\begin{itemize}
\item affine Hülle von 2 Punkten $p_i \neq p_j \in \R^3$ ist die Gerade durch beide Punkte.
\item affine Hülle von 3 Punkten paarweise verschiedenen Punkten $p_1$, $p_2$ und $p_3 \in \R^3$ ist die Ebene durch alle drei Punkte
\end{itemize}
\end{bsp}

\section{Affine Abhängigkeiten/Unabhängigkeiten}

\begin{defini}[Affine Abhängigkeit]
Punkte $p_1,\dotsc, p_n \in \R^d$ heißen affin abhängig, wenn es $\alpha_1,\dotsc, \alpha_n \in \R$ gibt, so dass gilt:
\[\alpha_1 p_1 + \alpha_2 p_2 + \dotsb + \alpha_n p_n = 0 \text{ mit }
\sum_{i=1}^n \alpha_i = 0 \text{ und mind. ein } \alpha_i \neq \emptyset.\]
Ansonsten heißen die Punkte affin unabhängig.
\end{defini}


\begin{bsp} 
\begin{itemize}
\item Zwei Punkte $p_1$ und $p_2 \in \R^2$ affin unabhängig, wenn die Gerade durch beide Punkte nicht durch den Ursprung geht.
\item drei Punkte auf einer Gerade sind affin abhängig.
\end{itemize}
\end{bsp}

\begin{bemerk}
$p_1,\dotsc, p_n$ sind affin abhängig ($n \geq 3$) gdw. $p_2 - p_1, p_3 - p_1, \dotsc, p_n - p_1$ linear abhängig sind.
\end{bemerk}

\section{Affine Abbildung}

\begin{defini}[Affine Abbildung]
Eine affine Abbildung ist eine Abbildung $f \colon \R^d \rightarrow \R^k$, die als Kombination von linearer Abbildung und Translation ausgedrückt werden kann, d.\,h. in Koordinatenschreibweise kann $f$ als
\[f(x) = Ax + b \text{ mit } A \in \R^{k \times d} (k\times d-\text{Matrix}), b \in \R^k\]
aufgeschrieben werden.
\end{defini}


\section{Euklidische Räume}
$\R^d$

\begin{defini}{Skalarprodukt}
$v = (v_1, v_2, \dotsc, v_d) \in \R^d$ und $w = (w_1, w_2, \dotsc, w_n) \in \R^d$
\[\sprod{v,w} \coloneqq v^Tw = \sum_i=1^d v_i w_i\]
\end{defini}

\begin{eigen}
\begin{itemize}
\item symmetrisch: $\sprod{v,w} = \sprod{w,v}$
\item bilinear: $\sprod{\alpha v + \beta u, w} = \alpha\sprod{v,w} + \beta \sprod{u,w}$ und $\sprod{v,\alpha w + \beta u} = \alpha\sprod{v,w} + \beta \sprod{v,u}$

\item nichtnegativ: $\sprod{v,v} \geq 0$, $\forall v \in R^d$
und $\sprod{v,v} = 0 $ gdw. $v = 0$
\end{itemize}
\end{eigen}

wegen dieser Eigenschaften induziert das Skalarprodukt eine Norm:
\begin{defini}[euklidische Norm]
\[\norm{v} \coloneqq \sqrt{\sprod{v,v}}, v \in \R^d \]
\end{defini}

\begin{eigen}
\begin{itemize}
\item $\norm{v} \geq 0$ und $\norm{v} = 0 \gdw v = 0$
\item $\norm{\lambda v} = \abs{\lambda} \norm{v} \text{ für } \lambda \in R, v \in \R^d$
\item $\norm{v+w} \leq \norm{v} + \norm{w} \text{ mit} v,w \in \R^d$ (Dreiecksungleichung)
\end{itemize}
\end{eigen}

Cauchy-Schwarz-Ungleichung
\[\abs{\sprod{v,w}} \leq \norm{v} \cdot \norm{w}, \forall v,w \in R^d\]

Winkel zwischen zwei Vektoren (kleiner Winkel)
$v,w \in R^d$: 
\[\cos(\alpha) = \frac{\sprod{v,w}}{\norm{v} \cdot \norm{w}}\]

\begin{satz}[Kosinussatz]
$p,q,r \in \R^d$:
\[{\norm{q - r}}^2 = {\norm{q-p}}^2 + {\norm{r-p}}^2 - 2 \sprod{r-p, q-p}\]
\end{satz}

\begin{defini}[Hyperebenen]
Ein affiner Unterraum mit Codimension 1 im $\R^d$.
\[h \coloneqq \{ x \in \R^d | a^Tx = \alpha  \text{ für } a \in \R^d, \alpha \in \R\}\]
\end{defini}

\begin{bsp}
\begin{itemize}
\item Ebene im $\R^3$ = Hyperebene
\item Gerade im $\R^2$ ist Hyperebene
\end{itemize}
\end{bsp}

\begin{eigen}
\begin{itemize}
\item Vektor $a$ heißt Normalenvektor. Er steht senkrecht auch Hyperebene, d.\,h. \[\forall p,q \in h\colon \sprod{a,p-q} = 0\]
\item Entfernung von $h$ zum Ursprung $ = \frac{\abs{\alpha}}{\norm{a}}$
\item $h$ ist invariant unter Skalierung der definierten Gleichung mit Skalar $\lambda \neq 0$
\end{itemize}
\end{eigen}

\section{Halbräume}

\begin{defini}[offener Halbraum]
Jede Hyperebene teilt den Raum $\R^d$ in drei Teile, die Hyperebene und die zwei offenen Halbräume:
\[ h^+ \coloneqq \{x \in \R^d | a^Tx > a\} \text{ -- positiv offener Halbraum} \]
\[ h^- \coloneqq \{x \in \R^d | a^Tx < a\} \text{ -- negativ offener Halbraum} \]
\end{defini}

\begin{bemerk}
positiver und negativer Halbraum sind durch die Orientierung der Hyperebene bestimmt.
\end{bemerk}

\begin{defini}[geschlossener Halbraum]
\[ \bar{ h^+} \coloneqq \{x \in \R^d | a^Tx \geq a\} \text{ -- positiv offener Halbraum} \]
\[ \bar h^- \coloneqq \{x \in \R^d | a^Tx \leq a\} \text{ -- negativ offener Halbraum} \]
\end{defini}

Konventionen: 
nicht-vertikale Hyperebene: Hyperebene mit $a_d \neq 0$ heißt nicht-vertikal (Die letzte Komponente ist nicht ungleich 0)

\begin{itemize}
\item $h^+$ -- Halbräume \enquote{über} der Hyperebene
\item $h^-$ -- Halbräume \enquote{unter} der Hyperebene
\end{itemize}

\begin{gather*} 
\begin{split}
h &= \{x \in \R^d | a^Tx = \alpha\} \\
&= \{x \in \R^d | (a_1, a_2, \dotsc, a_d)^Tx = \alpha\} (\text{mit } a_d \neq 0)\\
&= \{x \in \R^d | a_1 x_1 + a_2x_2 + \dotsb +a_d x_d = \alpha\}  \\
&= \{x \in \R^d | x_d = \frac{1}{a_d} (a_1x_1 + a_2x_2 + \dotsb + a_{d-1} x_{d-1} - \alpha)\}  \\
&= \{x \in \R^d | x_d = b_1x_1 + b_2x_2 + \dotsb + b_{d-1} x_{d-1} - \beta\}  \\
&= \text{ Graph einer affinen Abbildung } \R^{d-1} \rightarrow \R
\end{split}
\end{gather*}

\section{Dualität zwischen Punkten und Hyperebenen}
beliebiger Punkt aus $\R^d$ entspricht nicht-vertikale  Hyperebene im $\R^d$

\begin{defini}[Dualität]
Sei $p = (p_1, p_2, \dotsc, p_d) \in \R^d$, dann ist 
\[p^* = \{ x \in \R^d | x_d = \sum_{i=1}^{d-1} p_i x_i = p_d \}\] 
die duale Hyperebene zu $p$.

Sei $h = \{x \in \R^d | x_d = \sum_{i = 1}^{d-1}  b_i x_i = \beta\}$, dann ist 
\[h^* = (b_1, b_2, \dotsc, b_{d-1}, \beta)\] der duale Punkt zu $h$.
\end{defini}

\begin{eigen}
$(p^*)^* = p$, $(h^*)^* = h$
\end{eigen}

\begin{bsp}
$p = (1,2), q = (2,3), r = (3,4)$
\begin{figure}[htbp]
  \centering
\includegraphics{grafiken/grafik1}
\caption{Die Punkte $p = (1,2), q = (2,3), r = (3,4)$}
\label{grafik1}
\end{figure}

\begin{gather*}
\begin{split}
p^* &= \{x \in R^2 | x_2 = 1 x_1 - 2\} \\
q^* &= \{x \in R^2 | x_2 = 2 x_1 - 3\} \\
r^* &= \{x \in R^2 | x_2 = 3 x_1 - 4\}
\end{split}
\end{gather*}

\begin{figure}[htbp]
  \centering
\includegraphics{grafiken/grafik2}
\caption{Die dualen Hyperebenen der Punkte $p = (1,2), q = (2,3), r = (3,4)$}
\label{grafik2}
\end{figure}

Die drei gerade schneiden sich bei Punkt $(1, -1)$. Dessen duale Ebene ist genau die, die durch die drei Punkte geht. 
\end{bsp}

\begin{lemma}
Es gilt für alle $p$ und alle nicht-vertikalen Hyperebenen $h$:
\[
p \in \begin{cases} 
h^+ \\ 
h^- \\ 
h 
\end{cases} 
\text{ gdw } h^* = \begin{cases} (p^*)^+ \\ (p^*)^- \\ p* \end{cases}
\]
\end{lemma}

\begin{lemma}
Seien $p,q$ und $r \in \R^2$, dann sind folgende Aussagen äquivalent:
\begin{itemize}
\item Die Punkte $p$,$q$ und $r$ sind colinear, d.\,h. liegen auf einer Gerade $l$
\item Die Geraden $p^*, q^*$ und $r^*$ schneiden sich in einem gemeinsamen Punkt $l^*$ oder sie sind alle parallel zueinander, falls $l$ vertikal war.
\end{itemize}
\end{lemma}

\section{Eigenschaften konvexer Mengen}

\begin{defini}
Konvexe Menge: Eine Menge $K \subseteq \R^d$ heißt konvex, falls für alle $p,q \in K$ und alle $\lambda \in [0,1]$ gilt: \[ \lambda p + (1 - \lambda) q \in K \]
\end{defini}

Geometrische Interpretation: Wenn zwei Punkte in der Menge liegen, dann muss auch das verbindende Geradensegment in der Menge liegen.

\begin{bsp}
Kreis ist konvex, Banane nicht
\end{bsp}

\begin{fakt}
Der Durchschnitt konvexer Mengen ist wieder Konvex.
\end{fakt}

\begin{defini}
Sei $X \subseteq \R^d$ eine Teilmenge. Die konvexe Hülle~$\conv(X)$ von $X$ ist
  definiert als der Durchschnitt aller konvexer Mengen, die $X$ enthalten, d.\,h.
\[
  \conv(X) \coloneqq \bigcap_{\substack{C \supset X\\C\text{ konvex}}} C
\]
\end{defini}

\begin{bsp}
Das kleinste konvexe Objekt, dass $X$ enthält.
\end{bsp}

\begin{defini}[Konvexkombination]
 Sei $p_{1},\dotsc, p_{n} \in \R^d$, dann heißt 
\[\lambda_{1} p_{1} + \lambda_{2}p_{2} + \dotsb + \lambda_{d}p_{d}\text{ mit } \lambda_{i} \geq 0, \sum_{i=1}^n \lambda_i = 1\] 
eine Konvexkombination von $p_{1}, \dotsc, p_{d}$. 
\end{defini}

\begin{bsp}
Jede Kombination liegt innerhalb der von den Punkten aufgespannten konvexen Hülle.
\end{bsp}  

\begin{lemma}
Sei $X \subseteq \R^d$. Die konvexe Hülle stimmt mit der Menge aller endlichen Konvexkombinationen von Punkten von $X$ überein, d.\,h. 
\[
\conv(x) = \{ \sum_{p \in S} \lambda_{p} p | S \subseteq X\text{ ist endlich und } \sum_{p \in S} \lambda_{p} = 1, \lambda_{p} \geq 0 \forall p \in S\}
\]
\end{lemma}

\section{Konvexe Hüllen von Punktmengen}

\begin{lemma}
Sei $X \in R^d$ endlich. Dann gilt: \[
\conv(x) = \bigcap_{H\text{, so dass }X \subseteq H, H\text{ Halbraum}} H
\]
\end{lemma}

\begin{thrm}[Separationstheorem]
Seien $C$ und $D \in \R^d$ zwei konvexe Mengen, mit $C \cap D = \emptyset$. Dann existiert eine Hyperebene $h = \{ x \in \R^d | a^Tx = \alpha \}$, die beide Mengen schwach separiert, d.\,h. $C \subseteq \bar h^+$ und $D \subseteq \bar h^-$
\end{thrm}

\begin{fakt}
  Wenn $C$ und $D$ abgeschlossen sind und wenigstens eine Menge beschränkt ist,
  so können beide Mengen stark separiert werden, d.\,h. $C
\subseteq h^+$ und $D \subseteq h^-$.
\end{fakt}

\begin{lemma}[Radon]
Sei $S\subseteq \R^d$ mit $\abs{S} \geq d+2$. Dann existieren zwei disjunkte Teilmengen $A$ und $B \subseteq S$, so dass: \[
\conv(A) \cap \conv(B) \neq \emptyset
\]
\end{lemma}

\begin{bsp}
Wenn im $\R^2$ 4 Punkte gegeben sind, so können diese so in zwei Teilmengen unterteilt werden, dass der Schnitt der konvexen Hüllen nicht leer ist.
\end{bsp}

\begin{thrm}[Caratheodory]
Falls $S \subseteq \R^d, p \in \conv(S)$ gilt, so existiert eine Teilmenge $A \subseteq S$ mit $\abs{A} \leq d+1$, so dass $p \in \conv(A)$.
\end{thrm}

\begin{thrm}[Helly] 
Seien $C_{1}, \dotsc, C_{n} \in \R^d$ konvexe Teilmengen und $n \geq d + 1$.
Wenn sich alle $d+1$-Tupel dieser konvexen Mengen einen nichtleeren Durchschnitt haben, so ist der Durchschnitt aller dieser Mengen nichtleer, d.\,h. \[
\bigcap_{i=1}^n C_{i} \neq \emptyset
\]
\end{thrm}

\section{Bälle im \texorpdfstring{$\R^d$}{|R hoch d}}

\begin{defini}[Bälle]
Sei $c \in \R^d$, $r \in R_{\geq 0}$. 

Dann heißt die Menge \[
B_{d}(c,r) \coloneqq \{x \in \R^d | \norm{x - c} \leq r\}
\]
\end{defini}



\chapter{Voronoi Diagramme \& Delaunay Triangulierung}

$P \subset \R^d$ ist endlich

\begin{defini}[Nicht-degeneriert]
\begin{itemize}
\item  Die affine Hülle von Punkten aus $P$ ist homeomorph zu, $\R^{k-1}$. 
%(Bei 2 Punkten auf Linie - > degeneriert)
\item Keine $d+2$ Punkte liegen auf gemeinsamer Sphäre
\end{itemize}
\end{defini}

%Warum degenieriert: degenerierte Fälle sind sehr instabil. %Wir betrachten zuerst Algorithmen ohne degenerierte Fälle.

\begin{bemerk}
Degenerierte Fälle sind sehr instabil.
Im Augenblich nehmen wir immer an, dass $P$ nicht-degeneriert ist. Später wird die Degeneriertheit explizit behandelt.
\end{bemerk}

\begin{defini}[Voronoi-Zelle]
$p \in P$
\[  V_p = \{ x \in \R^d | \norm{x-p} \leq \norm{x-q} \quad \forall q \in P \}\]
\end{defini}

\begin{figure}
  \centering
 \includegraphics[width = 0.5\textwidth]{grafiken/voronoi}
\caption{Voronoi-Diagramm}
\end{figure} 


\begin{defini}[Bisektor] 
$p,q \in P$		
\[B_{p,q} = \{x \in \R^d | \norm{y-p} = \norm{x-q} \}\]
\end{defini}

\begin{folg}
 

\begin{gather*}
\begin{split}
x \in B_{p,q}& \Leftrightarrow  \norm{y-p} = \norm{x-q} \\
& \Leftrightarrow \norm{y-p}^2 = \norm{x-q}^2 \\
& \Leftrightarrow \norm{x}^2 - 2x^tp + \norm{p}^2 = \norm{x}^2 - 2x^Tq + \norm{q}^2 \\
& \Leftrightarrow (q-p)^Tx + \frac{1}{2} (\norm{p}^2 - \norm{q}^2) = 0 
\end{split}
\end{gather*}

Falls $p \neq q$: Ursprungsvermeidende Hyperebene
\end{folg}

\begin{fakt}
\begin{itemize}
\item  $V_p$ ist der Schnitt von Halbräumen mit Rand $B_{p,q}$.
\item $V_p$ ist konvex.
\end{itemize}
\end{fakt}

\begin{defini}[Voronoi-Face]
Ein $k$-dimensionales Voronoi-Face ist der Schnitt von $d+1-k$ Voronoi-Zellen, falls dieser Schnitt nicht leer ist. 
\end{defini}

\begin{folg}
Alle Punkte in einem $k$-dimensionalen Voronoi-Face (Voronoi $k$-Face) sind gleich abständig zu $d+1-k$ Punkten in $p$.
\end{folg}

\begin{defini}[Voronoi-Diagramm] 
Zellkomplex, der von den Voronoi-Faces gebildet wird.
\end{defini}

\begin{figure}
  \centering
 \includegraphics[width = 0.6\textwidth]{grafiken/delaunay-triangulierung}
\caption{Delaunay-Triangulierung und ihr duales Voronoi-Diagramm}
\end{figure} 

\begin{defini}[Delaunay-Triangulierung]
\[D(P) = \{ \sigma = \operatorname{conv}(T) | \bigcap_{p \in T \subseteq P} V_p \neq \emptyset \}\]
%\todo{Rausfinden, was da fehlt. Das stimmt doch so nicht. }
\end{defini}



\begin{defini}[Voronoi-Delauny-Dualität]
Wenn $k+1$ Voronoi Zellen einen nicht-leeren gemeinsamem Schnitt haben, definieren sie 
\begin{itemize}
\item k-dimensionalen Delaunay-Simplex
\item $(d-k)$-dimensionales Voronoi-Face.
\end{itemize}
Delaunay-Simplex und Voronoi-Face sind dual zueinander.
\end{defini}

In der Ebene $\R^2$:

\begin{tabular}{|l|l|}
\hline
Delaunay & Voronoi \\ 
\hline
Vertex & Zelle \\ 
Kante & Kante \\
Dreieck & Voronoi-Knoten/Vertex \\
\hline
\end{tabular}


\begin{defini}[Power-Diagramme]
$(p,wp) \in P \subseteq \R^d \times \R$
\[\pi_p \colon \R^d \rightarrow	\R, x \mapsto  \norm{x-p}^2 - wp\]
$p$ ist Punkt und $w_p$ sein Gewicht. Verallgemeinerung von Voronoi-Diagrammen.
\end{defini}


Falls $w_p > 0$ folgende Interpretation:
\todo{Bild}

\begin{defini}[Power-Zelle]
$(p,w_p) \in P$
\[V_p = \{ x \in \R^d | \pi_p(x) \leq \pi_q(x)	\qquad	\forall(q,w_q) \in P \}\]
\end{defini}

\begin{defini}[Power-Bisektor]
$(p,w_p), (q,w_q) \in P$
\[B_{p,q} = \{ x \in R^d | \pi_p(x) = \pi_q(x) \} \]
\end{defini}



\begin{folg}
\begin{gather*}
\begin{split}
x \in B_(p,q)& \Leftrightarrow \pi_p(x) = \pi_q(x) \\
& \Leftrightarrow \norm{x-p}^2 - w_p = \norm{x-q}^2 - w_q \\
& \Leftrightarrow	\norm{x}^2 - 2x^Tp + p^2 - w_p = \norm{x}^2 - 2x^Tq + \norm{q}^2 - w_q \\
& \Leftrightarrow (q-p)^Tx + \frac{1}{2} (\norm{p}^2 - \norm{q}^2 - w_p + w_q) = 0 
\end{split}
\end{gather*}
Das ist für $p \neq q$ eine Ursprungsvermeidende Hyperebene.
\end{folg}

\begin{bemerk}
Mögliche Anwendung von Power Diagrammen:
$P = \{(p,w_p)\}$ Menge von Atomen mit Zentrum $p$ und Van der Waals-Radius $w_p$.
\end{bemerk}

\begin{defini}[Power-Faces]
Genauso wie Voronoi-Faces
\end{defini}

\begin{defini}[Power-Diagramm] 
Komplex der von den Power Faces gebildet wird.
\end{defini}

Gewichtete Delaunay Triaungulierung dual zum Power Diagramm (genauso wie Delaunay dual zu Voronoi)
 

\section{Berechnung von Delaunay Triangulierungen in der Ebene}
 
\begin{defini}[Umschreibender Ball eines Simplex]
Ball der alle Knoten des Simplex auf seinem Rand hat.
\end{defini}

\begin{beob}
Der umschreibende Ball für einen $d$-Simplex im $\R^d$ ist eindeutig.
\end{beob}
 

\begin{defini}[lokale Delaunay-Eigenschaft]
Sei $T$ eine Triangulierung von $P$, wobei $P$ eine ungewichtete Punktemenge im $\R^2$ sei.
$T$ hat die lokale Delaunay-Eigenschaft falls jede Kante der Triangulierung entweder
\begin{enumerate}
\item eine inzidentes Dreieck hat. (D.\,h. Kante ist auf dem Rand der komplexen Hülle von $T$)
\item Kante hat 2 inzidente Dreiecke $abc$ und $bcd$ hat, so dass der umschreibende Ball von $abc$ den Punkt $d$ nicht enthält.
\end{enumerate}
\end{defini}

\begin{figure}
  \centering
 \includegraphics[width = 0.8\textwidth]{grafiken/delaunayeigenschaft}
\caption{lokale Delaunay-Eigenschaft}
\end{figure} 


\begin{satz}
Wenn in einer Triangulierung $T$ von $P$ jede Kante die lokale Delaunay-Eigenschaft hat, dann ist $T$ eine Delaunay-Triangulierung.
\end{satz}

\begin{folg}
Algorithmus der versucht, die lokale Delaunay-Eigenschaft herzustellen, indem er verletzende Kanten flipt.
\end{folg}

\begin{proof}
Idee:
Für jedes Dreieck $abc$ in der Triangulierung gilt: Die umschließende Kreisscheibe enthält keinen Punkt von $P$ im Innern.

Voronoi-Vertex:
\begin{enumerate}
 \item Schnitt der Voronoi-Zellen von $a,b,c$ nichtleer
 \item $abc$ (Konvexe Hülle von $a,b$ und $c$) ist Delaunay
\end{enumerate}

Sei $p \in P \setminus \{a,b,c\}$ und
$q$ beliebig in Umkreisscheibe.
Das Liniensegment $qp$ schneidet Dreiecke $t_1, t_2, \dotsc, t_k$ der Triangulierung.
Dazu folge von gewichteten Punkten $S_1, S_2, \dotsc, S_k$ mit Gewichten $w_1, w_2, \dotsc, w_k$
$w_i = \text{Radius der Umkreisscheibe von } t_i$
Damit ergeben sich eine Folge von Power-Abständen $\Pi_1(p), \dotsc, \Pi_k()$

\todo{wo kommen die Sks her?}

\begin{beob}
\begin{enumerate}
\item Der Power-Abstand ist
\begin{itemize}
 \item 	negativ, falls innerhalb der Kreisscheibe
 \item 	$0$, falls auf Rand der Kreisscheibe
 \item 	positiv, falls außerhalb der Kreisscheibe
\end{itemize}

\item auf der geraden der gemeinsamen Kante von $t_i$ und $t_{i+1}$ gilt $\Pi_i = \Pi_{i+1}$. (Wegen $\Pi_i(x) = \Pi_{i+1}(x) = \Pi_i(y) = \Pi_{i+1}(y) = 0$)
Außerdem gilt $\Pi_i < \Pi_{i+1}$ links vom Power-Bisektor bzw. $\Pi_i < \Pi_{i+1}$ rechts vom Power-Bisektor.

\includegraphics[width=0.3\textwidth]{grafiken/power-bisektor}

\item $p$ ist Knoten von $t_k$. Daraus folgt $\Pi_k(p) = 0 \rightarrow \Pi_{k+1}(p) > 0 \rightarrow \Pi_{1}(p) > 0$.
Das bedeutet $p \notin \text{ Umkreisscheibe von } t_1 = abc$ 
\todo{wieso folgt das?}
\end{enumerate}
\end{beob}
Aus Punkt 3 der Beobachtung folgt also die Behauptung.
\end{proof}

Lawson-Flip
Wann immer $bc$ nicht die lokale Delaunay-Eigenschft hat, dann ``flippen'' der Kante zu $ad$.
d.\,h. in Triangulierung tauschen wir die Dreiecke $abc$ und $bcd$ aus durch $abd$ und $adc$.

\includegraphics[width=0.3\textwidth]{grafiken/flip}


Der Lawson-Flip-Algorithmus muss entscheiden, ob $bc$ die lokale Delaunay-Eigenschaft hat, d.\,h. ob $d$ in der Umkreisscheibe von $abc$ enthalten ist. Dazu benötigt man den IN\_CIRCLE\_TEST.


\begin{satz}[Lifted Circle Claim]
Dazu Hochhebungsabbildung:
\begin{gather*}
h \colon \R^2 \rightarrow \R^3 \\
(x,y) \mapsto (x,y,x^2 + y^2) 
\end{gather*}


Seien $p,q,r \in \R^2$. 

$s\in \R^2$ ist
\begin{enumerate}
 \item  auf dem Rand der umschließenden Kreisscheibe genau dann, wenn $h(s) \in \operatorname{aff}(h(p), h(q), h(r))$ gilt
 \item Innerhalb der Kreisscheibe, falls $h(s)$ Vertikal unterhalb von $\operatorname{aff}(h(p), h(q), h(r))$ liegt.
 \item Außerhalb der Kreisscheibe sonst
\end{enumerate}
\end{satz}

\begin{proof}
Spezialfall:
Der Mittelpunkt der Kreisscheibe von $p,q$ und $r$ ist Ursprung.

\begin{beob}
\begin{enumerate}
 \item dritte Komponente des gelifteten Punktes ist der quadratische Abstand des Punktes vom Ursprung
 \item $p$, $q$ und $r$ haben alle den gleichen Abstand zum Ursprung
$\rightarrow$ $\operatorname{aff}(h(p), h(q), h(r))$ ist Ebene parallel zur $x,y$-Ebene, die das Parabol in einem Kreis schneidet
\end{enumerate}
\end{beob}

Sei $s$ Punkt auf dem Rand der umschließenden Kreisscheibe von $p$, $q$ und $r$
\[
\begin{pmatrix}
 s_x \\ s_y \\ s_x^2 + s_y^2 \\ 1
\end{pmatrix}
= \lambda 
\begin{pmatrix}
 p_x \\ p_y \\ p_x^2 + p_y^2 \\ 1
\end{pmatrix}
+
\mu 
\begin{pmatrix}
 q_x \\ q_y \\ q_x^2 + q_y^2 \\ 1
\end{pmatrix}
+\rho 
\begin{pmatrix}
 r_x \\ r_y \\ r_x^2 + r_y^2 \\ 1
\end{pmatrix}
\]
$\lambda, \mu, \rho \in \R$
Verwendung von Homogenen Koordinaten um die Bedingung $\lambda + \mu + \rho = 1$ sicherzustellen.

Allgemeiner Fall:
Der mittelpunkt der Kreisscheibe von $p$,$q$ und $r$ ist $t \neq 0$.
Translation der Konfiguration mit $t$.
%\todo{bild einfügen}

\begin{gather*}
\begin{split}
\begin{pmatrix}
 s_x + t_x \\ s_y + t_y \\ (s_x + t_x)^2 + (s_y + t_y)^2 \\ 1
\end{pmatrix}
= & \lambda 
\begin{pmatrix}
 p_x + t_x \\ p_y + t_y \\ (p_x + t_x)^2 + (p_y + t_y)^2 \\ 1
\end{pmatrix} 
+ \mu 
\begin{pmatrix}
 q_x + t_x \\ q_y + t_y \\ (q_x + t_x)^2 + (q_y + t_y)^2 \\ 1
\end{pmatrix}\\
 + & \rho 
\begin{pmatrix}
 r_x + t_x \\ r_y + t_y \\ (r_x + t_x)^2 + (r_y + t_y)^2 \\ 1
\end{pmatrix}
\end{split}
\end{gather*}

Nachrechnen der dritten Komponente:
\begin{gather*}
\begin{split}
2s_xt_x + t_x^2 + 2s_yt_y + t_y^2 = & \lambda(2p_xt_x + t_x^2 + 2p_yt_y + t_y^2) + \mu(2q_xt_x + t_x^2 + 2q_yt_y + t_y^2) + \\ 
& \rho(2r_xt_x + t_x^2 + 2r_yt_y + t_y^2)
\end{split}
\end{gather*}
daraus folgt
\begin{gather*}
\begin{split}
s_xt_x + s_yt_y = & \lambda(p_xt_x + p_yt_y) + \mu(q_xt_x + q_yt_y) + \rho(r_xt_x + r_yt_y) \\
 = & t_x(\lambda p_x + \mu q_x + \rho r_x) +  t_y(\lambda p_y + \mu q_y + \rho r_y) \\
= & t_xs_x + t_ys_y
\end{split}
\end{gather*}

\[
h(s+t) \in \operatorname{aff}(h(p+t), h(q+t), h(r+t))
\]
Daraus folgt die Behauptung, da $s$ beliebig auf Rand gewählt war.
\end{proof}

Berechnung des IN\_CIRCLE-Prädikats durch die Determinante:
\[ \Gamma = \begin{vmatrix} 
1 & p_x & p_y & p_x^2 + p_y^2 \\ 
1 & q_x & q_y & q_x^2 + q_y^2 \\ 
1 & r_x & r_y & r_x^2 + r_y^2 \\ 
1 & s_x & s_y & s_x^2 + s_y^2  
\end{vmatrix}
\]

Determinante verschwindet genau dann, wenn $s$ im Rand der umschließenden Kreisscheibe von $p$,$q$ und $r$ ist. (Die Determinante ist $0$, wenn die Punkte affin abhängig sind.)

\[ \Delta = \begin{vmatrix} 
1 & p_x & p_y \\ 
1 & q_x & q_y \\ 
1 & r_x & r_y 
\end{vmatrix}
\]
Mit der Matrix $\Delta$ heben sich Vorzeichenwechsel der Determinante bei Permutation gegenseitig auf.

\begin{lemma}
Ein Punkt $s \in R^2$ liegt im Inneren der umschließenden Kreisscheibe von $p$, $q$ und $r$ genau dann, wenn das Produkt aus $\Delta$ und $\Gamma$ negativ ist. ($\Delta \Gamma < 0$)
\end{lemma}

\begin{proof}
 Spezialfall:
$p = (0,0)$, $q = (1,0)$, $r = (0,1)$ und $s = (\frac{1}{4},\frac{1}{4})$ 
Damit ist $\Delta = 1$ und $\Gamma < 0$

Idee der stetige Bewegung:

Führe $p$, $q$, $s$ und $r$ stetig von Situation in Spezialfall über, wobei degenerierte Situationen vermieden werden müssen. Dies funktioniert wegen der Stetigkeit der Determinante.
\end{proof}


\subsection{Lawsons-Flip-Algorithmus}

Idee: Wenn immer eine Kante $bc$ nicht die lokale Delaunay-Eigenschaft hat, dann \enquote{Flip} zu ab

\begin{algorithm}
    \dontprintsemicolon
    \caption{Der Lawson-Flip-Algorithmus}
    \KwIn{$T$ Triangulierung}
    \KwOut{Delaunay-Triangulierung}
	\ForEach{Kante $e \in T$}{
		Markiere $e$\;
		PUSH $e$ auf den Stack s\;
	}
	\While{$S \neq \emptyset$}{
		$(b,c)$ = S.pop()\;
		entferne Markierung von $(b,c)$\;
		\If{$(b,c)$ hat nicht die lokale Delaunay-Eigenschaft}{
			FLIP $(b,c)$ zu $(a,d)$\;
			\For{ $(x,y) \in \{ac,cd,db,ba\}$}{
				\If{ $(x,y)$ nicht markiert ist}{
					markiere $(x,y)$\;
					S.push(x,y)\;
				}
			}
		}
	}
  \end{algorithm}

%Algorithmus:

%Lawsons Flip (T Triangulierung)
%FOR EACH e KANTE IN T DO
% 	MARKIERE c
% 	PUSH e AUF DEN STACK S
% END FOR
% 
% WHILE $S \neq \emptyset$ DO
% 	$(b,c)$ = S.pop()
% 	ENTFERNE MARKIERUNG VON $(b,c)$
% 	IF $(b,c)$ hat nicht die lokale Delaunay-Eigenschaft THEN
% 		FLIP $(b,c)$ zu $(a,d)$
% 		FOR $(x,y) \in \{ac,cd,db,ba\}$ DO
% 			IF $(x,y)$ NICHT MARKIERT IST DO
% 				MARKIERE $(x,y)$
% 				S.push(x,y)
% 			END IF
% 		END FOR
% 	END IF
% END WHILE


\begin{satz}
Der Lawson-Flip-Algorithmus terminiert
\end{satz}

\begin{proof}

\begin{beob}
Bei jedem Flip bleibt die Anzahl der Dreiecke in der Triangulierung die gleiche.
\end{beob}

\begin{defini}
Gewicht von Triangulierung $T$ ($= w(T)$) ist der Vektor aller Winkel, die in $T$ auftreten, aufsteigend geordnet.
\end{defini}
	
$T < T'$ falls $w(T) < w(T')$ (Lexikographischer Vergleich), $w(T)$ der Winkelvector	

\begin{beha}
 $w(t) < w(T')$ falls $T'$ aus $T$ durch einen Flip entsteht.
\end{beha}

%\todo{Skizze davon einfügen: abc-Dreieck, d ist Punkt im Kreis}

\begin{gather*}
w(T) = \alpha_1 + \alpha_2, \beta_1, \beta_2, \gamma_1 + \gamma_2, \delta_1, \delta_2 \\
w(T') = \alpha_1,\alpha_2, \beta_1 +  \beta_2, \gamma_1, \gamma_2, \delta_1 +  \delta_2
\end{gather*}

Um zu zeigen $w(T) < w(T')$ benutzen wir den  Satz von Thales.

\includegraphics[width=0.3\textwidth]{grafiken/thales}

$\alpha_e > \alpha_d = \alpha_c > \alpha_f$

\todo{versteh das nicht.. evtl. Fehler beim abschreiben?}

Kante:
$qc: \beta_1 < \delta_2$
$bc: \gamma_2 < \delta_1$
$dc: \beta_2 < \alpha_1$
$bd: \gamma_1 < \alpha_2$

=>
$\beta_1, \beta_2 < \beta_1 + \beta_2$
$\gamma_2 < \delta_1$
$\beta_1 < \delta_2$
$\gamma_1, \gamma_2 < \gamma_1 + \gamma_2$
$\gamma_1 < \alpha_2$
$\beta_2 < \alpha_1$

D.\,h. für jeden Winkel aus $w(T)$ gibt es einen größeren n $w(T')$. Da die Anzahl der Triangulierungen endlich und das Maß immer ansteigend ist folgt daraus, dass der Algorithmus terminiert.
\end{proof}

\begin{satz}[Thales]
 Der Mittelpunktswinkel ist doppelt so groß wie der Umfangswinkel.
\end{satz}

\begin{proof}
Zuerst der einfache Basisfall bei dem der Mittelpunkt auf der Linie liegt:
Da die Dreiecke gleichschenklig sind, gilt für das Dreieck $amc$: $2x + \Pi - 2\alpha = \Pi$. Daraus folgt $x = \alpha$.

\includegraphics[width=0.3\textwidth]{grafiken/thales-einfach}

Der Fall, dass der Mittelpunkt im Dreieck enthalten ist: $\gamma + \beta = \alpha$

\includegraphics[width=0.3\textwidth]{grafiken/thales-mpenthalten}

Der Fall, das der Mittelpunkt nicht enthalten ist: $\beta + x = 2\beta + 2\gamma$. Daraus folgt wieder $x = \gamma$.

\includegraphics[width=0.3\textwidth]{grafiken/thales-nichtmpenthalten}

Der Trick in beiden Fällen: Betrachte Diagonale durch Punkt $m$ und argumentiere danach mit dem Basisfall.
\end{proof}


%Was fehlt noch: Eingabe des Lawson Flip Algorithmus. Die initiale Triangulierung.
%Jetzt kommt Algorithmus für konvexe Hülle. Dieser hat als Nebenprodukt eine Triangulierung.
\section{Konvexe Hülle in der Ebene \texorpdfstring{$\R^2$}{R hoch 2}}

$P \subset \R^2$:
Konvexe Hülle ist der Schnitt aller konvexen Mengen, die $P$ enthalten.

%$= \{ x = \sum \delta_i p_i | p_i \in P, \delta_i \geq 0, \sum \delta_i = 1\}$

\begin{defini}
 Extrempunkte sind Punkte aus P auf dem Rand der konvexen Hülle. %Also Punkte bei denen nur ein einziger Koeffizient 1 ist.
\end{defini}

Das algorithmische Ziel ist das Aufzählen der Extrempunkte entlang des Randes der Konvexen Hülle von P.
%im Uhrzeigersinn. ?
Dazu benötigen wir das Prädikat $\operatorname{IS\_LEFT\_OF}(p,q,r)$ das uns sagt, ob $r$ links von (auf, rechts) der geraden durch $p$ und $q$ liegt.

\begin{figure}
  \centering
 \includegraphics[width = 0.5\textwidth]{grafiken/isleftof}
\caption{IS\_LEFT\_OF-Prädikat}
\end{figure} 


%Algorithmus Jarvis Wrap:
%1. Ordne Punkte in P Lexikographisch nach (x,y) Koordinaten.
%....
\begin{algorithm}
    \dontprintsemicolon
    \caption{Der Jarvis-Wrap-Algorithmus}
    \KwIn{$P \subset \R^2$}
    \KwOut{Extrempunkte auf dem Rand der konvexen Hülle}
	$p \coloneqq$ Lexikographisch kleinster Punk in $P$\;
	$p' \coloneqq p$\;
	\Repeat{$p = p'$}{
		$q \coloneqq$ beliebiger Punkt in $P\setminus \{p\}$\;
		\ForAll{$ r \in P\setminus\{p,q\}$}{
			\If{$\operatorname{IS\_LEFT\_OF}(p,q,r)$}{
				$q \coloneqq r$\;
			}
		}
		Ausgabe von $q$\;
		$p\coloneqq q$\;
	}
\end{algorithm}

% PSEUDOCODE:
% p \coloneqq Lexikographisch kleinster Punk in P
% p' \coloneqq p
% DO
% 	q \coloneqq beliebiger Punkt in $P\setminus \{p\}$
% 	FOR ALL$ r \in P\setminus\{p,q\}$
% 		IF $IS_LEFT_OF(p,q,r)$ THEN
% 			q \coloneqq r
% 		END IF
% 	END FOR
% 	AUSGABE VON q
% 	p\coloneqqq
% WHILE ($p \neq p'$)


Kurze Kostenanalyse: 
\[
\text{Finden des lexik. kleinsten Elements} + h * (n-2) * \text{IS\_LEFT\_OF}
\]
$h$ ist die Anzahl der Extrempunkte.
Das bedeutet der Jarvis-Wrap-Algorithmus ist Output-Sensitiv, d.\,h. Laufzeit hängt von Anzahl der Extrempunkte ab.

\subsubsection{Implementierung des IS\_LEFT\_OF-Prädikats}
Falls $r \in \operatorname{aff}(p,q)$:
\[
\begin{pmatrix}
r_x\\
r_y\\
1
\end{pmatrix}
= \lambda
\begin{pmatrix}
p_x\\
p_y\\
1
\end{pmatrix}
+ \mu
\begin{pmatrix}
q_x\\
q_y\\
1
\end{pmatrix}
%				p_x			q_x
%	= \lambda		p_y	+ \mu	q_y	
%				1			1
\]

daraus folgt: $p$,$q$ und $r$ sind linear abhängig. Das bedeutet, die folgende Determinante ist $0$.
\[
\Delta = 
\begin{vmatrix}
1 & p_x & p_y \\
1 & q_x & q_y \\
1 & r_x & r_y
\end{vmatrix}
= 0
%		1	p_x	p_y
%\Delta = 	1	q_x	q_y	= 0
%		1	r_x	r_y
\]

Aus dem stetigen Bewegungs-Argument (z.\,B. mit Punkten $p = (1,0)$, $q = (0,1)$ und $r = (0,0)$) folgt:
$r$ ist links von der affinen Hülle, falls $\Delta > 0$. Argument folgt aus der Stetigkeit der Determinante. 

%Der Jarvis-Wrap algorithmus ist numerisch unstabil. Die Auswertung des Prädikats schlägt bei float-Werten relativ oft fehl, so dass die Gefahr einer endlosschleife besteht.

\subsection{Graham Scan Algorithmus}

Halbkanten-Datenstruktur:

Kante zwischen $p$ und $q$ wird gespeichert als zwei Halbkanten.

\begin{figure}
  \centering
 \includegraphics[width = 0.5\textwidth]{grafiken/halbkanten}
\caption{Halbkanten-Datenstruktur}
\end{figure} 


%1. Sortiere Punkte in P lexikographisch. Verpointere die Punkte.

%Starten beim kleinsten Punkte. Gehen zum übernächsten Punkt. (zweimal Next)
%....
%erst Untere und dann die Obere Konvexe Hülle.
%Ergebnis ist insbesondere auch eine Triangulierung.


\begin{defini}[Halbkanten-Datenstruktur]
Jede Kante besteht aus zwei Einzelkanten. Jede Einzelkante erhält previous und next.
\end{defini}

Die Halbkantendatenstruktur eigent sich für die Darstellung planarer Graphen.


\begin{algorithm}
    \dontprintsemicolon
    \caption{Der Graham-Scan-Algorithmus}
    \KwIn{$P \subset \R^2, P = \{p_1, p_2, \dotsc, p_k \}$}
    \KwOut{Triangulierung und konvexen Hülle}
	Sortiere $\{p_1, \dotsc, p_k\} lexikographisch$\;
	verbinde alle $p_i p_{i+1}$ mit Kanten\;
	berechne untere konvexe Hülle LowerHull(p)\;
	berechne obere konvexe Hülle UpperHull(p)\;
\end{algorithm}

%ich glaube, der algorithmus stimmt so nicht
%\begin{algorithm}
%    \dontprintsemicolon
%    \caption{LowerHull($P$)}
%%    \KwIn{$P \subset \R^2, P = \{p_1, p_2, \dotsc, p_k \}$}
%%    \KwOut{Triangulierung und konvexen Hülle}
%	$p\coloneqqp_1, q = p_3, r = p_2$\;
%	$i \coloneqq 3$\;
%	\While{$i \leq n$}{
%		\eIf{$\operatorname{IsLeftOf}(p,q,r)$}{
%			fügen Kante $(p,q)$ ein\;
%			$i++$\;
%			$r\coloneqqq$\;
%			$q\coloneqqp_i$\;
%		}
%		{
%			$i++$\;
%			$p\coloneqqr$\;
%			$r\coloneqqq$\;		
%			$q\coloneqqp_i$\;
%		}		
%	}
%\end{algorithm}

Lower Hull(P), $\abs{P}= n, P \subset \R^2$

\begin{algorithm}
    \dontprintsemicolon
	\caption{LowerHull($P$), $ |P| = n, P \subset \R^2$}
%    \caption{LowerHull($P$), $\abs{P}= n, P \subset \R^2$}
%    \KwIn{$P \subset \R^2, P = \{p_1, p_2, \dotsc, p_k \}$}
%    \KwOut{Triangulierung und konvexen Hülle}
	$a:a[0,\dotsc,n]$ Array mit $n+1$ Elementen\;
	$a[0] \coloneqq p_1$\;
	\For{$i = 1$ TO $n$}{
		$a[i]\coloneqq p_i$\;	
	}
	$i\coloneqq1$\;
	\While{$i < LENGTH(q) - 1$}{
		\eIf{$IS\_LEFT\_OF(a[i], a[i+2], a[i+1])$}{
			Remove(a,i+1)\; %//Entferne das i+1te Element aus q
			$i \coloneqq i -1$\;
		}
		{
			$i\coloneqq i +1$\;
		}	
	}
	\For{$i=1$ TO $Length(a)$}{
		Output a[i]	\;
	}
\end{algorithm}



\begin{algorithm}
    \dontprintsemicolon
    \caption{UpperHull($P$)}
%    \KwIn{$P \subset \R^2, P = \{p_1, p_2, \dotsc, p_k \}$}
%    \KwOut{Triangulierung und konvexen Hülle}
	drehe Reihenfolge von $p_1, \dotsc, p_k$ um\;
	LowerHull(p)\;
\end{algorithm}

Die Laufzeit ist $O(n \log n)$, da am Anfang die Punkte sortiert werden müssen. 

Untere Schranke:
\begin{algorithm}
    \dontprintsemicolon
    \caption{Sortieren mit konvexen Hüllen}
    \KwIn{$a_1, \dotsc, a_n \in \R \geq 0;  a \geq 0$}
    \KwOut{Zahlen in sortierter Reihenfolge -> $\Omega(n \log n)$}
	konstruiere Punkte $p_i \coloneqq (a_i, a_i^2)$\;
	berechne die Konvexe Hülle\;
\end{algorithm}

%gegeben: $a_1, \dotsc, a_n \in \R \geq 0;  a \geq 0$
%ausgabe: Zahlen in sortierter Reihenfolge -> $\Omega(n \log n)$
%konstruiere Punkte $p_i \coloneqq (a_i, a_i^2)$
Konvexe Hülle würde die Zahlen $a_1, \dotsc, a_n$ sortieren. Damit ist die untere Schranke $\Omega(n \log n)$ wenn $n$ Punkte auf der konvexen Hülle liegen.

\section{Berechnung von Voronoi-Diagrammen in der Ebene}

Komplexität eines Voronoi-Diagramms in der Ebene:

\begin{lemma}
Wenn $\norm{p} = n \geq 3$ ist, so gibt es höchstens $2n -5$ Voronoiknoten und $3n-6$ Voronoikanten. (in der Ebene)
\end{lemma}

\begin{proof}
Eulers Formel für planare Graphen:
\[m_{kn} - m_{ka} + m_F = 2\]

hier (unendlichen Knoten einfügen und alle Knoten auf der konvexen Hülle damit verbinden.): 
\[(n_{Kn} + 1) - n_{Ka} + n = 2\]

Summe aller Knotengrade:
\[2 \cdot n_{Ka} \geq 3 (n_{Kn} + 1)\], da jeder Knoten mindestens Grad 3 hat.

daraus folgt:
\begin{gather*}
\begin{split}
(n_{Kn} + 1) + n = 2 + n_{Ka} &\geq 2 + \frac{3}{2} (n_{Kn} + 1) \\
n &\geq 2 + \frac{1}{2} (n_{Kn} + 1) \\
2n -5 &\geq n_{Kn} 
\end{split}
\end{gather*}

Analog folgt $3n - 6 \geq n_{Ka}$
\end{proof}


\subsection{Sweep Line Paradigma}
\begin{figure}
  \centering
 \includegraphics[width = 0.7\textwidth]{grafiken/sweepline}
\caption{sweep line}
\end{figure} 

\begin{figure}
  \centering
 \includegraphics[width = 0.5\textwidth]{grafiken/beachline}
\caption{beach line}
     \end{figure} 


\begin{enumerate}
 \item Punkt-Event:
Sweepline trifft auf einen Punkt aus $P$.

\begin{enumerate}
 \item Ein neuer Parabelbogen kommt zur beach line hinzu
 \item Neue Voronoikanten werden in ihrem Verlauf beschrieben
\end{enumerate}

\begin{figure}
  \centering
 \includegraphics[width = \textwidth]{grafiken/punktevent}
\caption{Punkt-Event}
\end{figure} 


Daraus folgt: Es gibt maximal $2n - 1$ Parabelbogen auf  beachline.


 \item Kreis-Event:
In dem Moment, in dem $a'$ verschwindet, gehen alle drei Parabelbögen $a', a''$ und $a'''$ durch einen gemeinsamen Punkt $q$. Dieser ist ein neuer Knoten im Voronoi-Diagramm, da der offene Kreis $K$ mit Mittelpunkt $q$ leer ist.
\end{enumerate}

\begin{lemma}
Ein neuer Parabelpunkt kann auf der beach line nur durch ein Punkt-Event entstehen.
\end{lemma}


\begin{lemma}
Ein Parabelbogen kann von der beach line nur durch ein Kreis-Event verschwinden.
\end{lemma}

\begin{enumerate}
 

 \item Datenstrukturen für das schon konstruierte Voronoi-Diagramm
\begin{itemize}
 \item Halbkantendatenstruktur
\end{itemize}

 \item Datenstruktur für die beach line
\begin{itemize}
 \item ausbalancierten Binärbaum, wobei die Blätter die Parabelbögen darstellen
 \item Schnittpunkte benachbarter Parabelbögen können durch interne Knoten dargestellt werden
\end{itemize}

 \item Datenstruktur für die Events 
\begin{itemize}
 \item Prioritätswarteschlange
 \item füge am Anfang alle Punktevents ein. 
 \item füge Kreis-Events hinzu, sobald klar ist, wann sie stattfinden (ist Berechenbar bei Punkt-Event)
\end{itemize}
\end{enumerate}

\begin{bemerk}
Laufzeit pro Punktevent: $\log n$

Laufzeit pro Kreisevent: konstante Zeit
\end{bemerk}

Insgesamt: $O(n \log n)$


\section{Inkrementeller Algorithmus zur Berechnung der Delaunay-Triangulierung von \texorpdfstring{$P \subset \R^2$}{P ist Teilmenge von R hoch 2}} 

$P = \{p_1, \dotsc, p_n\}, S_1 = \{p_1\}, S_n = \{p1, \dotsc, p_n\} = P, P_i = \{1, \dotsc, p_i\}$

Seien $D_i = D(S_i)$ die Delaunay-Triangulierung von $S_i$

Annahme:
$x,y,z \in \R^2$ mit 
$\{x,y,z\} \cap P = \emptyset$
, so dass  
$P \subset \operatorname{CONV}\{x,y,z\}$ 
und Radius der umschließenden Kreisscheibe von 
$xyz >> \max\{ \norm{ p_i - p_j } | p_i, p_j \in P \} \forall i = 1, \dotsc, n$.

$D_0 = D(x,y,z)$ Delaunay-Triangulierung von x,y,z.
\begin{enumerate}
\item Einfügen in Dreieck, dass $p_2$ enthält
\item \enquote{Splitten} des Dreiecks
\item Herstellen der lokalen Delaunay-Eigenschaft für alle Kanten  
\end{enumerate}

\begin{algorithm}
    \dontprintsemicolon
    \caption{Inkremententeller Algorithmus für Delaunay-Triangulierung}
    \KwIn{$P \subset \R^2$}
    \KwOut{Delaunay-Triangulierung}
\For{i=1 TO n}
{
	FIND $\sigma_{i-1}$ IN $D_{i-1}$ WITH $p_i \in \sigma_{i-1}$\; %\sigma_{i-1} Dreieck in Delaunay-Triangulierung D_{i-1}, dass ist das Punktlokalisierungsproblem
	ADD $p_i$ by splitting $\sigma_{i-1}$\;  % <-- Update
	\While{$\exists$ Edge $bc$ WITHOUT \enquote{lokale Delaunay-Eigenschaft}}
	{
		Flip $bc$ to $ad$\;
	}	
}
\end{algorithm}

\begin{figure}
  \centering
 \includegraphics[width = \textwidth]{grafiken/D1-3}
\caption{$D_0$, $D_1$ und $D_2$}
\end{figure} 


Der Algorithmus ist in 2 Teilprobleme unterteilt: Das Lokalisierungsproblem in Zeile 2 und das Update-Problem in Zeile 3-6. Das Update besteht aus einer Split-Operation (genannt \enquote{1-3-Flip})
und mehreren Flip-Operationen (genannt \enquote{2-2-Flip}).
	
	
\subsubsection{Anzahl von Flips im Verlauf des Algorithmus}

\begin{lemma}
Sei $\sigma \in D_i \notin D_{i-1}$, dann hat $\sigma$ den Punkt $p_i$ als einen seiner Knoten.
\end{lemma}
\begin{proof}
Da $\sigma$ Delaunay-Dreieck enthält die Umkreisscheibe keinen Punkt von $S_i$ im Innern. Da $S_{i-1} \subset S_i$ gilt das gleiche für $S_{i-1}$, d.\,h. falls $p_i$ kein Knoten von $\sigma$ ist, dann $\sigma \in D_{i-1}$. Daraus folgt: $p_i$ Knoten von $\sigma$.
\end{proof}


\begin{defini}
\begin{itemize}
\item Sei $p$ Knoten von Triangulierung $T$. Der Stern (Star) von $p$ sind alle Dreiecke in $T$, die inzidient sind zu $p$.

\item Der Link von $P$ sind alle Kanten im Stern von $p$, die nicht zu $p$ inzident sind.
\end{itemize}
\end{defini}

\begin{enumerate}
\item Nur die Dreiecke im Stern von $p_i$ können durch Flip-Operationen beim einfügen von $p_i$ in $D_{i-1}$ entstanden sein. Die Anzahl der Flip-Operationen ist $\leq \frac{1}{2} \operatorname{GRAD}(p_i)$, wobei $\operatorname{GRAD}(p_i) =$ die Anzahl der Kanten inzident zu $p_i$ in $D_i$ ist.
Jeder Flip erzeugt ein neues Dreieck inzident zu $p_i$

\item Nach jeder Operation müssen wir immer nur die noch nicht geprüften Kanten im Link von $p_i$ auf die lokale Delaunay-Eigenschaft prüfen.
\end{enumerate}

\begin{bsp}
Kaskadierender Flip, d.\,h. es reicht nicht nur die Kanten des Dreiecks in das $p_i$ eingefügt wurde auf die lokale Delaunay-Eigenschaft zu prüfen.
\end{bsp}

\begin{figure}
  \centering
 \includegraphics[width = \textwidth]{grafiken/kaskadierenderflip}
\caption{kaskadierender Flip}
\end{figure} 


$\operatorname{GRAD}(p_i) \leq i-1$, d.\,h. höchstens $\frac{i-1}{2}$ Flips beim Einfügen von $p_i$.

Faustregel und Trick: Wenn immer die Auswahl in einem Algorithmus beliebig ist, dann treffe die Entscheidung zufällig.
In diesem Fall bedeutet das, dass wir die Reihenfolge der Punkte $p_1, \dotsc, p_n$ zufällig wählen.

Jetzt müssen nur noch die erwartete Anzahl von Flip-Operationen beim Einfügen von $p_i$ bestimmt werden.

\begin{beob}
\begin{enumerate}
 \item Bei zufälliger (gleichverteilt) Einfügereihenfolge hat jeder Punkt die gleiche Wahrscheinlichkeit als letzter eingefügt zu werden.
 \item Gesamtanzahl von Flips über alle Einfügereihenfolgen von $i$ Punkten: \[ \sum_{j = 1}^{i} \operatorname{GRAD}_i (p_j)\] 
Wobei $\operatorname{GRAD}_i (p_j)$ der Knotengrad von $p_j$ in $D_i$ ist.
 \item  $\sum_{j = 1}^{i} \operatorname{GRAD}_i (p_j) = 2$ \# Kanten in $D_i$
 \item  Für die Anzahl der Kanten in $D_i$ gilt die Eulerformel: 
\[\text{Anzahl der Knoten }v - \text{Anzahl der Kanten } e + \text{Anzahl der Dreiecke } f = 2\]
Für Delaunay-Triangulierungen gilt außerdem folgendes: 
\[3f = 2(e-h) + h = 2e - h\text{, h ist die Anzahl der Kanten auf Rand von $D_i$}\] 
Daraus folgt: \[f = \frac{2}{3} e - \frac{1}{3} h \]
Durch einsetzen in die Euler-Formel erhält man nun 
\[v - e + \frac{2}{3} e - \frac{1}{3} h = 2\] 
Daraus folgt: \[e = 3v - h - 6\]
\end{enumerate}
\end{beob}

Aus 1-4 folgt: 
\[ \text{Gesamtanzahl von Flips} \leq \frac{1}{2}(2 \cdot 3i - 9 ) \leq 3i\]
% h >= 3.
Daraus folgt die durchschnittliche Anzahl von Flips $\leq 3$.


\subsubsection{Aufwand für das Punktlokalisierungsproblem}

Datenstruktur für die Punktlokalisierung ist der Delaunay-Graph: 
Gerichteter, azyklischer Graph. Abgeleitet aus Split und Flip.
Knoten des Graphen sind alle Dreiecke, die im Verlauf des inkrementellen Algorithmus auftauchen.

\begin{figure}
  \centering
 \includegraphics[width = 0.5\textwidth]{grafiken/dg-flip}
\caption{Delaunay-Graph beim Flip}
\end{figure} 

\begin{figure}
  \centering
 \includegraphics[width = 0.5\textwidth]{grafiken/dg-split}
\caption{Delaunay-Graph beim Split}
\end{figure} 


\begin{bemerk}
Beweis der Eulerformel: $v -e + f = 2$

\begin{enumerate}
 \item 1-Skelett der Delaunay-Triangulierung. (D.\,h. der planare Graph der Delaunay-Kanten und Vertices.)
\item 1-Skelett enthält minimalen Spannbaum von $P$.
\end{enumerate}

Für den Spannbaum gilt: 
\[v = \abs{p} = n\]
\[e = n-1\]
\[f = 1\]

Das bedeutet für diesen Fall gilt die Eulerformel.

Induktion: Durch Einfügen von Delaunay-Kanten in den Spannbaum gilt:
\[v \rightarrow v + 1\]
\[f \rightarrow f + 1\text{ , weil jede neue Kante ein Gebiet teilt}\]
\[v \rightarrow v\]

Damit gilt die Eulerformel.
 \end{bemerk}

%\section{Inkrementeller Algorithmus zur Berechnung der Delaunay-Triangulierung}

%5Lower Hull(P), $\abs{P}= n, P \subset \R^2$

%\begin{algorithm}
%    \dontprintsemicolon
%	\caption{LowerHull($P$), $ |P| = n, P \subset \R^2$}
%    \caption{LowerHull($P$), $\abs{P}= n, P \subset \R^2$}
%    \KwIn{$P \subset \R^2, P = \{p_1, p_2, \dotsc, p_k \}$}
%    \KwOut{Triangulierung und konvexen Hülle}
%	$a:a[0,\dotsc,n]$ Array mit $n+1$ Elementen\;
%	$a[0] \coloneqq p_1$\;
%	\For{$i = 1TO n$}{
%		$a[i]\coloneqqp_i$\;	
%	}
%	$i\coloneqq1$\;
%	\While{$i < LENGTH(q) - 1$}{
%		\eIf{$IS\_LEFT\_OF(a[i], a[i+2], a[i+1])$}{
%			Remove(a,i+1)\; %//Entferne das i+1te Element aus q
%			$i \coloneqq i -1$\;
%		}
%		{
%			$i\coloneqqi +1$\;
%		}	
%	}
%	\For{$i=1$ TO $Length(a)$}{
%		Output a[i]	\;
%	}
%\end{algorithm}

Randomisierte Analyse:

Sei $p_1, \dotsc, p_n$ zufälige Reihenfolge der Punke in $P$.
$D_0, \dotsc, D_n$ folge von Delaunay-Triangulierungen.

$D_0 = {xyz}$ Großes Dreieck, das alle Punkte in $P$ enthält.

$D_i$ entsteht durch $D_{i-1}$ durch
\begin{enumerate}
\item split-Operation: $\sigma \in D_{i-1}$ das Dreieck in Delaunay-Triangulierung von $p_1, \dotsc, p_{i-1}$, das $P$ enthält. (1-3-Flip)
\item Flip-Operationen: 2-2-Flip
\end{enumerate}

\begin{figure}[htbp]
  \centering
\includegraphics[width = 0.5\textwidth]{grafiken/22flip}
\caption{2-2-Flip}
\end{figure}

\begin{figure}[htbp]
  \centering
\includegraphics[width = 0.5\textwidth]{grafiken/13flip}
\caption{1-3-Flip}
\end{figure}


Punktlokalisation durch gerichtete, nicht-zyklische Graphen

\begin{enumerate}
\item Erwartete Größe, des Graphen.
\[\underbrace{1}_{\text{Dreieck}} 		+	\underbrace{3n}_{\parbox{0.3\textwidth}{Einfügen von n Punkten, also n Split-Operationen, jeder Split erzeugt 3 neue Dreiecke}} 											+ 	\underbrace{3 * 2n}_{\parbox{0.3\textwidth}{Jeder Flip erzeugt 2 neue Dreiecke, Pro Runde erwartet drei Flips, $n$ Punkte}}\]
%Dreieck	Einfügen von n Punkten, also n Split-Operationen, jeder Split erzeugt 3 neue Dreiecke
%		Jeder Flip erzeugt 2 neue Dreiecke, Pro Runde erwartet drei Flips, n Punkte
		
D.\,h. Punktlokalisierungsdatenstruktur braucht Speicher $O(n)$

\item Erwartete Laufzeit

Im Schritt $i$ einfügen von $p_i$. D.\,h. wir suchen $\sigma \in D_{i-1}$ mit $p_i \in \sigma_i$. Für Suche starten wir in $xyz$ und gehen dann zu Kind, das $p_i$ enthält.
\end{enumerate}

IN\_TRIANGLE Prädikat:

$p_i \in abc$ falls $p_i$ auf gleicher Seite von 
$\operatorname{aff}(a,b)$ wie $c$,
von $\operatorname{aff}(b,c)$ wie $a$,
von $\operatorname{aff}(c,a)$ wie $b$.

Azyklische Graph zerfällt in Schichten. Eine Schicht für jede Runde.
Betrachte $j$te Schicht $0<j<i-2$. Auf dieser Schicht sind Dreiecke von $D_j$ gespeichert.

Seien $G_j$ die Dreiecke in $D_j$, die beim Einfügen von $p_{j+1}$ zerstört werden.

Seien $H_j$ die Dreiecke in $D_j$, die beim Einfügen von $p_i$ in $D_j$ zerstört werden.

\begin{beob}
Falls $G_j \cap H_j = \emptyset$, dann ist $\sigma_{j+1} = \sigma_j$, wobei $\sigma_j \in D_j$, $\sigma_{j+1} \in D_{j+1}$ die Dreiecke sind, die $p_i$ enthalten.
\end{beob}

Sei $X_j = G_j \cap H_j$, der Aufwand von $\sigma_j$ nach $\sigma_{j+1}$ zu gehen ist höchstens proportional zu $\abs{X_j}$. (Durchlaufen von Dreiecken, die durch Flip-Operationen erzeugt werden.)

Wir müssen $\abs{X_j}$ abschätzen.

Sei $\hat{D}_j$ die Delaunay-Triangulierung von $p_1, p_2, \dotsc, p_j, p_i$.
Seien $Z_j$ die Dreiecke in $\hat{D}_j$, die durch Einfügen von $p_{j+1}$ zerstört werden.

Symbolische Darstellung:

Seien $Y_j$ die Dreiecke inzident zu $p_i$, die beim Einfügen von $p_{j+1}$ in $\hat{D}_j$ zerstört werden

\[ X_j = H_j\ (Z_j\ Y_j)\]
\[ \abs{X_j} = \abs{H_j} - (\abs{Z_j} - \abs{Y_j})\]

\begin{figure}[htbp]
  \centering
\includegraphics[width = 0.7\textwidth]{grafiken/symbolischedarstellung}
\caption{Symbolische Darstellung der Variablen}
\end{figure}

Beachte: $Y_j \subseteq Z_j$ und $Z_j\ Y_j \subseteq H_j$

Erwarteter Suchaufwand ist:
\[E[\sum_{j=1}^{i-2} \abs{X_j}] =  \sum_{j=1}^{i-2} E[\abs{X_j}]  = \sum_{j=1}^{i-2} E[\abs{H_j}] - \sum_{j=1}^{i-2} E[\abs{Z_j}] + \sum_{j=1}^{i-2} E[\abs{Y_j}]\]


$H_j$: Anzahl der zerstörten Dreiecke beim Einfügen von zufälligen Punkt in die Delaunay-Triangulierung von $j$ Punkten.

$Z_j$: Anzahl der zerstörten Dreiecke beim Einfügen eines zufälligen Punktes in die Delaunay-Triangulierung von $j+1$ Punkten.


%=> 
\[E[\abs{H_{j+1}}] = E[\abs{Z_j}]\]
%=> 
\[E[\sum_{j=1}^{i-2} \abs{X_j}] = E[\abs{H_0}] - E[\abs{H_{i-1}}] + \sum_{j=1}^{i-2} E[\abs{Y_j}]\]

\[E[\abs{H_0}] = 3, E[\abs{H_{i-1}}] = 4 => E[\sum_{j=1}^{i-2} \abs{X_j}]  \leq \sum_{j=1}^{i-2} E[\abs{Y_j}]\]

Es bleibt $E[\abs{Y_j}]$ zu bestimmen.
Dazu: Erwartete Anzahl zerstörter Dreiecke beim Einfügen von $p_{j+1}$ in $\hat{D}_j$:
\[1 \text{ (Split)} + 3 \text{ (Flips)} = 4\]
 
In $Y_j$ interessieren uns nur Dreiecke in $\hat{D}_j$, die inzident zu $p_i$ sind.
Die Wahrscheinlichkeit für ein Dreieck in $\hat{D}_j$ inzident zu $p_i$ zu sein ist $\leq \frac{3}{j+1}$.

Daraus folgt:
\[E[\abs{Y_j}] \leq \frac{12}{j+1} = \frac{3}{j+1} 4\]

\begin{gather*}
\begin{split}
E[\sum_{j=1}^{i-2} \abs{X_j}] &\leq 12 \sum_{j=1}^{i-1} \frac{1}{j+1} \\
&\leq 12 H_i \leq 12 \log(i+1) \\
&\leq \sum_{i=1}^n 12 \log(i+1) \\ 
&\leq 12n \log{n+1} \in O(n \log n) \text{ (Gesamte Suchzeit)}
\end{split}
\end{gather*}

\section{(Unendliche) Gleitkommazahlsysteme}

$G_{\beta, t}$ mit $\beta, t > 1$ natürliche Zahl ist Gleitkommezahlsystem.
\[
G_{\beta, t} = \{ y = \sigma m \beta^{e-t} | \sigma \in \{  -1, +1 \}, \beta^{t-1} \leq m < \beta^t-1, e \in \Z \} \cup \{0\}
\]  

$\beta$: Basis des Systems
$t$: Genauigkeit (Precision)

$\sigma$: Vorzeichen

$m$: Mantisse

$e$: Exponent

Gleitkommazahl Approximation: $x \in \R: Fl(x) = \arg\min_{y\in G_{\beta, t}} \abs{x-y}$. 
Falls $\abs{Fl(x)} = 2$, d.\,h. zwei nächste Gleitkommezahlen, dann immer diejenige näher an Null als approximation.

\begin{lemma}
Sei $\mu = \frac{1}{2} \beta^{1-t}$ Dann gilt:
\begin{enumerate}
\item $Fl(x) = x(1+\delta)$, mit $\abs{\delta} < \mu$
\item $\lambda = Fl(x)(1+\delta')$, mit $\abs{\delta'} < \mu$
\end{enumerate}
 (Der relative Approximationsfehler ist immer beschränkt durch $\mu$)
\end{lemma}

\begin{proof}
Annahme $x>0$. Dann können wir schreiben $x = \mu \beta^{e-t}$ mit $\beta^{t-1} \leq \mu < \beta^t-1$, wobei $\mu \in \R$.

Dann $y_1= \lfloor \mu \rfloor \beta^{e-t}, y_2 = \lceil \mu \rceil \beta^{e-t} \in G_{\beta, t}$

\[\abs{Fl(x) - x} \leq min\{ x-y_1, x-y_2 \}
\leq (y_2-y_1)/2
= \frac{1}{ 2}(\lfloor \mu \rfloor - \lceil \mu \rceil)
\leq \frac{1}{2} \beta^{e-t}
\]
Daraus: 
\[
\abs{\frac{Fl(x)-x}{x}} \leq \frac{\frac{1}{2} \beta^{e-t} }{\mu \beta^{e-t}} 
\leq \frac{1}{2} \frac{1}{\beta^{t-1}} = \frac{1}{2} \beta^{1-t} = u
\]

Die Ungleichung ist nur dann eine Gleichung, wenn $\mu = \beta^{t-1}$, aber dann $\abs{Fl(x) - x} = 0$, d.\,h. wir haben immer 
\[
\frac{Fl(x) - x}{x} < u
\]
Daraus folgt für $Fl(x) = x(1+\delta)$
\[
\abs{\delta} = \abs{\frac{x(1-\delta) - x}{x}} < u
\]
Die zweite Behauptung folgt analog.

\end{proof}

Es gibt 2 Arten von Approximationsfehlern: 
\begin{enumerate}
\item relativ: $\abs{\frac{Fl(x) - x}{x}}$
\item absolut: $\abs{Fl(x) - x}$
\end{enumerate}

Notation: 
\begin{enumerate}
\item $a = b\pm c$ heisst  $a \in [b - \abs{c} , b + \abs{c}]$
\item $a \pm b = c \pm d$ falls $[a - \abs{b}, a + \abs{b}] \in [c - {d}, c + {d}]$
\end{enumerate}

Gleitkommazahlenoperationen: $\oplus, \ominus, \otimes$

$x,y \in F_{\beta, t}$, dann ist
\[
x \circledast y = Fl(x * y), * \in {+,-,\times}
\]

\begin{bemerk} 
Das ist Definition, die von fast aller moderner Hardware befolgt wird.
\end{bemerk}

Korollar zu Lemma: 
\begin{enumerate}
\item $x \oplus y = x+y \pm u\abs{x+y}$
\item $x \ominus y = x+y \pm u\abs{x-y} = x-y \pm \abs{\abs{x} + \abs{y}}$
\item $x \otimes y = xy \pm \abs{xy}$
\end{enumerate}


\section{Gleitkommazahlapproximation von Geometrischen Prädikaten}

Beispiel: IS\_LEFT\_OF(p,q,r)

Implementiert als
$\begin{vmatrix}
1 & p_x & p_y \\
1 & q_x & q_y \\
1 & r_x & r_y
\end{vmatrix}
>0$

$\begin{vmatrix}
1 & p_x & p_y \\
1 & q_x & q_y \\
1 & r_x & r_y
\end{vmatrix} = (r_x - p_x)(r_y - q_y) + (p_y - r_y)(r_x - q_x)$

Annahme: $p_x, p_y, q_x, q_y, r_x, r_y \in G_{\beta, t}$
(In der Praxis: Koordinaten sind ganze Zahlen in $G_{\beta, t}$)

Ausdrücke: 
\begin{center}
\begin{tabular}{|c|c|}
\hline
reelle Ausdrücke		&	Gleitkommazahl-Ausdrücke \\
\hline
$w_1 = r_x - p_x$		&	$a_1 = r_x \ominus p_x$	\\
$w_2 = r_y - q_y$		&	$a_2 = r_y \ominus q_y$	\\
$w_3 = p_y - r_y$		&	$a_3 = p_y \ominus r_y$	\\
$w_4 = r_x - q_x$		&	$a_4 = r_x \ominus q_x$	\\
$w_5 = w_1 w_2$		&	$a_5 = a_1 \otimes a_2$	\\
$w_6 = w_3 w_4$		&	$a_6 = a_3 \otimes a_4$	\\
$w_7 = w_5 + w_6$		&	$a_7 = a_5 \oplus a_6$	\\
\hline
\end{tabular}
\end{center}


\begin{enumerate}
\item 
\begin{gather*}
a_i = w_i \pm u \abs{w_i}
\end{gather*}
aus obigem Lemma.

\item 
\begin{gather*}
\begin{split}
a_1a_2 &= (w_1 \pm u \abs{w_1}) \cdot (w_2 \pm u \abs{w_2}) \\
&= w_1 w_2 \pm u w_1 \abs{w_2} \pm u w_2 \abs{w_1} \pm u^2 \abs{w_1 w_2}\\
&= w_1 w_2 \pm (2u + u^2)\abs{w_1 w_2}
\end{split}
\end{gather*}
Genauso für $a_3a_4$.

\item 
\begin{gather*}
\begin{split}
a_5 &= a_1 \otimes a_2 = a_1 a_2 \pm u \abs{a_1 a_2} \text{ (Lemma und def. der Gleitkommazahlen)} \\ 
&= w_5 \pm (2u + u^2)\abs{w_5} \pm u\abs{w_5 \pm (2u + u^2)\abs{w_5}} \\
&= w_5 \pm (3u + 3u^2 + u^3)\abs{w_5}
\end{split}
\end{gather*}

Genauso für $a_6$

\item 
\begin{gather*}
\begin{split}
a_7 &= a_5 \oplus a_6 \\
&= a_5 + a_6 \pm u \abs{a_5 + a_6}\\
&= w_5 \pm (3u + 3u^2 + u^3)\abs{w_5} + w_6 \pm (3u + 3u^2 + u^3)\abs{w_6} \pm ((3u + 3u^2 + u^3)(\abs{w_5} + \abs{w_6}) )\\
&= w_5 + w_6 \pm (3u + 3u^2 + u^3)(\abs{w_5}+ \abs{w_6}) \pm (3u^2 + 3u^3 + u^4)(\abs{w_5} + \abs{w_6}) \pm u(\abs{w_5} + \abs{w_6})\\
&= w_5 + w_6 \pm (4u + 6u^2 + 4u^3 + u^4)(\abs{w_5} + \abs{w_6})\\
&= w_7 \pm (4u + 6u^2 + 4u^3 + u^4)(\abs{w_5} + \abs{w_6}) = \phi 
\end{split}
\end{gather*}
Das Ergebnis ist ein reeler Ausdruck plus die Abschätzung für den Fehler.
\end{enumerate}

Sei $a$ Wert von Gleitkommazahlausdruck, dann falls $a > \phi \rightarrow w > 0$, falls $a < -\phi \rightarrow w < 0$

\begin{bemerk}
Sei $B = max\{ p_x, p_y, q_x, q_y, r_x, r_y \}$. Dann gilt $\abs{\phi} \leq (4u + 6u^2 + 4u^3 + u^4) 8 B^2$. 
Das kann vorberechnet werden.
\end{bemerk}

\begin{beob}
\begin{enumerate}
\item Wenn $x \in \Z$, dann ist $Fl(x) \in \Z$
\item Falls $\abs{\phi}$ < 1, dann $a \in (-\abs{\phi}, \abs{\phi})$. Daraus folgt $w = 0$, da $w \in \Z$ angenommen und Eingabekoordinaten aus $\Z$ angenommen und alle Operationen $+,-,x$ abgeschlossen in $\Z$.
\end{enumerate}
\end{beob}


\section{Degeneriertheit - Symbolische Pertubierung}

Bei theoretischer Analyse der Algorithmen immer Annahme von allgemeiner Lage, d.\,h. in der Ebene
\begin{enumerate}
\item keine drei Punkte auf gemeinsamer Geraden
\item keine vier Punkte auf gemeinsamen Kreisrand.
\end{enumerate}

Vier Punkte auf Kreisrand führt zu Vierecken im Delaunay-Komplex. Es ist also keine Triangulierung mehr.
Vielecke können wir immer Triangulieren, aber wie?


Degeneriertheit kann mit zufälligem Verwackeln (= Verrauschen, Pertubieren) der Eingabe aufgehoben werden. Da man die Eingabe aber nur ungern verändern will, werden wir mit symbolischen Pertubieren arbeiten.



Eingabe: 
Punktmenge $P = \{p_1, \dotsc, p_n\} \in \R^2$ bzw. $(X_1, \dotsc, X_n) \in \R^{2n}$

Mit $P_{ix} = X_{2i-1}$ und $P_{iy} = X_{2i}$.

Für $\{i,j,k\} \in \binom {[n]} 3$, d.\,h. dreielementige Teilmengen von $\{1, \dotsc, n\}$.

Folgende Funktion:
$t_{i,j,k} \colon \R^{2n} \rightarrow \R$

\todo{hier fehlen einige Tafeln}

Frage: Wie $\epsilon > 0$ wählen?
Antwort: Gar nicht, sondern symbolisch pertubieren.

\begin{algorithm}
    \dontprintsemicolon
    \caption{IS\_LEFT\_OF mit symbolisch pertubiert}
    \KwIn{$p,q,r$}
		$d\coloneqq \delta = \begin{vmatrix} 1 & p_x & p_y \\ 1 & q_x & q_y \\ 1 & r_x & r_y \end{vmatrix}$\;
		\If{$d > 0$}{
			\Return{true}\;
		}
		\If{$d < 0$}{
			\Return{false}\;
		}
		$d\coloneqq \delta_1 = \begin{vmatrix} 1 & q_y \\ 1 & r_y \end{vmatrix}$\;
		\If{$d < 0$}{
			\Return{true}\;
		}
		\If{$d > 0$}{
			\Return{false}\;
		}
		$d\coloneqq \delta_2 = \begin{vmatrix} 1 & r_x \\ 1 & q_x \end{vmatrix}$\;
		\If{$d > 0$}{
			\Return{true}\;
		}
		\If{$d < 0$}{
			\Return{false}\;
		}
		$d\coloneqq \delta_3 = \begin{vmatrix} 1 & p_y \\ 1 & r_y \end{vmatrix}$\;
		\If{$d > 0$}{
			\Return{true}\;
		}
		\If{$d < 0$}{
			\Return{false}\;
		}		
		\Return{false}\;
\end{algorithm}

\begin{enumerate}
\item Im Vergleich zum nicht pertubierten Prädikat müssen wir jetzt im schlimmsten Fall vier Determinanten berechnen.
\item Falls Eingabe nicht degeneriert, ergibt pertubiertes Prädikat genau das gleiche Ergebnis wie das Unpertubierte.
\end{enumerate}

In welche Richtung die Entscheidung aufgelöst wird, hängt von der Reihenfolge der Punkte ab.

\section{3D Delaunay-Triangulierung für gewichtete Punkte}

Gewichteter Punkt: $(p, w_p) \in \R^3 \times \R$

Powerabstand zum gewichteten Punkt: $\pi_p (x) = \norm{x-p}^2 - w_p$

\begin{figure}[htbp]
  \centering
\includegraphics[width = 0.5\textwidth]{grafiken/graphenabstandsfunktion-normal}
\caption{Graph der Abstandsfunktion}
\end{figure}


\begin{figure}[htbp]
  \centering
\includegraphics[width = 0.5\textwidth]{grafiken/graphenabstandsfunktion-quadratisch}
\caption{Graph der quadratischen Abstandsfunktion}
\end{figure}


\begin{figure}[htbp]
  \centering
\includegraphics[width = 0.5\textwidth]{grafiken/graphenabstandsfunktion-power}
\caption{Graph der quadratischen Powerabstände}
\end{figure}


\begin{beob}
Nicht alle Eingabepunkte sind Knoten in der Delaunay-Triangulierung. Das tritt genau dann auf, wenn die zugehörige Powerzelle leer ist.
\begin{figure}[htbp]
  \centering
\includegraphics[width = 0.5\textwidth]{grafiken/leerepowerzelle}
\caption{Die Powerzelle von $p_2$ ist leer}
\end{figure}

Ein gewichteter Punkt ist relevant genau dann, wenn seine Powerzelle nicht leer ist.
\end{beob}

\begin{beob}
Ein gewichteter Punkt muss nicht in der eigenen Powerzelle enthalten sein.
\begin{figure}[htbp]
  \centering
\includegraphics[width = 0.5\textwidth]{grafiken/punktnichtinseinerpowerzelle}
\caption{$p_2$ ist nicht in seiner Powerzelle enthalten}
\end{figure}
\end{beob}

Erinnerung: 
Ein Dreieck (in der Ebene) gehört zur Delaunay-Triangulierung wenn seine offene Umkreisscheibe keinen Punkt von $P$ im innern enthält.

Jetzt: 
Ein Tetraeder (im $\R^3$ bei Eingabe gewichteter Punkte) gehört zur gewichteten Delaunay-Tetraedisierung (im Folgenden immer kurz Triangulierung genannt), wenn seine Orthosphäre weiter \todo{weiter?} oder orthogonal zu allen Eingabepunkten ist.

\begin{defini}[Orthogonalität]
$(p, w_p), (q, w_q)$ gewichtete Punkte sind orthogonal zueinander, falls $\pi_{p,q} \coloneqq \norm{p-q}^2 - w_p - w_q = 0$ gilt.
\end{defini}

\begin{bemerk}
Gewichteter Punkte mit positivem Gewicht kann als Ball aufgefasst werden.

\begin{figure}[htbp]
  \centering
\includegraphics[width = 0.5\textwidth]{grafiken/gewichteterpunktalsball}
\caption{Darstellung eines gewichteten Punkts als Ball im $\R^2$}
\end{figure}
\end{bemerk}

\begin{defini}[Orthogonalität zweier Sphären] 
2 Sphären heißen Orthogonal zueinander, wenn sie sich in einer Sphäre eine Dimension niedriger schneiden.

Die Tangenten in den Schnittpunkten sind orthogonal.

\begin{figure}[htbp]
  \centering
\includegraphics[width = 0.5\textwidth]{grafiken/orthogonaletangenten}
\caption{2 Sphären mit orthogonalen Tangenten}
\end{figure}
\end{defini}
%\todo{überprüfen, ob die beiden Definitionen von Orthogonalität stimmen. Kommt mir irgendwie widersprüchlich vor.}

\begin{defini}[Orthosphäre]
Eindeutige Sphäre, die orthogonal zu den 4 gewichteten Knoten des Tetraeders ist.
\end{defini}



Orthosphärenbedingung für gewichtete Delaunay-Triangulierung

Orthogonalität: $(p, w_p)$ und $(w, w_q)$ sind orthogonal, falls 

\[\pi_{p,q} = \norm{p-q}^2 -w_p - w_q = 0 \text{ [Mehr als orthogonal, falls $\pi_{p,q} > 0$]}\]

\begin{defini}[Orthosphären Bedingung]
$P \subset \R^3$ gewichtete Punktmenge
Tetraeder $abcd$ in einer Triangulation von $P$ ist Delaunay-Tetraeder, genau dann wenn die orthosphäre von $abcd$ orthogonal zu den gewichteten Punkten $abc$ und $d$ ist (<- def von orthoshpäre), und mehr als orthogonal von jedem anderen Punkt in $P$.
\end{defini}

Quadratische Distanzfunktion zu $p \in \R^2$

\[d_p(x) = \norm{x-p}^2 = -2p^Tx + \norm{p}^2 + \norm{x}^2\]

\[d_p(x) - \norm{x}^2 \text{ ist Hyperebene im $\R^3$}\]


Anwenden der Transformation  $- \norm{x}^2$ auf alle Punkte im $\R^2$

\begin{beha}
Die Hyperebene $h_p = d_p(x) - \norm{x}^2$ ist tangential an das Paraboloid $\pi$ im Punkt $-\norm{x}^2$
\end{beha}

\begin{enumerate}
\item $(p, -\norm{p}^2) \in \pi$: Einsetzen von $p$ in $h_p$
\item Alle Punkte in $\pi$ sind auf oder unterhalb von $h_p$
denn \[0 \leq \norm{x-p}^2 = \norm{x}^2 - 2p^Tx + \norm{p}^2 = \norm{x}^2 + h_p{x}\]
=> \[-\norm{x}^2 \leq h_p(x)\]
\end{enumerate}

Die Transformation überführt die Graphen von Abstandsfunktionen in Tangentenebene an $\pi$ => Schnitte von Abstandsfunktionen in Schnitte von Tangentialebenen

=> Untere Einhüllende von Abstandsfunktionen wird überführt in obere Einhüllende von Halbräumen begrenzt von Tangentialebenen. 


Projektion der oberen Einhüllenden ergibt das Voronoidiagramm der Eingabepunkte.


\begin{defini}[Polarität]
Nicht-vertikale Hyperebene kann geschrieben werden als $h(x) = -2p^Tx + \norm{p}^2 - c$. (Bestimmt durch $p \in \R^3$ und $c \in \R$)
Polarer Punkt im $\R^4:  h^* = (p, -\norm{p}^2 + c)$ 
\end{defini}


\begin{lemma}[Inzidenzlemma]
$h^*$ liegt über (auf, unter) $g$, genau dann wenn $g^*$ über (unter, auf) $h$ liegt.
\end{lemma}

\begin{proof}
\[h^*= (p, -\norm{p} + c), g(x) = -2q^Tx + \norm{q}^2 - c\]
Betrachten nur den Fall über (auf, unter analog):

\[
-\norm{p} + c >  -2q^Tp + \norm{q}^2 - c (h^*\text{ über }g) \]
\[ => -\norm{q}^2 + c' > - 2r^Tq + \norm{p}^2 - c (g^*\text{ über }h)
\]

\end{proof}


Abstandsfunktion zu gewichtetem Punkt ergibt Hyperebene im $\R^4$ (im Allgemeinen nicht mehr Tangential zu Paraboloid $\pi$)

Weiterhin gültig: Rückprojektion der oberen Einhüllenden Des Schnittes, der nach unten offenen Halbräume (berandet durch die transformierte Abstandsfunktionen) gibt das Power-Diagramm. (gewichtete Voronoi-Diagramm)

\begin{beob}
Zwei gewichtete Punkte sind orthogonal zueinander, genau dann wenn $\hat p^*$ auf $\hat q$ liegt, wobei $\hat p$ Hyperebene $\hat p(x) = -2p^Tx + \norm{p}^2 - w_p$, $\hat p^* = (p, -\norm{p}^2 + w_p)$

Analog für $q$
\end{beob}

\begin{proof}
$\hat p^*$ liegt auf $\hat q$ bedeutet:
\[
-\norm{p}^2 + w_p = -2q^Tp + \norm{q}^2 - w_q
=> \norm{p}^2 - 2p^Tq + \norm{q}^2 - w_p - w_q = 0
=> \norm{p-q}^2 - w_p - w_q = 0
 \]
\end{proof}

\begin{folg}
Powervertex im $R^3$ (im nicht-degenerierten Fall) hat den gleichen Power-Abstand zu vier gewichteten Eingabepunkten.
=> Transformierter Powervertex ist im Schnitt von 4 transformierten Abstandsfunktionen. [nicht-vertikale Hyperebenen]
=> $\exists$ gewichteter Punkt $(v, w_v)$, der orthogonal zu den vier gewichteten Eingabepunkten ist.
Dabei st $v$ der Powervertex. $(v, w_v)$ ist die Orthosphäre des durch die vier Eingabepunkte gegebenen Tetraeders.

\end{folg}


\begin{defini}[Lokale Delaunay-Bedingung]

Sei $P \subset \R^3$ eine gewichtete Punktmenge. Ein Dreieck $bcd$ in einer Triangulierung von $P$ hat die lokale Delaunay-Eigenschaft, falls entweder 
\begin{enumerate}
\item $bcd$ ist auf dem Rand der konvexen Hülle von $P$ [D.\,h. $bcd$ hat nur einen inzidenten Tetraeder.], oder

\item $bcd$ hat 2 inzidente Tetraeder $abcd$ und $bcde$, so dass der gewichtete Punkt $e$ mehr als orthogonal zur Orthosphäre von $abcd$ ist.  
\end{enumerate}
\end{defini}

=> Idee: Herstellen der globalen Delaunay-Triangulierung durch sicherstellen er lokalen Bedingung für jedes Dreieck. => \enquote{Flippen}

Projektion von 4 Punkten in die Ebene.


\begin{satz}[Radons Theorem]
Gegeben $n \geq d+2$ Punkte im $\R^d$. Dann gibt es eine Zerlegung der Punktmenge $P = P_1 \cup P_2$, so dass $conv(P_1) \cap conv(P_2) \neq \emptyset$. 
\end{satz}

\begin{proof}
$n \geq d+2$ Punkte im $\R^d$ müssen affin abhängig sein.  Es gibt $\lambda_i $, so dass $\sum_{i=1}^n \lambda_i p_i = 0$ und nicht alle $\lambda_i = 0$ und $\sum_{i=1}^n \lambda_i = 0$.

Sei $I \subset [1, \dotsc, n]$ mit $\lambda_i > 0$ falls $i \in I$.
\[c \coloneqq \sum_{i \in I} \lambda_i = - \sum_{i \in [1..n]\ I} \lambda_i\]
\[ \underbrace{\frac{1}{c} \sum_{i \in I} \lambda_i p_i}_{ \in conv\{p_i | i \in I\} } = 	\underbrace{-\frac{1}{c} \sum_{i \in [1, .., n]\ I} \lambda_i p_i}_{\in conv\{p_i | i \in [1, \dotsc, n] \setminus I\} }  \]
					

=> $conv\{p_i | i \in I\} \cap$
$conv\{p_i | i \in [1, \dotsc, n] \setminus I\} \neq \emptyset$
\end{proof}



\begin{satz}
Haben alle Dreiecke in $K$ die lokale Delaunay-Eigenschaft, dann ist $K$ die (gewichtete) Delaunaytriangulierung
\end{satz}
\begin{proof} Genauso wie im ungewichteten 2D"=Fall, d.\,h. zeige dass für jeden Tetraeder $abcd \in K$ gilt, dass Orthosphäre von abcd mindestens orthogonal zu allen Punkten aus $P$.
\end{proof}

\subsubsection{Flips im 3D}

Projektion von 4D"=Tetraeder in den $\R^3$

\begin{enumerate}
\item Ein Punkt in konvexer Hülle von vier Punkten -> 1-4 Flip
\item Fünf Punkte in konvexer Lage -> 2-3 Flip
Entweder zwei Tetraeder inzident zu bcd, oder drei Tetraeder inzident zu a
\end{enumerate}

Vorsicht

$bc$ nichtkonvexe Kante. Zwei Möglichkeiten:
\begin{enumerate}
\item cb hat drei inzidente Tetraeder.
=> 3-2 Flip möglich

\item $cb$ hat mehr als drei inzidente Tetraeder:
=> $bcd$ heisst nicht-transformierbar [Beachte: in dem Fall ist die Kante ae nicht vorhanden. ]
\end{enumerate}


Inkrementeller Algorithmus

\begin{algorithm}
    \dontprintsemicolon
    \caption{Inkrementeller Algorithmus für 3D Delaunay-Triangulierung}
    \KwIn{$P \subset \R^3$ (gewichtet), $P = \{p_1, \dotsc, p_n\}$ beliebig (d.\,h. am Besten zufällige Ordnung)}
    Sei $D_i$ Delaunay Triangulierung von $p_1, \dotsc, p_i, c, y, z, w$\;
    $D_0$ sei hinreichend großer Tetraeder $xyzw$\;
    \For{$i = 1$ TO $n$}{
	Finde $pqrs$ In $D_{i-1}$ Mit $p_i \in pqrs$  // Point Location\;
	\If{$p_i$ ist nicht-redundant bzgl p, q, r und s}{
		Füge $P_i$ mittels 1-4 Flip ein\;
	}
    }
    \While{ $\exists bcd$ Dreieck in momentaner Triangulierung, das nicht die lokale Delaunay-Eigenschaft hat }{
    	Flip $bcd$\;    
    }
\end{algorithm}
	
	
\begin{algorithm}
    \dontprintsemicolon
    \caption{lokale Korrektur}
    \KwIn{Stack von Dreiecken, die möglicherweise geflippt werden müssen}
    \While{$stack \neq \emptyset$}{
		$bcd \coloneqq$ pop von stack\;
		\If{$bcd \in momentaner Triangulierung$ AND bcd hat nicht lokale Delaunay-Eigenschaft AND bcd ist transformierbar} {
			wende 2-3, 3-2 oder 4-1 Flip an\;
			push erzeugte Dreiecke auf den Stack\;
		}
	}
\end{algorithm}
	
%lokale korrektur
%	Stack von Dreiecken, die möglicherweise geflippt werden müssen
%	while $stack \neq \emptyset$ Do
%		bcd \coloneqq pop von stack
%		if $bcd \in momentaner Triangulierung$ AND bcd hat nicht lokale Delaunay-Eigenschaft AND bcd ist transformierbar
%			wende 2-3, 3-2 oder 4-1 Flip an
%			push erzeugte Dreiecke auf den Stack
%		end if
%	end while
	
	
\begin{beob}
Als Linkkandidaten sind nur Dreiecke im Link von $p_i$ relevant
\begin{enumerate}
\item Falls Dreieck $\notin$ Stern von $p_i$, dann gehört das Dreieck zu $D_{i-1}$, d.\,h. es hat die lokale Delaunay-Eigenschaft
\item bc sei Kante im Link => $p_i bc \in Stern(p_i)$
$p_i bc \notin Link(p_i)$ (Bild)
\end{enumerate}

Seien $p_ibcx$ und $p_ibcy$ Tetraeder inzident zu $p_ibc$ falls $xp_ibcy$ konvex ist, könnten wir einen 2-3 Flip anwenden.
=> neue Tetraeder $xyp_ib$, $xyp_ic$ und $xybc$

xybc hat nur Knoten aus $\{1, \dotsc , p_{i-1}\}$, gehört nicht zum Stern. Müsste zu Delaunay-Triangulierung von $D_{i-1}$ gehören. Widerspruch, da 2-3-Flip nicht möglich.

Fall $xp_ibcy$ nicht-konvex und $p_ibc$ ist transformierbar, dann ist auch entweder $bcx$ oder $bcy$ transformierbar, d.\,h. wir können Dreieck $\in Link(p_i)$ anstelle von $p_ibc$ transformieren.
	
\end{beob}

\begin{beha}
Falls keine Transformierbaren Dreiecke im $Link(p_i)$ gibt, die nicht die lokale Delaunay-Eigenschaft haben, dann ist momentane Triangulierung die Deleunay Triangulierung D.
\end{beha}

\begin{proof}
Annahme: Es gibt Dreiecke $\in Link(p_i)$, die nicht die lokale Delaunay Eigenschaft haben, aber alle nicht-transformierbar sind. (wollen widerspruch)
Seien L Dreiecke im Link von $p_i, L' \subseteq L$ seien Dreiecke, die nicht lokale Delaunay und nicht transformierbar sind.

Seien T' die Tetraeder inzident zu L', mit $T' \cap Stern(p_i) = \emptyset$.
Sei $t \in T'$, so dass $\pi_{t,p_i}$ minimal ist unter allen Tetraeder in $T'$.

Erinnerung $\pi_{t,p_i}$ ist der Abstand der Orthosphäre von t zum (gewichteten) Punkt $p_i$.

=> $\pi_{i,p_i} < 0$ [Da nicht lokale Delaunay Eigeschaft im Dreieck $t \cap Stern(p_i) = bcd$]

Ziel zu zeigen, dass $bcd$ transformierbar ist

$bcd \in Link(p_i)$
Bild
falls $p_ibcde$ konvex, dann transformierbar mit 2-3-Flip
=> $p_ibcde$ nicht konvex
\begin{enumerate}
\item Annahme: Genau eine nicht-konvexe Kante bc 
Sei xbcd Tetraeder $\neq t$ inzident zu bce. Falls $x = p_i$, dann 3-2-Flip um Kante bc möglich.
=> entweder $x \neq p_i$, oder zweite nichtkonvexe Kante

\item Annahme: 2 nichtkonvexe Kanten bc, cd seien bcex und cdey Tetraeder $\neq t$ inzident zu bce BZW. cde Falls $x = y = p_i$ => 4-1 Flip möglich
\end{enumerate}
%....

Situation: Nicht alle Dreiecke haben die lokale Delaunay-Eigenschaft, aber alle Dreiecke im Link sind nicht transformierbar.

%\begin{figure}
\begin{center}
 \includegraphics[width = 0.5\textwidth]{grafiken/delaunay3d}
\end{center}
%\caption{IS\_LEFT\_OF-Prädikat}
%\end{figure} 

$abcd$ Tetraeder, der inzident zu Dreieck $bcd \in Link{p_i}$, so dass $\pi_{abcd, p_i} < 0$ minimal ist.

Betrachte Dreiecke $abc$ und $abd$.
Seien $abcx$ und $abcy$ Tetraeder $\neq abcd$. Falls $x = y = p_i$, dann ist $abcdp_i$ Transformierbar mit einem 4-1-Flip.

%\begin{figure}
\begin{center}
 \includegraphics[width = 0.5\textwidth]{grafiken/delaunay3d-2}
\end{center}
%\caption{IS\_LEFT\_OF-Prädikat}
%\end{figure} 

Da nichttransformierbarkeit angenommen, gibt es $x$ mit $abcx \neq abcp_i$ und $bc$ nicht-konvex. Das bedeutet der Strahl startend von $p_i$, der durch $abc$ geht, muss zuerst durch ein Dreieck im $Link(p_i)$ gehen.

Widerspruch: Tetraeder $\sigma$ in $D_{i-1}$ sind längs des Strahls von $p_i$ geordnet gemäß $\pi_{\sigma, p_i}$. Das ist ein Widerspruch zu $abcd$ minimal.

[Ordnung längs des Strahls haben wir schon bewiesen, als wir im 2D gezeigt haben, dass lokale Delaunay-Eigenschaft die Delaunay-Eigenschaft impliziert.]
\end{proof}

\chapter{Geometrisch modellieren}

Idee: Benutze Delaunay-Triangulierung um Flächen im 3D zu beschreiben.


\begin{figure}
\centering
 \includegraphics[width = 0.5\textwidth]{grafiken/kurve}
\caption{Kurve im $\R^2$ mit Sampling} 
\end{figure} 


Kurve im $\R^3$:
$\gamma[0,1] \rightarrow \R^2$
mit 
\begin{enumerate}
\item Glatt (unendlichoft stetig differenzierbar)
\item Injektiv, bis auf $\gamma(0) = \gamma(1)$
\end{enumerate}

$P \subset \Sigma = \gamma[0,1]$

Ziel: Rekonstruiere $\Sigma$ aus $P$.

\begin{defini}[Leeres Segment]
$\gamma(x,y)$ heißt leeres Segment, falls $x = \gamma(t)$, $y = \gamma(s)$ und $\gamma([t,s]) \cap P = \emptyset$
\end{defini}

\begin{defini}[korrekte Kante]
$pq$ mit $p,q \in S$ heißt korrekte Kante, falls $\gamma(p,q)$ leeres Segment ist, d.\,h. korrekte Kante verbindet konsekutive Punkte längs von $\gamma$.
\end{defini}

\begin{bemerk}
Aus beliebigen Sampling ist es schwierig bzw. unmöglich korrekte Kanten zu finden. Wir brauchen zusätzliche Bedingung.
\end{bemerk}

\begin{defini}[mediale Achse]
Gegeben $\Sigma \subset \R^d$ kompakt (abgeschlossen und beschränkt). Die mediale Achse $M(z) = 
CL\{ x \in \R^d \setminus \Sigma | x \text{ hat mindestens 2 nächste Nachbarn in } \Sigma \}$
\end{defini}

\begin{bemerk}
Mediale Achsen finden auch Anwendung in 
\begin{itemize}
\item Virtual Colonoscopy
\item Fahrplanung in der Robotik
\item Stick Figures bei Animation
\end{itemize}
\end{bemerk}

\begin{defini}[mediale Bälle]
$x \in M(z)$, dann heißt $B(x,d(x, \Sigma))$ ($d(x, \Sigma) = \inf \norm{x-y}\text{ mit }y \in \Sigma$) ein medialer Ball.
\end{defini}

\begin{figure}
\centering
 \includegraphics[width = 0.5\textwidth]{grafiken/skelet}
\caption{Mediale Achse mit Bällen} 
\end{figure} 

\begin{defini}[$\epsilon$-Sampling]
$p \subset \Sigma$ heißt $\epsilon$-Sampling für $\epsilon > 0$, falls $\forall x \in \Sigma$, $\exists p \in P$ mit $\norm{x-p} \leq \epsilon f(x)$, wobei $f \colon \Sigma \rightarrow \R$, $x \mapsto d(x, M(\Sigma))$. [Die Funktion $f$ wird lokale Feature Größen Funktion genannt.]
\end{defini}



%Crust(p)
%1. Berechne das Voronoi-Diagramm von $p$. $V\coloneqq$ Menge der Voronoi-Vertices.
%2. Berechne die Delaunay-Triangulierung von $P \cup V$.
%3. Gebe alle Kanten aus $Del(P\cup V)$ aus, deren Endpunkte beide in $P$ sind.
\section{Crust-Algorithmus}
\begin{algorithm}
    \dontprintsemicolon
    \caption{Crust (Krusten)-Algorithmus}
    \KwIn{$P \subset \Sigma$ Sampling der Kurve $\Sigma$.}
 Berechne das Voronoi-Diagramm von $p$. $V\coloneqq$ Menge der Voronoi-Vertices.\;
 Berechne die Delaunay-Triangulierung von $P \cup V$.\;
 Gebe alle Kanten aus $Del(P\cup V)$ aus, deren Endpunkte beide in $P$ sind.\;
\end{algorithm}

\begin{beha}
Falls $p$ $\epsilon$-Sampling mit $\epsilon < 0,2$, dann gibt der crust-Algorithmus genau die korrekten Kanten aus.
\end{beha}

Eigenschaften der Feature Größen Funktion:
\begin{enumerate}
\item $f\colon \Sigma \rightarrow \R$, $x \mapsto d(x, M(\Sigma))$ ist 1-Lipschitz, d.\,h. $f(x) \leq f(y) + \norm{x-y}$

\begin{proof}
Sei $m \in M(z)$ mit $f(y) = \norm{y - m}$, dann $f(x) \leq \norm{x - m} \leq \norm{x-y} + \norm{y-m} = \norm{x-y} + f(y)$ (Dreiecksungleichung)
\end{proof}

\item Feature Verschiebungslemma

Sei $\epsilon < 1$ und $\norm{x - y} \leq \epsilon f(x)$, dann gilt:
\begin{enumerate}
\item $f(x) \leq \frac{1}{1 - \epsilon} f(y)$
\item $\norm{x-y} \leq \frac{\epsilon}{1 - \epsilon} f(y)$
\end{enumerate}

\begin{proof}
\begin{enumerate}
\item $f(x) \leq f(y) + \norm{x-y} \leq f(y) + \epsilon f(x)$ Lippschitz-Stetigkeit =>
$(1 - \epsilon) f(x) \leq f(y)$ => $f(x) \leq \frac{1}{1-\epsilon} f(y)$
\item $\norm{x-y} \leq \epsilon f(x) \leq \frac{\epsilon}{1 - \epsilon} f(y)$
\end{enumerate}
\end{proof}

\end{enumerate}

Schnitte von Bällen mit $\Sigma$

\begin{lemma}
Falls ein Ball~$B$ eine Mannigfaltigkeit $\Sigma \subset \R^d$ (z.\,B. glatte Kurven im $\R^2$, glatte Fläche im $\R^3$) in mindestens einem Punkt schneidet, und falls entweder
\begin{enumerate}
\item $B \cap \Sigma$ kein topologischer d-Ball ist, oder
\item $\gamma(B \cap \Sigma)$ keine topologische (d-1)-Sphäre ist
\end{enumerate}
dann enthält $B$ einen Punkt von der medialen Achse von $\Sigma$.
\end{lemma}


\begin{figure}
\centering
 \includegraphics[width = 0.5\textwidth]{grafiken/kurveundbaelle}
\caption{Bälle schneiden die Kurve} 
\end{figure} 

\begin{lemma}[leeres Segment]
Sei $P$ $\epsilon$-Sampling von Kurve $\Sigma$ mit $\epsilon < 1$ seien $p \in P$ und $x \in \Sigma$, so dass das Segment $\gamma(p,x)$ leer ist. Sei $z$ der Schnitt des Bisektors von $px$ mit $\Sigma$. Dann gilt:

\begin{enumerate}
\item Der Ball $B(z, \norm{z-p})$ schneidet $\Sigma$ nur in $\gamma(p,x)$
\item $B(z, \norm{p-z})$ ist leer, d.\,h. der offene Ball enthält keine Sample-Punkte
\item $\norm{p-z} \leq \epsilon f(z)$
\end{enumerate}
\end{lemma}


%\begin{figure}
\begin{center}
 \includegraphics[width = 0.5\textwidth]{grafiken/lemma-leeressegment}
\end{center}
%\caption{} 
%\end{figure} 



\begin{proof}

$B\coloneqq B(z, \norm{p-z})$
$\gamma \coloneqq \gamma(p,x)$


Annahme: $B \cap \Sigma \neq \gamma$
Verkleinern $B$ zu $B'$.  => $B' \cap \Sigma$ ist kein topologischer 1-Ball. Im offenen Ball $B'$ liegt keine Sampling Punkte in $B' \cap P = \emptyset$

Radius von $B' > f(z)$ 

da $\epsilon$-Sampling: $\exists p': \norm{p' - z} \leq \epsilon f(z) < f(z)$ -> Widerspruch.-> 1.

2. und 3. folgen daraus. 3. folgt, da $p$ ein $\epsilon$-Sample. $\norm{z-p} \leq f(z)$

\end{proof}

\begin{lemma}[kurze Segmente]
Sei $x$ und $y$ zwei bliebige Punkte, so dass $\gamma(x,y)$ leer ist. Dann gilt: $\norm{x-y} \leq \frac{2\epsilon}{1-\epsilon} f(x)$, für $\epsilon < 1$ und jedes $\epsilon$-Sampling.

(Zwei Punkte $x,y$, zwischen denen keine Sampling-Punkte liegen: Diese sind relativ nah beieinander (abhängig von der lokalen Feature Größen Funktion)
\end{lemma}

\begin{proof}
da $\gamma(x,y)$ leeres Segment, ist es Teilstück eines leeren Segments $\gamma(p,q)$ mit $p,q \in P$ - Sampling Punkte.

Sei $z$ der Schnitt des Bisektors mit $\gamma(p,q)$. Behandle Ball $B(z, \norm{p-z})$.

=> offener Ball $B(z, \norm{p-z})$ ist leer, d.\,h. enthält keine Sampling Punkte. => das leere Segment-Lemma gilt. (speziell die dritte Behauptung)

$x,y \in B$: $\norm{z-x} \leq \epsilon f(z)$, da $\epsilon$-Sample.

laut Feature Verschiebungslemma: $f(z) \leq \frac{1}{1 - \epsilon} f(x)$.

$\norm{x-y} \leq 2\norm{p-z}$ (Dreiecksungleichung
$\leq \frac{2 \epsilon}{1 - \epsilon} f(x) )$
\end{proof}


\begin{lemma}
Sei $pq$ eine korrekte Kante. Für $\epsilon < 1 $ gilt ($\epsilon$-Sampling)
\begin{enumerate}
\item $\norm{p-q} \leq \frac{2\epsilon}{1-\epsilon} f(p)$
\item $pq$ ist Delaunay-Kante
\end{enumerate}
\end{lemma}

\begin{proof}
\begin{enumerate}
\item da $pq$ eine korrekte Kante ist => $\gamma(p,q)$ ist leer
=> $\norm{p-q} \leq \frac{2\epsilon}{1-\epsilon} f(p)$

\item laut Leeren Segment Lemma existiert Ball, der $p$ und $q$ auf dem Rand hat und im Inneren keine Sampling Punkte hat.
=> $pq$ ist Delaunay-Kante
\end{enumerate}
\end{proof}

\begin{figure}
\centering
 \includegraphics[width = 0.5\textwidth]{grafiken/samplingvoronoi}
\caption{Punktsampling und deren Voronoi-Knoten} 
\end{figure} 

inkorrekte Kanten: deren umschließender leerer Ball schneidet die mediale Achse => sie enthalten einen Voronoi-Knoten.

$P \cup V$ (V - Menge der Voronoi-Knoten) So verschwinden die inkorrekten Kanten. Aber es entstehen neue, zusätzliche Kanten. Diese werden aber einfach nicht ausgegeben.


CRUST-Algorithmus: 

\begin{algorithm}
    \dontprintsemicolon
    \caption{CRUST-Algorithmus}
    \KwIn{$\epsilon$-Sampling, $P \subset \Sigma: \epsilon \leq 0.2$}
    berechne Voronoi-Knoten des Punktsamplings P.\;
    berechne Delaunay-Triangulierung von $P \cup V$\;
    gebe Knoten aus $Del(P \cup V)$ aus, deren Endpunkte beide in $P$ liegen\;
\end{algorithm}


\subsection{Korrektheitsbeweis für Crust Algorithmus}

\begin{lemma}
\label{crust1}
Sei $p$ ein $\epsilon < 0,2$-Samplung einer glatten Kurve, $\Sigma < \R^2$, dann sind alle korrekten Kanten in $\operatorname{crust}(P)$.
% [Korrekte Kante. Liniensegment, dass konsekutive Kantenpunkte vereinigt.]
\end{lemma} 

\begin{lemma}
\label{crust2}
Unter den Vorraussetzungen von \autoref{crust1} ist keine nicht-korrekte Kante in $\operatorname{crust}(P)$.

\end{lemma} 

Es gilt immer $\epsilon < 0,2$-Sampling

\begin{lemma}[Empty Segment]
$p \in P, x \in \Sigma$, so dass $\gamma(p,x)$ leer ist, $z$ Schnittpunkt des Bisektors von $p$ und $x$ mit $\gamma(p,x)$ dann gilt:
\begin{enumerate}
\item $B(z,\norm{p-z})$ schneidet $\Sigma$ nur in $\gamma(p,x)$
\item $B(z,\norm{p-z}) \cap P = \emptyset$ ($B(z,\norm{p-z})$ ist ein offener Ball)
\item $\norm{p-z} \leq \epsilon f(x)$ 
\end{enumerate}
\end{lemma}

\begin{lemma}[Small Segment]
$x,y \in \Sigma$, so dass $\gamma(x,y)\cap P = \emptyset$, dann $\norm{x-y} \leq \frac{2\epsilon}{1-\epsilon}$
\end{lemma}

\begin{lemma}[Small Edge]
Sei $pq$ korrekte Kante, dann 
\begin{enumerate}
\item $\norm{p-q} \leq \frac{2\epsilon}{1 - \epsilon} f(p)$
\item $pq$ ist Delaunay
\end{enumerate}
\end{lemma}

\begin{lemma}[Segment Angle]
\label{smallangle}
$x,y,z \in \Sigma, \norm{x-y}, \norm{y-z} \leq \frac{2\epsilon}{1-\epsilon} f(y)$.
$\alpha$ sei der Winkel der Tangente von $\Sigma$ in $y$ mit dem Segment $yz$, dann gilt:
\begin{enumerate}
\item $\alpha \leq \arcsin \frac{\epsilon}{1-\epsilon}$ und
\item $\measuredangle xyz \geq \pi -2\arcsin \frac{\epsilon}{1-\epsilon}$ 
\end{enumerate}
\end{lemma}

\begin{proof}
\begin{figure}
\centering
 \includegraphics[width = 0.5\textwidth]{grafiken/smallangle}
\caption{Skizze zum Beweis des Small Angle-Lemmas (\autoref{smallangle})} 
\end{figure} 
$\alpha = \arcsin(\frac{\norm{y-z'}}{2} / \norm{m-y}) \leq  \arcsin(\frac{\norm{y-z}}{2} / \norm{m-y})$ \todo{2 oder $z$ im Nenner?}

Es gilt:
\begin{enumerate}
\item $\norm{y-z} \leq \frac{\epsilon}{1-\epsilon} f(y)$
\item $f(y) \geq \norm{m-y}$
\end{enumerate}

Daraus folgt $\alpha \leq \arcsin(\frac{\epsilon}{1-\epsilon})$

Für 2. betrachte $\measuredangle myz = \frac{\pi}{2} - \alpha > \frac{\pi}{2} - \arcsin(\frac{\epsilon}{1-\epsilon})$
und $\measuredangle myx \geq  \frac{\pi}{2}  - \arcsin(\frac{\epsilon}{1-\epsilon})$

Es folgt: $\measuredangle xyz \geq  \pi  - 2\arcsin(\frac{\epsilon}{1-\epsilon})$. Das gilt, falls $x$ oberhalb der Tangente liegt sowieso. Ansonsten folgt es wegen der beiden vorherigen Formeln.

\end{proof}

\begin{proof}[\autoref{crust1}]
Sei $pq$ korrekte Kante. Aus dem Empty Segment Lemma folgt $B \cap P = \emptyset$. Aber es ist möglich, dass $B \cap \{v | v \text{ Voronoi-Vertex von Punktmenge $P$}\} \neq \emptyset$.

\begin{figure}
\centering
 \includegraphics[width = 0.5\textwidth]{grafiken/crustlemma1}
\caption{Empty Segment Lemma} 
\end{figure} 

Beachte: Crust Algorithmus gibt Kanten in der Delaunay-Triangulierung von $P\cup V$ aus, die beide Enden in $P$ haben.

Annahme: $v \in B$, wobei $v$ Voronoi Vertex von $P$ ist.

Betrachte $\norm{p-v}$
\begin{enumerate}
\item $\norm{p-v} 
\leq 2\norm{p-z} %\text{ (Durchmesser des Balls) }
\leq 2 \epsilon f(z) %\text{ (Empty Segment Lemma 3.) }
\leq 2 \frac{\epsilon}{1-\epsilon} f(p)$
\end{enumerate}

\item $2\norm{p-v} \geq f(p)$, sei $B'$ Voronoi-Ball mit Mittelpunkt $v$. % 1-Ball (Segment) schneiden *
$B'$ ist Umkreisball eines Delaunay-Dreiecks $rst$ (Dual zum Voronoi-Vertex $v$.)
\begin{figure}
\centering
 \includegraphics[width = 0.7\textwidth]{grafiken/ballbstrich}
\caption{Ball $B'$} 
\end{figure} 

=> $B'$ muss Punkt in der medialen Achse enthalten. $\norm{p-m} \geq 2\norm{p-v}$.

=> $B'$ kann $\Sigma$ nicht in einem 1-Ball schneiden.

Insgesamt folgt:
\[
\frac{1}{2} f(p) \leq \norm{p-v} \leq \frac{2\epsilon}{1-\epsilon} 
\]
Das ist ein Widerspruch falls $\frac{2\epsilon}{1-\epsilon} < \frac{1}{2} \Leftrightarrow 5\epsilon < 1$. Widerspruch, da $\epsilon < 0,2$ angenommen wurde.

=> $pq \in \operatorname{crust}(P)$ für alle korrekten Kanten $pq$.  

\end{proof}


\begin{proof}[\autoref{crust2}]

Crust gibt keine nicht-korrekten Kanten aus für $\epsilon < \frac{1}{5}$. 

Annahme für Widerspruch: $pq$ nicht-korrekte Kante in $\operatorname{Crust}(p)$.

Daraus folgt, es gibt Ball $D$ mit $p,q \in \partial D$ (Rand von D) und $D \cap P = \emptyset, D \cap \{v | \text{ $v$ Voronoi Vertex von $P$ }\} = \emptyset$

\begin{figure}
\centering
 \includegraphics[width = 0.5\textwidth]{grafiken/crustlemma2}
\caption{Skizze zum Beweis von \autoref{crust2}} 
\end{figure} 

$z, z'$ sind die beiden Schnittpunkte des Bisektors von $p$ und $q$ mit dem Rand von $D$.

$B = B(z, \norm{z-p})$, 
$B' = B(z', \norm{z'-p})$.

\begin{enumerate}
\item Behauptung: Sowohl $B$ als auch $B'$ können keinen Punkt von $P$ enthalten.
$B \cap P = \emptyset = B' \cap P$
\begin{proof}
Transformiere $D$, so dass $p,q \in \partial D$ erhalten bleibt und $D(1) = B$. [Pencil zwischen $D$ und $B$.]

Falls $B \cap P \emptyset$, dann $\exists \lambda \in (0,1)$ mit $\partial D(\lambda) \cap P \neq \emptyset$, d.\,h. $D(\lambda)$ hat $p,q$ und einen weiteren Punkt $r\in P$ auf dem Rand => $D(\lambda)$ ist Voronoi Ball des Delaunay-Dreiecks $pqr$. => Widerspruch, da $D$ keine Voronoi-Vertices im Inneren enthält. (nach Annahme.)
\end{proof}

\item $\measuredangle zpz' = \frac{\pi}{2}$ (Satz von Thales)
=> Tangenten von $B$ und $B'$ in $p$ schneiden sich im Winkel von $\frac{\pi}{2}$.
=> $\Sigma$ kann nicht tangential zu $B$ und $B'$ in $P$ sein.


\item Annahme: $\Sigma$ ist weder Tangential zu $B$ noch zu $B'$ in $p$.
Sei $p_1$ der erste Schnittpunkt von $\Sigma$ mit $B$ längs $\Sigma$, und sei $p_2$ der erste Schnittpunkt von $\Sigma$ mit $B'$ längs $\Sigma$
=> $\norm{p-p_1}, \norm{p-p_2} \leq \frac{2\epsilon}{1-\epsilon} f(p)$ (folgt aus dem Small Segment Lemma, da $\gamma(p, p_1), \gamma(p,p_2)$ leer sind, denn $B$ bzw. $B'$ enthalten keine Punkte von $P$.
\end{enumerate}

Aus Segment Angle Lemma folgt $\measuredangle p_1 p p_2 \geq \pi - \arcsin \frac{\epsilon}{1-\epsilon}$
=> $\alpha \geq \frac{1}{2} (\pi - 2\arcsin(\frac{\epsilon}{1-\epsilon}) - \frac{\pi}{2})$, wobei $\alpha$ der Winkel zwischen Tangente  an $B$ in $D$ und dem Liniensegment $pp_1$ ist. [Hier ist $\alpha$ größer angenommen, als entsprechender Winkel für $B'$.] 
\end{proof}



\begin{lemma}
Der Crust-Algorithmus gibt keine nicht-korrekte Kante aus für $\epsilon$-Sampling mit $\epsilon < 0,2$
\end{lemma}
\begin{proof}
$pq$ nicht-korrekt.
$\alpha$ Winkel von Segment $pp_1$ mit Tangente an $\Sigma$ in $p$
D. Ball mit $p,q \in \partial B$

$B \cap P \neq \emptyset$ [$P$ Samplepunkte]

$B \cap V \neq \emptyset$ [$V$ Voronoivertices des Voronoi-Diagramms von $P$]

In letzter Stunde: $\alpha \geq \frac{\pi}{4} - \arcsin \frac{\epsilon}{1-\epsilon}$ [untere Schranke für $\alpha$]

Heute: Obere Schranke für $\alpha$. Konstruiere $x$ als Schnitt des Bisektors von $p$ und $p_1$ mit Kurvensegment $\gamma{p,p_1}$.

\begin{beob}
Da $p$ und $q$ nicht konsekutiv längs $\Sigma$ sind, gilt entweder $\gamma(p,q) \not \subset B$ oder $\gamma(q,p) \not \subset B$ [Echte Teilmenge]. Bachte: Wir haben gezeigt, dass $B$ keinen Punkt von $P$ im inneren enthält.

=> $B$ schneidet $\Sigma$ nicht in 1-Ball, d.\,h. $B$ muss Punkt der medialen Achse enthalten..

=> $f(x) \leq 2r$, mit $r$ Radius von $B$
[<=> $r \geq \frac{1}{2} f(x)$]


$\underbrace{\epsilon f(x) \geq \norm{p-x}}_{\text{Da $p$ einer der beiden konsekutiven Samplepunkte zu $x$ Längs $\Sigma$ ist [Empty Segment Lemma]}} \geq \frac{1}{2} \norm{p-p_1} = r \sin \alpha \geq \frac{1}{2} f(x) \sin \alpha$


=> $2 \epsilon \geq \sin \alpha \geq \sin(\frac{\pi}{4} - \arcsin \frac{\epsilon}{1-\epsilon})$

=> Widerspruch für $\epsilon < 0,2$, d.\,h. Ungleichung kann nicht gelten für kleine $\epsilon$.

\end{beob}

\end{proof}

\section{Flächenrekonstruktion}

\begin{thrm}[Edelsbrunner \& Shah, Amenta \& Bern]
Sei $P$ ein $\epsilon$-Sampling einer glatten Fläche $\Sigma$ mit $\epsilon <0,18$, dann sind $\Sigma$ und $D(P,\Sigma)$ homeomorph.

Glatte Fläche: $\phi$ und $\phi^{-1}$ mit $\phi(B) \rightarrow B$ unendlich oft stetig differenzierbar.
Wollen glatte Flächen hier, da $\inf_{x \in \Sigma} f(x) > 0$, d.\,h. $\Sigma$ hat positiven Abstand von $M(\Sigma)$.

\begin{defini}[Homeomorphismus]
Bijektive Abbildung zwischen zwei Flächen, die in beide Richtungen stetig ist
\end{defini}

\begin{figure}
\centering
 \includegraphics[width = 0.5\textwidth]{grafiken/homeomorpheobjekte}
\caption{Beispiele für homeomorphe Abbildungen} 
\end{figure} 

\begin{defini}[Eingeschränkte Delaunay-Triangulierung]
$P \subset \R^3$ endliche Punktemenge, $\Sigma \subset \R^3$.
\end{defini}

Erinnerung: $S < P $, $\operatorname{conv}(s)$ ist Simplex in $D(P)$, genau dann wenn $\bigcap_{p \in S} V_p \neq \emptyset$, wobei $V_p$ Voronoizelle von $p$.

Sei $S < P$,  $\operatorname{conv}(s)$ ist Simplex in $D(P, \Sigma)$, genau dann wenn  $\bigcap_{p \in S} V_p \cap \Sigma \neq \emptyset$

\end{thrm}


Nochmal Crustalgorithmus für Kurven:

Rot: Vereinigung der Voronoi-Zellen der Voronoi-Vertices des Voronoi-Diagramms von $P$ im Voronoi-Diagramm von $P\cup V$

Blau: Komplement von Rot im $\R^2$, aufgedickte Version der Kurve $\Sigma$.

Der Crust-Algorithmus berechnet D(P,Blau).

Idee: Gesampletes Objekt $\Sigma$ (Kurve im $\R^2$, bzw. Fläche im $\R^3$) ist nicht direkt bekannt, sondern nur über das $\epsilon$-Samplung $P$. d.\,h. wir können $D(P,\Sigma)$ nicht direkt berechnen, was wir nach Edelsbrunner, Shah, Amenta, Bern-Theorem gerne würden.

Stattdessen: Schätze \enquote{aufgedickte Version} $\Sigma_D$ von $\Sigma$ aus $P$ und berechne $D(P,\Sigma_D)$.
 
\begin{figure}
\centering
 \includegraphics[width = 0.5\textwidth]{grafiken/aufdickung}
\caption{\enquote{Aufdickung} einer Kurve} 
\end{figure} 

 
 Kleine Vorrausschau:
\begin{figure}
\centering
 \includegraphics[width = 0.5\textwidth]{grafiken/cocones-uebersicht}
\caption{\enquote{Aufdickung} mittels Kegelkomponenten} 
\end{figure} 

Aufdickung mittels Kegelkomplementen (Co-Cones) an den Sample-Punkten.
 
  
 Normalen Approximation
 \begin{lemma}
 Seien $m_1$ und $m_2$ Mittelpunkte der beiden medialen Bälle Tangential an die Fläche $\Sigma$ im Punkt $p$. Dann sind $m_1$ und $m_2$ in $V_p$ enthalten.
 \end{lemma} 
 \begin{proof}
  Sei $B_i$ der medialer Achsenball mit Mittelpunkt $m_i$ dann ist $B_i \cap \Sigma = \emptyset$ und $p$ ist ein nächster Punkt zu $m_i$ in $\Sigma$.
  => $m_i \in V_p$ für Sampling von $\Sigma$.
 
\begin{figure}
\centering
\includegraphics[width = 0.5\textwidth]{grafiken/sigmaundbaelle}
\caption{Mediale Bälle tangential an der Fläche $\Sigma$} 
\end{figure} 

\end{proof}
  
  
  \begin{lemma}
  Sei $\mu > 0$, sei $v \in V_p$ mit $\norm{v-p} \geq \mu f(p)$ für $p \in P$, wobei $P$ ein $\epsilon$-Sampling von $\Sigma$ mit $\epsilon < 1$ ist dann gilt $\measuredangle (m_p, \overrightarrow{v_p}) \leq \arcsin \frac{\epsilon}{\mu(1-\epsilon)} + \arcsin \frac{\epsilon}{1-\epsilon}$.  
  \end{lemma}
  \begin{proof}
Idee:
Beobachtung: $n_p$ zeigt in gleiche (bzw. entgegengesetzte) Richtung wie $\overrightarrow{pm_1}$ bzw. $\overrightarrow{pm_2}$

Sei \obda $v$ auf gleicher Seite von $\Sigma$ wie $m_1$. Wir sind interessiert an
\[
\measuredangle m_1pv = \underbrace{\measuredangle pvm_2 + \measuredangle vm_2p}_{\pi - \measuredangle m_2pv}
\]
d.\,h. es reicht $\measuredangle pvm_2$ und $\measuredangle vm_2p$ abzuschätzen.
  \end{proof}
  
  
  \begin{figure}
\centering
 \includegraphics[width = 0.5\textwidth]{grafiken/crust3d-suchbereich}
\caption{Suchbereich das Crust-Algorithmus in 3D} 
\end{figure} 

\begin{lemma}[Normalenlemma]
Sei $\mu > 0$ und $v \notin \Sigma$ ein Punkt aus der Voronoizelle $V_p$ von $p$ mit $\norm{v-p} \geq \mu f(p)$. Für $\epsilon < 1$ gilt: $\measuredangle(\overrightarrow{vp}, n_p) \leq \arcsin \frac{\epsilon}{\mu(1-\epsilon} + \arcsin \frac{\epsilon}{1-\epsilon}$
% Der Winkel zwischen normalenvektor und einen Punkt aus Voronoi-Zelle ist immer relativ klein. Desto größer \mu gewählt wird, desto kleiner (?) wird der Winkel
\end{lemma}

\begin{proof}
$m_1$ - Mittelpunkt von medialen Ball an $p$.
$m_2$ - Mittelpunkt von medialen Ball an $p$.

 
$n_p || m_1p$
 $n_p || m_2p$  => $m_1, m_2$ und $p$ sind colinear.
 
 $\alpha = \measuredangle (\overrightarrow{vp}, n_p) = \measuredangle(pvm_2) + \measuredangle(v,m_2,p)$ laut Nebenwinkelsatz.
 
 Sei $y$ der Schnitt von $vm_2$ mit $\Sigma$. $y$ liegt in $V_p$ Voronoizelle von $p$. (Weil alles konvex ist und die Endpunkte in $V_p$ liegen.)
 => der nächste Samplingpunkt zu $y$ ist $p$. (Weil er ja in der Voronoizelle liegt)
 $\norm{y-p} \leq \epsilon f(y)$, weil $\epsilon$-Sampling 
 $\leq \frac{\epsilon f(p)}{1 - \epsilon}$ lt. Feature Verschiebungslemma
 
 $\measuredangle pvm_2 = \arcsin \frac{\norm{x-p}}{\norm{v-p}}$
 $\leq \arcsin \frac{\frac{\epsilon}{1-\epsilon} f(p)}{\mu f(p)}$
 $\leq \arcsin \frac{\epsilon}{\mu(1-\epsilon)} $
 
 $\measuredangle vm_2p \leq \arcsin \frac{\norm{x-p}}{\norm{p-m_2}}$
 $\leq \arcsin \frac{\frac{\epsilon}{1-\epsilon} f(p)}{ f(p)}$
 $\leq \arcsin \frac{\epsilon}{1-\epsilon}$


Addieren der beiden Winkel ergibt genau das gewünschte Ergebnis.
 \end{proof}
 
 
\begin{defini}[Pol]
Den am weitesten von $p$ entfernten Voronoiknoten $p^+$ in $V_p$ nennt man positiver Pol.
Der negative Pol $p^- \in V_p$ von $p$ ist der am weitesten von $p^+$ entfernte Punkt, so dass die Vektoren $pp^+$ und $pp^-$ einen Winkel von mehr als $\pi$ bilden.
Man nennt $\overrightarrow{vp} = p^+ - p^-$ den Pol-Vektor von $p$.
Falls $V_p$ unbeschränkt ist, so ist $p^+$ der Punkt im unendlichen und die Richtung von $\overrightarrow{vp}$ ist der Durchschnitt aller Richtungen der unbeschränkten Voronoi-Kanten.
\end{defini}

\begin{lemma}
Für $\epsilon < 1$ gilt für den Normalenvektor $n_p$ und dem Pol-Vektor $\overrightarrow{vp}$

$\measuredangle(n_p, \overrightarrow{v_p}) \leq 2\arcsin \frac{\epsilon}{1-\epsilon}$
\end{lemma}

\begin{defini}[Co-Kegel/Cocone]
Die Menge $C_p \coloneqq \{y \in V_p | \measuredangle (\overrightarrow{py}, v_p) \geq \frac{3}{8} \pi\}$ heißt Co-Kegel (Cocone) von $p$.

$\approx V_p \setminus K$
\end{defini}






\subsection{(Konforme) Alpha Shapes}

Erinnerung: Gegeben $P \subset \R^d$ endlich und $A \subset \R^d$ beliebig. Sei $V_p$ die Voronoi-Zelle von $p \in P$, dann ist $V_p^a = V_p \cap A$.
Sei $T \subseteq P$ dann ist $conv(T)$ ein Simplex der Delaunay-Triangulierung eingeschränkt auf $A$, genau dann wenn 

\[
\bigcap_{p \in T} V_p^A \neq \emptyset (\leftrightarrow (\bigcap_{p \in T} V_p)\cap A \neq \emptyset)
\]

\begin{bsp}
$A = \Sigma$ (Glatte Kurve bzw. Fläche). Dann ist die Delaunay-Triangulierung von einem dichten Sampling $P$ von $\Sigma$ eingeschränkt auf $A$ eine homogene Rekonstruktion von $\Sigma$.
\end{bsp}

\begin{defini}[Alpha Shape] 
Parameter $\alpha \in [0,\infty)$ gegeben $P \in \R^d$ endlich. Das Alpha Shape zum Wert $\alpha$ ist die Delaunay-Triangulierung von $P$ eingeschränkt auf die Menge von Bällen mit Radius $\alpha$ und Mittelpunkt in $P$.
\end{defini}

Konvention: Alle Delaunay-Vertices sind $\alpha$-spät und alle Delaunay-$d$-Simplices sind $\alpha$-früh

\begin{defini}
[Kritischer Delaunay-Simplex] $\sigma$ wird kritisch genannt, falls $\sigma$ sowohl $\alpha$-früh als auch $\alpha$-spät ist.
\end{defini}

\begin{beob}
kritische Simplices im Alpha-Shape sind entweder Zerstörer oder Erzeuger, d.\,h. entweder zerstören sie eine Zusammenhangskomponente oder ein "Loch". (Im $\R^2$ ist das eine Zusammenhangskomponente im Komplement der $\alpha$-Bälle)
\end{beob}

Filtrierung der Delaunay-Triangulierung
$K_0 \subset K_1 \subset \ldots \subset K_n$ ("$\subset$" heißt, alle Simplices in $K_i$ sind auch in $K_{i+1}$ enthalten)

Folge von Sub-Komplexen der Delaunay mit $K_0 = P$ und $K_n =$ Delaunay-Triangulierung von $P$.
d.\,h. Alpha-Shapes sind eine Filtrierung der Delaunay-Triangulierung von $P$.


\subsubsection{Alpha-Shapes für Kurven-(bzw. Flächen-)Rekonstruktion}

[Bild eines uniformen Samplings]

In Alpha-Shape Filtrierung viel Aktivität bei kleinen $\alpha$-Werten, dann ein $\alpha$-Intervall ohne Aktivität  dann wieder Aktivität durch einfügen von nicht-Rekonstruktionskanten.

Achtung: Funktioniert nicht bei Feature-Adaptiven $\epsilon$-Sampling. Man erhält im kleineren Teil bereits nicht-Rekonstruktionskanten, während im großen Teil noch nicht alle Rekonstruktionskanten im Alpha Shape sind.

In der Praxis: Flächenrekonstruktion mit Alpha Shapes ist nicht sehr stabil, da in der Regel keine uniformes Sampling vorhanden.



Konforme Alpha Shapes: Anpassung von Alpha Shapes geeignet für Flächenrekonstruktion von $\epsilon$-Sampling.

$\sigma$ Simplex in Delaunay-Triangulierung $\alpha(\sigma)$ ist $\alpha$-Wert bei dem $\sigma$ im Alpha Shape erscheint.

Sei $p \in P$ und $\sigma_1,\ldots,\sigma_k$ seien alle Delaunay-Simplices inzident zu $p$, geordnet so dass $\alpha(\sigma_i) \leq \alpha(\sigma_{i+1})$

Seien $\alpha_p^+ > \alpha_p^-$ Werte aus $\alpha(\sigma_1),\ldots,\alpha(\sigma_k)$

\[
\hat \sigma_p^i = \frac{\alpha(\sigma_i) - \alpha_p^-}{\alpha_p^+}
\]

Konforme Alpha Shapes sind Einschränkungen der Delaunay-Triangulierung von $P$ auf folgende Menge das topologische Innere von $\bigcup_{p \in P} C_p^{\hat \alpha}$

mit $C_p^{\hat \alpha}$ für $\hat \alpha \in [0, \infty)$ ist der Schnitt des Balles mit Mittelpunk $p$ und Radius $\alpha_p (\hat \alpha) = \alpha_p^+ \hat \alpha + \alpha_p^-$
und $V_p$ d.\,h. $C_p^{\hat \alpha} = V_p \cap B(p,\alpha_p^+ \hat \alpha + \alpha_p^-)$

Sei $\hat \alpha(\sigma)$ für Delaunay Simplex $\sigma$ der Wert von $\hat \alpha$ bei dem $\sigma$ im konformen Alpha Shape erscheint.

\begin{beob}
$\hat \alpha(\sigma) = \max_{i = 1,\ldots,k} \inf\{\hat \alpha | \alpha_{p_i}(\hat \alpha) \geq \alpha(\sigma)\}$ wobei $\sigma = conv(p_1,\ldots,p_k), p_i \in P$

[Bild]

Das Bild zeigt: Im konformen Alpha Shape können Dinge kritisch werden, die im normmalen Alpha Shape nicht kritisch waren.
\end{beob}

%-- 9.Januar

\subsubsection{Konforme Alpha Shapes}

$p \in P$, $\sigma_1, \ldots, \sigma_k$ Delaunay Simplices inzident zu $p$ in Delaunay Triangulierung von $P$. Sei $\alpha(\sigma_i)$ der Alphawert für den $\sigma_i$ im Alpha Shape von $P$ auftaucht. Annahme $\alpha(\sigma_i) \leq \alpha(\sigma_{i+1})$

Lokales Wachstum des Balles im Zentrum $p$:
Seien $\alpha_p^+ > \alpha_p^- \in \{\alpha(\sigma_i)\}$

$\alpha_p(\hat \alpha) = \alpha_p^+$ (Radius des Balles mit Zentrum $p$ als Funktion des Parameters $\hat \alpha \in [0,\infty)) + \alpha_p^-$


Konforme Alpha Shapes: Einschränkung der Delaunay Triangulierung von P auf das topologische Innere (Menge ohne Rand) von $\bigcup_{p \in P} C_p^{\hat \alpha} = C^{\hat \alpha}$

\[
C_p^{\hat \alpha} = V_p \cap B(p,\alpha_p(\hat \alpha))
\]

\begin{beha}
Konforme Alpha Shapes (für wachsendes $\hat \alpha$) sind Filtrierung des Delaunay Triangulierung von $P$.
\end{beha}

\begin{proof}

zu zeigen 
\begin{enumerate}
\item[(1)] Für hinreichend große $\hat \alpha$ ist das konforme Alpha Shape die Delaunay Triangulierung von $P$.
\item[(2)] Für $\hat \alpha_1 < \hat \alpha_2$ gilt: die Simplices im konformen Alpha Shape zu $\hat \alpha_1$ sind auch Simplices des konformen Alpha Shapes zu $\hat \alpha_2$
\item[(3)] ein Simplex im konformen Alpha Shape erscheint nicht später als seine Co-Faces
\end{enumerate}

\begin{enumerate}
\item[zu (1)] Folgt daraus, dass $C^{\hat \alpha}$ "im Limes" $\hat \alpha$ gegen unendlich den ganzen Raum überdeckt.
\item[zu (2)] Folgt aus $C^{\hat \alpha_1} \subset C^{\hat \alpha_2}$
\item[zu (3)] Beobachtung: $\hat \alpha(\sigma)$ (Wert, bei dem $\sigma$ im konformen Alpha Shape auftaucht.) $= max_{p_1,\ldots,p_k} inf\{\hat \alpha | \alpha_{p_i}(\hat \alpha) \geq \alpha(\sigma)  \}$
wobei $p_1,\ldots,p_k$ die Vertices des Simplex $\sigma$ sind.
\end{enumerate}


Zu zeigen: $\sigma$ taucht nicht später auf, als alle seine Co-Faces. Es gibt Vertex $p_i$ von $\sigma$ mit 
\[
\alpha_{p_i}(\hat \alpha(\sigma)) = \alpha(\sigma) \leq \alpha(\tau) \leq \alpha_{p_i}(\hat \alpha(\tau))
\]
hierbei $\tau$ Co-Face von $\sigma$. Nach Konstruktion ist $\alpha_{p_i}$ eine monoton wachsende Funktion.
=> $\hat \alpha(\sigma) \leq \hat \alpha(\tau)$, was zu zeigen war.

\end{proof}


Ziel: Zeige, dass konforme Alpha Shapes besser geeignet sind für Flächenrekonstruktion als Alpha Shapes.
Dazu unterschiede von Konformen- und Alpha-Shapes.

\begin{satz}
Alle $\alpha$-kritischen Delaunay-Simplices sind auch $\hat \alpha$-kritisch. (Achtung: Die Umkehrung gilt nicht.)
\end{satz}

\begin{proof}
Sei $\sigma$ ein $\alpha$-kritischer Simplex mit Vertices $p_1, \ldots, p_k$, d.\,h. $\sigma$ ist $\alpha$-spät (erscheint also später als alle seine Faces im Alpha Shape) und $\alpha$-früh (d.\,h. erscheint vor all seinen Co-Faces im Alpha Shape). Zu zeigen: $\alpha$ ist $\hat \alpha$-spät und $\hat \alpha$-früh.

(1) $\hat \alpha$-spät: Reicht Behauptung für alle $(k-2)$-Faces zu zeigen. Sei $\rho_i$ $(k+2)$-Face, das durch weglassen von $p_i$ entsteht.
\[
 \hat \alpha(\rho_i) = \max_{p_j, j\neq i} inf\{\hat \alpha |\alpha_{p_j}(\hat \alpha) \geq \alpha(\rho_i) \}
<  \hat \alpha(\rho_i) = \max_{p_j, j\neq i} inf\{\hat \alpha |\alpha_{p_j}(\hat \alpha) \geq \alpha(\sigma) \} \text{(Weil $\alpha(\sigma) > \alpha(\rho_i)$, da $\sigma \alpha$-spät ist.)}
\leq max_{p_j \in \{p_1,\ldots,p_k\}} inf \{\hat \alpha | \alpha_{p_j}(\hat \alpha) \geq \alpha(\sigma)\} = \hat \alpha(\sigma) \text{=> $\sigma$ ist $\hat \alpha$-spät}
\]


(2) $\alpha$-früh. Reicht zu zeigen für $k$-Dimensionale Co-Faces von $\sigma$. Sei $\tau$ so ein Co-Face mit zusätzlichem Vertex $p$.
\[
\hat \alpha(\sigma) = max_{p_j \in \{p_1,\ldots,p_k\}} inf \{\hat \alpha | \alpha_{p_j}(\hat \alpha) \geq \alpha(\sigma)\}
< \hat \alpha(\sigma) = max_{p_j \in \{p_1,\ldots,p_k\}} inf \{\hat \alpha | \alpha_{p_j}(\hat \alpha) \geq \alpha(\tau)\} (Weil \alpha(\sigma) < \alpha(\tau))\text{, da $\sigma \alpha$-früh ist.}
\leq < \hat \alpha(\sigma) = max_{p_j \in \{p_1,\ldots,p_{k+1}\}} inf \{\hat \alpha | \alpha_{p_j}(\hat \alpha) \geq \alpha(\tau)\} = \hat \alpha (\tau) \text{=> $\sigma$ ist $\hat \alpha$-früh.}
\]
(1) und (2) => $\sigma$ ist $\hat \alpha$-kritisch, was zu zeigen war.
\end{proof}



Konforme Alpha Shapes für Flächenrekonstruktion:
[Bild] 

Idee: Skaliere das Ballwachstum, so dass erscheinen von Simplices inzident zu Sample Punkt $P$ nur von der Form von $V_p$ abhängt, aber nicht von der Skalierung.

Dazu: 
$\alpha_p^- = \alpha_{p_1} = 0$ (nämlich $p$ selbst zum Zeitpunkt $\alpha = 0$ im Alpha Shape auf)
$\alpha_p^+ = \norm{p - p^*}, p^*$ zweiter Pol von $p$

(1) Voronoi Zelle beschränkt, dann $Pol(p)$ Voronoi-Vertex in $V_p$, der größten Abstand zu $p$ hat.
[Bild]
$Pol(p)$ - $p$ Pol-Vektor

(2) Falls $V_p$ unbeschränkt ist, dann ist der Pol-Vektor die \enquote{durchschnittliche Richtung} aller Voronoi-Kanten.
[Bild]

Zweiter Pol (auch negativer Pol genannt) von $p$ ist der am weitesten entfernte Vertex $q$ von $p$ in $V_p$, im Halbraum mit beschränkender Hyperebene mit normale der Pol-Vektor, d.\,h. $\measuredangle(Pol-Vektor, p-q) \geq \frac{\pi}{2}$


\begin{lemma}
Sei $\Sigma$ eine glatte Fläche, $P$ sei ein $\epsilon$-Sampling von $\Sigma$. Dann ist für $\hat \alpha \geq \eta \coloneqq \frac{\epsilon}{1-\epsilon}$ die Delaunay Triangulierung von $P$  eingeschränkt auf $\Sigma$ (d.\,h. $D_\Sigma(P))$ im konformen Alpha Shape zu 2 enthalten.
\end{lemma}

\begin{proof}
Sei $\alpha_p^i$ der größte $\alpha$-Wert für den ein Simplex $\sigma$ aus $D_\Sigma(P)$ inzident zu $p \in P$ im Alpha Shape erscheint. Dann ist $\alpha_p^i \leq \eta f(p)$ [$\epsilon$-Sampling Bedingung und Feature Translation Lemma]

$\alpha_p^+ \geq f(p)$ [Da Voronoizelle $V_p$ Mittelpunkt der medialen Achsenbälle Tangential an $\Sigma$ in $p$ enthält]

=> $\hat \alpha_p^C = \frac{\alpha_p^i}{\alpha_p^+} \leq \frac{\eta f(p)}{f(p)} \leq \eta$
\end{proof}


Vorlesung vom 13.1.09 fehlt..

\chapter{Topologie (Homologie)}

\begin{defini}
[Topologischer Raum] Menge X, $\sigma \subseteq P(X)$ (Menge aller Teilmengen)
\begin{enumerate}
\item $\emptyset, X \in \sigma$
\item Beliebige Vereinigung von Mengen aus $\sigma_j$ sind wieder in $\sigma$
\item endliche Schnitte von Mengen sind wieder in $\sigma$
\end{enumerate}
\end{defini}

\begin{defini}
[Stetige Abbildung] Seien $X,Y$ topologische Räume. $X \mapsto Y$ heißt stetig, falls das Urbild einer offenen Menge immer offen ist.
\end{defini}

\begin{defini}
[Homeomorphismus] $f\colon X \mapsto Y$ heißt homeomorphismus, falls $f$ bijektiv ist und sowohl $f$ als auch $f^{-1}$ stetig sind.
\end{defini}

\begin{defini}[Homeomorph]
$X,Y$ heißen homeomorph, falls es homeomorphismus $f\colon X \mapsto Y$ gibt.  [$X$ und $Y$ sind im topologischen Sinne gleich]
\end{defini}

Testen auf homeomorphie ist schwierig. [Nicht im Sinne von Berechenbarkeitstheorie, aber im technischen Sinn, d.\,h. es gibt wenige Werkzeuge.]


Klasifizieren von Flächen (geschlossene Flächen)
\begin{enumerate}
\item orientierbare Flächen (normale: Kugel, Donut, zusammengeklebte Donuts)
\item nicht-orientierbaree Flächen (Kugel mit rundem Ausschnitt, in Ausschnitt ist Möbiusband geklebt (Hat Kreis als Rand))
\end{enumerate}

Zylinder -> Fläche mit Rand, keine Manigfaltigkeit mehr.

\begin{defini}
[Homotopyäquivalenz] Seien $X,Y$ topologische Räume. Zwei stetige Abbildungen $f,g\colon X \mapsto Y$ heißen homotop zueinander, falls es eine stetige Abbildung
\[H\colon X \times [0,1] \mapsto Y\] gibt, so dass $H(x,0) = f(x)$ und $H(x,1) = g(x) \forall x \in X$.
\end{defini}

\begin{defini}[Homotopyäquivalent]
$X,Y$ sind homotopyäquivalent, falls es stetige Abbildungen $f\colon
X\mapsto Y$ und $g\colon X\mapsto Y$ gibt, so dass $g \circ f$ homotop ist zu $ID_x$ und $f \circ g$ homotop ist zu $ID_y$.
$ID_x\colon X \mapsto X$ identische Abbildung $x \mapsto x$.
\end{defini}

\begin{defini}
[Deformationsretrakt] Sei $X$ ein topologischer Raum und $Y \subset X$ Unterraum. Ein Deformationsretrakt ist eine stetige Abbildung $F:X \times [0,1] \mapsto X$ mit

\begin{enumerate}
\item $F(x,0) = x \forall x \in X$
\item $F(x,1) \in Y \forall x \in X$
\item $F(y,t) = y \forall y \in Y, \forall t \in [0,1]$
\end{enumerate}
\end{defini}

\begin{bsp}
Bild: Kreisscheibe, viele Pfeile gehen von Kreisscheibe richtung Mittelpunkt. Länge der Pfeile etwa halber Radius.

Kreisscheibe ist homotopyäquivalent zu einem Punkt.

Bild: Zwei zusammengeklebte Donuts, mediale Achse, Pfeile vom rand richtung mediale Achse.

Jede offene Teilmenge des $R^d$ ist homeotopyäquivalent zu seiner medialen Achse.
\end{bsp}


Hier nur topologische Räume, die Teilmengen des $R^d$ sind. $\sigma$ für $R^d$ besteht aus allen Teilmengen $X \subseteq R^d$, so dass für jedes $x \in X$ gibt es $\epsilon_x > 0$, so dass $B(x,\epsilon_xj) \subseteq X$

Topologie für $\Sigma \subset R^d$: $\sigma_\Sigma = \{\Sigma \cap O | O \in \sigma\}$

\begin{defini}
[Homotopie invariante] Eine Invariante ordnet topologischen Räumen algebraische Objekte zu (z.\,B. Gruppen, Körper oder Zahlen), so dass wenn für zwei topologische Räume $X,Y$ gilt $i(X) \neq i(Y)$, dann sind $X$ und $Y$ nicht homotopieäquivalent. 
\end{defini}





%Vorlesung vom 21.1.09:

\section{Homologietheorie}

Invarianten für topologische Räume $X \subseteq \R^d$ ($X$ erbt die Topologie von $\R^d$)

Berechnungen für allgemeines $X$ schwierig, deshalb Einschränkung auf spezielle Teilmengen: simpliziale Komplexe.
\begin{defini}
[$k$-Simplex] Die konvexe Hülle von $k+1$ affin unabhängigen Punkten im $\R^d$ heißt $k$-Simplex.
\end{defini}

Seien $p_1,\dots,p_{k+1}$ affin unabhängig. $\sigma(p_1,\dots,p_{k+1})$ ist der zugehörige $k$-Simplex und für jede Teilmenge $P \subset \{p_1,\dots,p_k\}$ ist $\tau = \sigma(P)$ ein Face von $\sigma = \sigma(p_1,\dots,p_{k+1})$.

\begin{defini}[Simplizialer Komplex]
Ein simplizaler Komplex $K$ ist Menge von Simplices mit:
\begin{enumerate}
\item $\sigma \in K$ => jedes Face von $\sigma$ ist in $K$
\item $\sigma, \tau \in K$ => $\sigma \cap \tau = \emptyset$ oder $\sigma \cap \tau$ ist gemeinsames Face von $\sigma$ und $\tau$
\end{enumerate}
\end{defini}


Ziel: konstruiere abelsche Gruppen aus den Mengen der k-Simplices, $k=0,1,2,3,\dots$

\begin{defini}
[Abelsche Gruppe] $(G,+)$ mit Menge G und Abbildung $+: G\times G \rightarrow G$, so dass:
1. $\forall a \in G: \exists -a \in G$ mit $a + (-a) = 0$ [Existenz eines Inversen]
2. Kommutativ $\forall a,b \in G$ gilt: $a+b = b+a$
\end{defini}

\begin{defini}
[Untergruppe] $H \subseteq G$ ist Untergruppe von $G$, falls $H$ selbst eine Gruppe ist, wenn wir $+$ einschränken auf $H$. Insbesondere $0 \in H$.
\end{defini}

\begin{defini}
[Ko-Menge] Sei H Untergruppe von G und $a \in G$, dann ist die Menge $a + H$ eine Ko-Menge.
\end{defini}

\begin{beob}
Es gibt immer eine Bijektion von H auf eine Ko-Menge, da $b \neq c \in H$ impliziert $a+b = a+c$.
\end{beob}

\begin{defini}
[Quotient] Sei $G$ abelsche Gruppe und $H$ Untergruppe, dann ist der Quotient $G|H$ die Menge aller Ko-Mengen.
\end{defini}

\begin{beob}
\begin{enumerate}
\item  Für $a,b \in G$ gilt entweder
\begin{enumerate}
\item $a + H = b + H$, oder
\item $(a + H) \cap (b+H) = \emptyset$
\end{enumerate}

\item Der Quotient G|H ist selbst wieder eine abelsche Gruppe mit der Addition
\[(a+H)+(b+H) = a+b+H\]

Beachte: Addition hängt nicht von Repräsentation der Ko-Menge ab. 

$z \in a + H$  => $\exists h_a \in H$ mit $z = a + h_a$
$z + H = a + h_a + H = a + H$

\item Falls G eine endliche Gruppe ist, d.\,h. G hat nur endlich viele Elemente, dann $\norm{G|H} = \norm{G}|\norm{H}$

\end{enumerate}
\end{beob}

\begin{defini}
[Gruppen Homomorphismus] Seien $G$ und $G'$ eine Abbildung $f \colon G \rightarrow G'$ heißt Gruppenhomomorphismus, falls $F$ mit der Addition kommutiert, d.\,h. $f(a+b) = f(a) + f(b)$
\end{defini}

\begin{defini}
[Kern \& Bild eines Homomorphismus] Sei $f\colon G \rightarrow G'$ Gruppenhomomorphismus, dann ist $Bild(f) \subseteq G' : \{b \in G' | \exists a \in G'\text{ mit }f(a) = b\}$

$Kern(f) \subseteq G : \{a \in G | f(a) = o \in G\}$

$Bild(f)$ ist Untergruppe von $G'$ und $Kern(f)$ ist Untergruppe von $G$.
\end{defini}
%------------------

\begin{defini}[Addition mit simplizialen Komplexen]
Sei $Y$ simplizaler Komplex und $Y_k = \{\sigma \in Y | dim(\sigma) = k\}$ $K$-te Kettengruppe $C_k$. Sei $P(Y_k)$ die Menge aller Teilmengen von $Y_k$. Wir definieren eine Addition auf $C_k$ wie folgt: 
\[a,b \in C_k: a+b \coloneqq (a \cup b)\setminus (a \cap b) \text{ (symmetrische Differenz)}\]
\end{defini}

\begin{bsp}
(Bild von Dreieck mit Ecken a,b,c. Fläche ist schraffiert.)

$Y_1 = \{\{a,b\},\{b,c\},\{a,c\}\}$

$C_1 = \{\emptyset, \{\{a,b\}\},\{\{b,c\}\},\{\{a,c\}\}, \{\{a,b\},\{b,c\}\},  \{\{a,b\},\{a,c\}\}, \{\{b,c\},\{a,c\}\}, \{\{a,b\},\{b,c\},\{a,c\}\} \}$

(Bild: 

\{\{a,b\},\{b,c\}\} + \{\{a,c\}\} = \{\{a,b\},\{b,c\},\{a,c\}\} 

\{\{a,b\},\{b,c\}\} + \{\{a,c\},\{a,b\}\} = \{\{b,c\},\{a,c\}\}

\{\{a,b\},\{b,c\},\{a,c\}\} + \{\{b,c\}\} = \{\{a,b\},\{a,c\}\}
)
\end{bsp}

\begin{defini}
[Randhomomorphismus] $\delta \cdot C_k \rightarrow C_{k+1}$. Sei $\sigma \in Y_k$, dann wird $\sigma$ abgebildet auf seinen Rand, d.\,h.
\[\delta(\sigma) = \{\tau \in Y_{k-1} | \tau\text{ ist ein Face von }\sigma\}\]

$\delta$ ist definiert, als die additive Fortsetzung von $\delta$ von Simplices auf Ketten, d.\,h. sei $a \in C_k, a = \{\sigma_1,\dots,\sigma_n\}$ dann 
$\delta(a) = \delta(\sigma_1) + \delta(\sigma_2)+\dots+\delta(\sigma_n)$
\end{defini}


\begin{defini}[Zyklen \& Ränder]
$C_{k+1} \rightarrow^{\delta_{k+1}} C_k \rightarrow^{\delta_k} C_{k-1}$

$Z_k = \{a \in C_k | \delta_k(a) = \emptyset\} \subseteq C_k$

Zyklen in $C_k$ als Kern von $\delta_k$ eine Untergruppe von $C_k$.
\end{defini}


\begin{bsp}
\begin{enumerate}
\item (Bild: Dreieck abc, Inhalt nicht schraffiert)

$Z_1 = \{\emptyset, \{\{a,b\},\{b,c\},\{a,c\}\}\}$

\item (Bild: Dreieck abc, Inhalt schraffiert, und Dreieck def)

$Z_1 = \{\emptyset, \{\{a,b\},\{b,c\},\{a,c\}\}, \{\{d,e\},\{e,f\},\{d,f\},\{\{a,b\},\{b,c\},\{a,c\},\{d,e\},\{e,f\},\{d,f\}\}\}\}$
\end{enumerate}
\end{bsp}


$B_k = \{a \in C_k | \exists b \in C_{k+1}\text{ mit }\delta_{k+1}(b) = a\} \subseteq C_k$

Ränder in $C_k$. Als Bild von $\delta_{k+1}$ eine Untergruppe von $C_k$.

\begin{bsp}
\begin{enumerate}
\item $B_1 = \{\emptyset\}$
\item $B_1 = \{\emptyset, \{\{a,b\},\{b,c\},\{a,c\}\}\}$
\end{enumerate}
\end{bsp}

\begin{lemma}[Fundamentales Lemma der Homologietheorie]
$\delta_k \delta_{k+1}(d) = \emptyset$
\label{}
\end{lemma}
\begin{proof}
Sei $\sigma$ ein $(k+1)$-Simplex. Jedes $(k-1)$-Face im Rand $\delta_{k+1}(\sigma)$ gehört zu genau zwei $k$-Faces von $\sigma$ => $\delta_k \delta_{k+1} (\sigma) = \emptyset$
\end{proof}

Sei $d$ eine $(k+1)$-Kette. $d = \{\sigma_1, \dots, \sigma_n\}$. Dann gilt wegen der Linearität von $\delta_{k+1}$:
\[\delta_k \delta_{k+1}(d) =  \delta_k \sum^n_{i=1} \delta_{k+1}(\sigma_i) =
\sum^n_{i=1}\delta_k \delta_{k+1}(\sigma_i) = \emptyset\]

\begin{folg}
Es gilt immer $B_k \subseteq Z_k \subseteq C_k$, d.\,h. $B_k$ Untergruppe von $Z_k$ und $Z_k$ Untergruppe von $C_k$.
\end{folg}

\begin{defini}[$k$-te Homologiegruppe]
$k$-te Homologiegruppe ist der Quotient. $Z_k | B_k =: H_k$
\end{defini}

%--Vorlesung vom 23.1.09

\section{Simplizale Homologie}

$Y$ simplizaler Komplex

\begin{defini}[Kettengruppe]
Kettengruppen $C_k$: $C_k$ ist die Menge aller Teilmengen der $k$-Simplizes von $Y$. Wird Abelsche Gruppe mit Addition als symmetrische Diffeerenz
\[
a,b \in C_k: a+b \coloneqq (a \cup b)\setminus (a \cap b)
\] (Addition Modulo 2)
\end{defini}

\begin{defini}[Randabbildung]
Randabbildung $\delta_k: C_k \rightarrow C_{k-q}$: Bilde $k$-Simplizes auf ihren $(k-1)$-Dimensionen \dots.
\end{defini}

\begin{defini}[Zyklengruppe]
Zyklengruppen $Z_k$: $\{a \in C_k | \delta_k(a) = 0\}$, d.\,h. $Z_k$ sind die $k$-Ketten, deren Rand leer ist.
\end{defini}

\begin{defini}[Randgruppen]
Randgruppen: $B_k$: $\{a \in C_k | \exists b \in C_{k+1}\text{ mit }\delta_{k+1}(b) = a\}$, d.\,h. $B_k$ sind die $k$-Ketten, die $(k+1)$-Ketten beranden.
\end{defini}

\begin{folg}
Aus fundamentalen Lemma der Homologie ($\delta_k \circ \delta_{k+1} = 0$) folgt: $B_k \subseteq Z_k$
\end{folg}

\begin{defini}[Homologiegruppen]
Homologiegruppen: $H_k = Z_k | B_k$
\end{defini}


Bildliche Darstellung: \todo{bild}

\begin{bsp}
homologie von Dreieck a,b,c:

$C_0 = \{\emptyset, \{a\},\{b\}, \{c\}, \{a,b\}, \{a,c\},\{b,c\}, \{a,b,c\}\}$

$Z_0 = C_0$

$B_0 = \{\emptyset, \{a,c\},\{a,b\},\{b,c\}\}$

$H_0 = Z_0 | B_0 = $ Menge aller Ko-Mengen von $Z_0$ bezüglich $B_0$ 
$ = \{ \{a\} + B_0 = \{\{a\}, \{b\}, \{a,b,c\}, \} \} $
$ =  \{b\} + B_0 = \{a,b,c\} + B_0 $

$ \{ \emptyset + B_0 = \{\emptyset, \{a,b\}, \{b,c\}, \{a,c\} \} \} $
$ = \{a,b\} + B_0 = \{b,c\} + B_0 \}$

$=> \abs{C_0} = \abs{Z_0} = 8$, $\abs{B_0}=4$, $\abs{H_0} = 2$ => $\beta_0 = 1$


$C_1 = \{\emptyset, \{ab\}, \{bc\}, \{ac\}, \{ab,ac\}, \{ab,bc\},\{ac,bc\}, \{ab,bc,ac\}\}$

$Z_1 = \{\emptyset, \{ab,bc,ac\}\}$

$B_1 = \{\emptyset\}$

$H_1 = \{\emptyset + B_1 = \{\emptyset\}, \{ab,bc,ac\} + B_1 = \{\emptyset, \{ab,bc,ac\}\} \}\}$
=> $\abs{H_1} = 2$, $\beta_1 = 1$

$C_2 = \{\emptyset\}$, $Z_2 = \{\emptyset\}$, $B_2 = \{\emptyset\}$ => $H_2 = \{\emptyset\} => \abs{H_2} = 1 => \beta_2 = 0$

Bettizahlen(Dreieck) = (1,1,0)
\end{bsp}

\begin{bsp}

Beispiel 2: V = \{a,b,c\}, E = \{\{ab\}, \{bc\}\}

$C_0 = \{\emptyset, \{a\}, \{b\}, \{c\}, \{a,b\} \{b,c\}, \{a,c\}, \{a,b,c\}\} = Z_0$

$B_0 = \{\emptyset, \{a,b\}, \{b,c\}, \{a,c\}\}$ => $\abs{H_0} = 2$ => $\beta_0 = 1$

Enttäuschend: Die nullte Bettizahl hilft nicht, Dreieck von Segment zu unterscheiden.

$C_1 = \{\emptyset, \{ab\}, \{bc\}, \{ab,bc\}\}$

$Z_1 = \left\{ \emptyset \right\}$

$B_1 = \left\{ \emptyset \right\}$ => $H_1 = \left\{ \emptyset \right\}$ => $\abs{H_1}=1$ => $\beta_1 = 0$

$C_2 = \left\{ \emptyset \right\} = Z_2 = B_2 = H_2$ => $\beta_2 = 0$

Bettizahlen(Segment) = (1,0,0)
\end{bsp}

\begin{bsp}

Beispiel 3: $V = \left\{ a,b,c \right\}, E = \left\{ \left\{ b,c \right\} \right\}$

$C_0 = \left\{ \emptyset, \left\{ a \right\}, \left\{ b \right\}, \left\{ c \right\}, \left\{ a,b \right\}, \left\{ b,c \right\}, \left\{ a,c \right\}, \left\{ a,b,c \right\} \right\} = Z_0$

$B_0 = \left\{ \emptyset, \left\{ b,c \right\} \right\}$ => $\abs{H_0} = 4$ => $\beta_0 = 2$

$C_1 = \left\{ \emptyset, \left\{ bc \right\} \right\}$, $Z_1 = \left\{ \emptyset \right\}$ => $B_1 = \left\{ \emptyset \right\}$ => $H_1 = \left\{ \emptyset \right\}$ => $\abs{H_1} = 1$ => $\beta_1 = 0$

ausserdem: $\beta_2 = 0$

Bettizahl(Punkt + Segment) = (2,0,0)
\end{bsp}


%$\beta_0 = Anzahl der Zusammenhangskomponenten, \beta_1 = Anzahl der Löcher, \beta_2 = Anzahl der Voids (3dimensionale löcher)$

\begin{beob}
$\beta_0$ zählt die Anzahl der Zusammenhangskomponenten des simplizialen Komplexes
\end{beob}

\begin{proof}
Sei $Y$ simplizialer Komplex mit $n$ Kanten und $m$ Zusammenhangskomponenten. Seien $n_1, \dots, n_m$ die Anzahl der Knoten in den einzelnen Zusammenhangskomponenten. $n = n_1 + \dots + n_m$

$Z_0 = C_0 = $ Menge aller Teilmengen der Knotenmenge => $\abs{Z_0} = 2^n$

\begin{beob}
\begin{enumerate}
\item  Alle Teilmengen der Knotenmenge einer Zusammenhangskomponente beranden genau dann, wenn die Teilmenge eine gerade Anzahl von Knoten enthält.
\item genau die Hälfte aller Teilmengen hat gerade Anzahl von Knoten
\end{enumerate}
\end{beob}

\begin{folg}
Anzahl der berandeten Teilmengen ist $(2^{n-1})(2^{n-1})\dots(2^{n_m-1}) = $ $2^{\Sigma^m_{i = 1} n_i - m} = 2^{n-m}$ => $\abs{H_0} = \abs{Z_0 | B_0} = 2^n / 2^{n-m} = 2^mj$ => $\beta_0 = \log_2 \abs{H_0} = m$
\end{folg}
\end{proof}

Formal: $Y$: $d$-Dimensionaler simplizaler Komplex, d.\,h. die Dimension des höchstdimensionalen Simplex in $Y$ ist $d$:

\begin{defini}
[Kettenkomplex] $\{\emptyset\} \rightarrow^{\delta_{d+1}} C_d \rightarrow^{\delta_{d}} C_{d-1} \rightarrow^{\delta_{d-1}} \dots C_0 \rightarrow^{\delta_{0}} \{\emptyset\} $
\end{defini}

\begin{defini}
[Rang einer endlichen Gruppe] Anzahl der Elemente in der Gruppe
\end{defini}

\begin{defini}
[$k$-Betti Zahl] $log_2$ des Rangs der $k$-ten Homologiegruppe.
\end{defini}


Zusammenhang der Eulerzahl und der Bettizahl:
$Y$ $d$-dimensionaler simplizialer Komplex.

$C_k$ die Anzahl der $k$-Simplizes in $Y$

$\chi(Y) = \sum_{k=0}^d (-1)^k C_k$ (Graph in der Ebene: $v-e+f = \chi(G) = 2$)

Seien $z_k$ dei Anzahl der $k$-Zyklen, $b_k$ die Anzahl der $k$-Ränder
Daraus folgt $\abs{H_k} = z_k / b_k$ => $\beta_k = \log_2 z_k - \log_2 b_k$.

Weiterhin $\log_2 \abs{C_k} = \log_2 z_k + \log_2 b_{k-1}$

\begin{bemerk}
$\delta_k: C_k \rightarrow C_{k-1}$, $\dim{C_k} = \dim{Kern(\delta_k)} + \dim{Bild(\delta_k)}$

(aus Linearer Algebra)
\end{bemerk}

=> $\chi(Y) = \Sigma (-1)^k C_k = \Sigma (-1)^k (\log_2 z_k + \log_2 b_{k-1}) = \Sigma (-1j^k (\log_2 z_k - \log_2 b_k)) = \Sigma (-1)^k \beta_k$

Achtung bei den Randfällen: $\log(b_{k-1}) \coloneqq 0$
d.\,h. Eulerzahle ist alternierende Summe der Bettizahlen.

=> Wenn Bettizahl Homotopieinvariante, dann auch Eulerzahl.

%nächste Woche: ausrechnen der Bettiezahlen mit Alpha Shapes\dots.

%--- 28. 01.09

\section{Berechnung von Bettizahlen}

$C_k$, $k$-te Kettengruppe, $\delta_k: C_k \rightarrow C_{k-1}$, $Z_k$ $k$-te Zyklengruppe (Kern der Randabbildung), $B_k$ $k$-te Randgruppe (Bild der Randabbildung), $H_k = Z_k | B_k$ $k$-te Homologiegruppe.

\[
c_k = \log_2 \abs{C_k}, z_k = \log_2 \abs{Z_k}, b_k = \dots, \beta_k = \log_2 \abs{H_k}
\]
=> $c_k = z_k + b_{k-1}$ (Rangsatz aus linearer Algebra)
$\beta_k = z_k - b_k$


%(hier fehlt was)
\begin{enumerate}
\item[(a)] $z_k = z_k +1$
\item[(b)] $b_{k-1} = b_{k-1}+1$
\end{enumerate}

=> (a) für den Rang von $H_k$ (d.\,h. für $\beta_k$): $\beta_k = \beta_{k}+1$

=> (b) für den Rang von $H_{k-1}$ (d.\,h. für $\beta_{k-1}$): $\beta_{k-1} = \beta_{k-1}-1$

Bei Alpha Shapes: (a) erzeugt, (b) zerstört.

Frage: Wie können wir Rang von $C_k$ um eins erhöhen?

Antwort: Durch Filtrierung des simplizialen Komplexes $Y$.


Filtrierung von simplizialen Komplex $Y$

Folge $Y_0, Y_1, \dots, Y_n$ von simplizialen Komplexen mit

\begin{enumerate}
\item $Y_0 = \emptyset, Y_1 = Y, Y_i \subset Y_{i+1}$ (Teilkomplex, d.\,h. alle simplizes aus $Y_i$ sind auch in $Y_{i+1}$)
\item $Y_i$ und $Y_{i+1}$ unterscheiden sich um genau einen Simplex
\end{enumerate}

\begin{bemerk}
Aus der Forderung $Y_i$ simplizialer Komplex folgt, dass ein Face immer vor seinen Co-Faces eingefügt wird. 
\end{bemerk}

\begin{bsp}
Eindimensionaler simplizialer Komplex
Bild: (Dreieck): $\emptyset$, ein Knoten, zwei Knoten, die Kante dazwischen, der dritte Knoten, zweite Kante, dritte Kante

Hinzufügen eines k-Simplex erhöht $c_k$ um eins.

$\beta_0 = 0  , \beta_1 = 0  $

$\beta_0 = 1  , \beta_1 = 0  $

$\beta_0 = 2  , \beta_1 = 0  $

$\beta_0 = 1  , \beta_1 = 0  $

$\beta_0 = 2  , \beta_1 = 0  $

$\beta_0 = 1  , \beta_1 = 0  $

$\beta_0 = 1  , \beta_1 = 1  $
\end{bsp}

Algorithmus: Union-Find

Datenstruktur, die die folgenden 3 Operationen unterstützt:
\begin{itemize}
\item Add(i): Erzeugt eine neue Komponente für Element i.
\item Find(i,j): Gibt \enquote{wahr} zurück, falls $i$ und $j$ zur selben Komponente gehören, sonst \enquote{falsch}
\item Union(i,j): Vereinige die Komponenten, zu der $i$ und $j$ gehören.
\end{itemize}


Algorithmus für eindimensionale Komplexe:
\begin{algorithm}
    \dontprintsemicolon
    \caption{Berechnung der Bettizahlen im 2D}
\KwIn{$\sigma_1, \dots, \sigma_n$ Simplizes von $Y$ in der Einfügereihenfolge gemäß der Filtrierung}

$\beta_0 = 0, \beta_1 = 0$
\For{ $i=1$ To $n$ }{
  \eIf{ $dim(\sigma_i) = 0$} { $\beta_0 = \beta_0 + 1$\; $Add(\sigma_i)$\;}
  { $\left\{ a,b \right\} = $ Endpunkte von $\sigma_i$\;
    \eIf{ $Find(a,b) = True$}{
      $\beta_1 = \beta_1 + 1$\;
    }{
      $\beta_0 = \beta_0 - 1$\; $Union(a,b)$\;
    }
  }
}
\end{algorithm}

Erweiterung auf dreidimensionale Komplexe:

Fallunterscheidung:
  $Dim(\sigma_i)$ 
\begin{enumerate}
\item[$ = 0$:] Immer $\beta_0 = \beta_0 + 1$, erzeugen von Komponente

\item[$= 1$:] entweder $\beta_0 = \beta_0 -1$ (Zwei Komponenten werden verbunden) oder $\beta_1 = \beta_1 + 1$ (ein Loch wird hinzugefügt)

\item[$= 2$:] entweder $\beta_1 = \beta_1 -1$ (nicht berandende Kette wird berandend) oder $\beta_2 = \beta_2 + 1$ (erzeugen von 2-Zyklus)

\item[$= 3$:] $\beta_2 = \beta_2 -1$ zerstören von 2-Zyklus.
\end{enumerate}


Problem: $Dim(\sigma_i)= 2$ Dreieck

Lösungsidee: Gehe rückwärts durch die Filtrierung

Bsp in der Ebene:
Aufbau eines dualen Graphen. 

Entfernen von Dreiecken erzeugt Komponenten, 
entfernen von Kanten 
\begin{enumerate}
\item[(a)] vereinigt Komponenten oder 
\item[(b)] erzeugt einen Zyklus
\end{enumerate}

\begin{enumerate}
\item[(a)] $\beta_1 = \beta_1  + 1$ (Zerstören eines Zyklus im Komplement)
\item[(b)] $\beta_0 = \beta_0 - 1$ (Erzeugt Zusammenhangskomponente im Komplement)
\end{enumerate}

Schwierigkeit: Was ist mit Kanten im Rand das simplizialen Komplexes?

In Vorwärtsbetrachtung hat Kante Zyklus erzeugt, d.\,h. $\beta_1 = \beta_1 + 1$, aber hier vereinigt das entfernen keine Komponenten im dualen Graph.

Lösung: Kompaktifizieren, d.\,h. füge virtuellen Punkt im \enquote{unendlichen} hinzu plus den Kegel auf dem Rand.

Zusätzliche Kanten verbinden Vertices auf dem Rand mit dem Punkt um unendlichen und Dreiecke aus Kanten auf dem Rand plus dem Vertex im unendlichen.

Erweitert Filtrierung um zusätzliche Kanten und Dreiecke.

Änderung: Einfügen des letzten Dreiecks zerstört nicht, sondern erzeugt.


Eine Dimension höher: Kompaktifizieren von 3D simplizialen Komplex mittels Punkt im unendlichen, und rückwärts durchlaufen einer erweiterten Filtrierung erlaubt zu entscheiden, ob ein Dreieck erzeugt oder zerstört.

--Vorlesung fehlt (30. 1.  09)

Paaren von vernichtern und Erzeugern in persistenter Homologie

Filtrierung: $Y_1 = \emptyset, Y_2, \dots, Y_n = Y$ Filtrierung von $Y$, d.\,h. insbesondere $Y_j$ und $Y_{j+1}$ unterscheiden sich in genau einem Simplex $\sigma_{j+1} = Y_{j+1}\ Y_j$

Annahme: Alle $\sigma_j$ gelabeld als Vernichter bzw. Erzeuger

Persistente $i$-te Homologiegruppe: Dazu $i$-dimensionale Erzeuger und $(i+1)$-Dimensionale Vernichter sortiert entlang der Filtrierung.

Paaren von Vernichtern und Erzeugern:
Dazu explizit Aufrechterhalten von Basis der $i$-ten Homologiegruppen $H_i^j$ [$i$-te Homologiegruppe für $j$-ten Komplex]
Explizite: Zyklen, die genau einen Erzeuger enthalten
\begin{beob}
Eine solche Basis existiert immer
\end{beob}
\begin{proof}
Induktion: Erster Zykel (d.\,h. für kleinstes $j$, so dass $H_i^j$ nicht trivial) ist ($=0$) wird vom ersten Erzeuger erzeugt.

Induktionsschritt: Gegeben irgendein Zykel $Z$, der aktuellen Erzeugere enthält. Falls Zykel noch \enquote{ältere} Zykel enthält, dann addiere die zugehörigen Basiszykel zu $Z$. Da Basiszykel genau einen Erzeuger enthält, kann $Z$ durch diese Addition nicht leer werden. Außerdem entfernt jede Addition genau einen Basiszyklus.
\end{proof}


Falls $\sigma_l$ Erzeuger [von einem $i$-Zyklus], dann sei $c_l$ der zugehörige Basiszyklus.


Jetzt Annahme: $\sigma_j$ ist $(i+1)$-dimensionaler Simplex, der vernichtet. => $\delta \sigma_j$ ist ein Zyklus in $Y_{j+1}$. Wir können d ausdrücken als Summe:
\[
\Sigma_{c_l} + B_j
\] mit $c_k$ Basiszyklen.

Diese Summe ist eindeutig [Eindeutige Darstellbarkeit aus Basis]

Sei $c_i$ der jüngste Zyklus in dieser eindeutigen Darstellung und sei $\sigma_i$ der zugehörige Erzeuger, dann Paaren wir $\sigma_i$ und $\sigma_j$, d.\,h. 

Interpretation: Der durch $\sigma_i$ erzeugte Zyklus wird durch $\sigma_j$ zerstört. [eingekastet, erlaubt Berechnung der Lebensdauer der Features.]

Jetzt: Berechnen der Paarung.

Folge von Simplices $\sigma_j = Y_j\ Y_{j-1}$, $j=2, \dots, n$

Array speichert an Stelle $j$ den zugehörigen Vernichter, falls $\sigma_j$ erzeugt und irgendwann vernichtet wird. Andernfalls speichern von $\infty$ falls $\sigma_j$ erzeugt, aber nicht vernichtet wird, bzw. gar nichts, falls $\sigma_j$ vernichtet. Außerdem wird Zeiger auf Liste die Simplices \enquote{älter} als $\sigma_j$ und $\sigma_j$ enthält [falls $\sigma_j$ erzeugt und vernichtet wird.]

Füllen des Arrays: Gehen linear durch das Array. Annahme an Stelle $j$ wird ein $i$-Vernichter eingefügt. Sei $I$ die Indexmenge der $i$-Erzeuger in $\delta\sigma_j$, d.\,h. für alle $i\in I$ gilt $i<j$. Sei $k = \max\left\{ i \in I \right\}$.
Nachschauen im Array an der Stelle $k$ gibt zwei Fälle:
\begin{enumerate}
\item Feld im Array an der Stelle $k$ ist leer
\item Feld ist nicht leer, d.\,h. speichert Index von Vernichter mit Index kleiner als $j$ und Zeiger auf iste mit Indizes kleiner als $k$.
\end{enumerate}

(1) Speichere $j$ an der Stelle $k$ und Zeiger auf $I$.

(2) Update: $I = (I \oplus L_k)$, d.\,h. symmetrische Differenz von $I$ und der Liste $L_k$ auf die im Feld mit Index $k$ verwiesen wird.

Weitermachen am neuen Wert von $k$.


Was ist zu zeigen für diesen Algorithmus:
\begin{enumerate}
\item Algorithmus terminiert
\item Algorithmus ist korrekt
\end{enumerate}

1. Beobachtung: $k$ wird stetig kleiner und $I \neq \emptyset$, da $\delta \sigma_j$ kein Randzyklus in $Y_{j-1}$ ist. Füll Algorithmus terminiert.

Vor dem Korrektheitsbeweis ein Beispiel: 
\begin{bsp}
Filtrierung:
Einfügen in dieser Reihenfolge: $s$, $t$, $u$, $st$, $v$, $w$, $sw$, $tw$, $uv$, $sv$.

\begin{tabular}{lcll}
$s$ &$\rightarrow$& $(+,0)$ &(Erzeuger eines 0-Dimensionalen Zyklus) \\
$t$ &$\rightarrow$&  $(+,0)$ &\\
$u$ &$\rightarrow$&  $(+,0)$ &\\
$st$ &$\rightarrow$&  $(-,0)$ &(Vernichter eines 0-Dimensionalen Zyklus) \\
$v$ &$\rightarrow$&  $(+,0)$ &\\
$w$ &$\rightarrow$&  $(+,0)$ &\\
$sw$ &$\rightarrow$&  $(-,0)$&\\
$tw$ &$\rightarrow$&  $(+,1)$&\\
$vu$ &$\rightarrow$&  $(-,0)$&\\
$sv$ &$\rightarrow$&  $(-,0)$&\\
\end{tabular}

Array:
\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|}
\hline
 1&        2  &3&  4 & 5 & 6 & 7&  8     & 9& 10 \\
\hline
 $\infty$ &  4 &   &  &  9 & 7 &   & $\infty$ &   &   \\   
\hline
\end{tabular}

\begin{tabular}{lll}
$4$ & $\rightarrow$ & $\left\{ 1,2 \right\}$ \\
$7$ & $\rightarrow$ & $\left\{ 1,6 \right\}$ \\
$9$ & $\rightarrow$ & $\left\{ 3,5 \right\}$ \\
\end{tabular}

Bei 10: s in erscheint in 1, v erscheint bei 5. max davon ist 5. 5 ist aber besetzt
\[
10 -> \left\{ 1,3 \right\} = \left\{ 1,5 \right\} \oplus \left\{ 3,5 \right\}
\]
1 und 8 sind die Zusammenhangskomponenten, die überleben.

Zusammenfassende Interpretation:
\begin{enumerate}
\item Die Zusammenhangskomponente, die bei $j=1$ erzeugt wird, wird nicht zerstört.
\item Die Zusammenhangskomponente, die bei $j=2$ erzeugt wird, wird bei $j=4$ zerstört.
\item Die Zusammenhangskomponente, die bei $j=3$ erzeugt wird, wird erst bei 10 zerstört.
\item Die bei 5 erzeugt wird, wird bei 9 zerstört
\item Bei 6 erzeugt, bei 7 zerstört
\item Der bei 8 erzeugt 1-Zyklus wird garnicht zerstört.
\end{enumerate}

\end{bsp}


(2) Der Korrektheitsbeweise

Sei $f$ der Zyklus $\delta \sigma_j$ [$\sigma_j$ sei $i$-Vernichter] und $i$ der \enquote{jüngste} Basiserzeuger in eindeutiger Basisdarstellung von $f$. Sei $k$ der kollisionsfreie Index beim Einfügen von $\sigma_j$

Wir können zeigen: $k=i$
\begin{enumerate}
\item[(a)] 
\item[] %todo: wie macht man das besser?
\begin{beob}
$Y_l$ enthält keinen zu $f$ homologen Zyklus [die homologieklasse von $f$ wird erst zum Zeitpunkt $i$ erzeugt.] $\Rightarrow$ $k\geq i$ 
\end{beob}
\item[(b)] zu zeigen $k \leq i$. 

Annahme: $k>i$. 

Sei $g$ die Homologieklasse, die zum Zeitpunkt $k$ erzeugt wird. $g$ und $f$ müssen homolog sein, d.\,h. $g = f + c$ mit einem Randzyklus $c$. 
Da $\sigma_k$ der jüngste Erzeuger in $g$ ist, ist $\sigma_k$ auf jüngster Erzeugeer in $c$. 
Da Array an Stelle $k$ kollisionsfrei war, kann $\sigma_k$ nicht der Erzeuger sein, der für Rand $c$ vernichtet wurde. 
Daraus folgt: $c$ muss einen \enquote{jüngeren} Erzeuger enthalten. Das ist ein Widerspruch. $ \Rightarrow$ $k=i$
\end{enumerate}


%--Vorlesung vom 6.2.09

\chapter{Meshing} 

Bisher: Kurvenmeshing (Kurvenrekonstruktion) bzw. Flächenmeshing (Flächenrekonstruktion)

Delaunay-Dreiecke innerhalb der rekonstruierten Kurve $\Sigma$ sind nicht unbedingt Dreiecke \enquote{guter} Qualität.

Gute Dreiecke:
\begin{enumerate}
\item Der kleinste Winkel in  jedem Dreieck ist mindestens $\alpha$
\item der größte Winkel ist höchstens $\pi - \beta$
\item Das Verhältnis der Höhe über der längsten Seite zur Längsten Seite,d.\,h. $\frac{\norm{c-x}}{\norm{a-b}}$ ist mindestens $\lambda$  (Wir wollen das die Dreiecke eine gewisse Dicke haben)
\end{enumerate}

Verhältnis von 1,2 und 3:
\begin{enumerate}
\item[$1 \rightarrow 2$:] Falls kleiner Winkel mind. $\alpha$, dann ist der größte Winkel höchstens $\pi - \alpha$
\item[$2 \nrightarrow 1$:] Man kann den kleinsten Winkel immer kleiner machen, ohne das dies Einfluss auf den größten Winkel haben muss
\item[$3 \leftrightarrow 1$:] $\alpha$ kleinster Winkel, $x$ ist Schnittpunkt der Kante mit der Höhe an $c$
\end{enumerate}%berechnung betti zahlen

\begin{enumerate}
\item[a)] $\sin \alpha = \frac{\norm{c-x}}{\norm{a-c}}$
\item[b)] $\norm{a-c} \leq \norm{a-b}$
\item[c)] $\norm{a-c} \geq \norm{b-c}$ => $\norm{a-b} \leq \norm{a-c} + \norm{b-c} \leq 2 \norm{a-c}$
\end{enumerate}
=> $\frac{1}{\sin \alpha} = \frac{\norm{a-c}}{\norm{c-x}} \leq \frac{\norm{a-b}}{\norm{c-x}} \leq \frac{2\norm{a-c}}{\norm{c-x}} = \frac{2}{\sin \alpha}  $

$\frac{\norm{a-b}}{\norm{c-x}} $ ist $1/ aspect ratio$, d.\,h. der Kehrwert des Aspect Ratio beschränkt den kleinsten Winkel von unten, und der kleinste Winkel beschränkt den Kehrwert des Aspekt Ratio von oben. (bzw. den Aspect Ratio von Unten).

$\Rightarrow$ d.\,h. es ist \enquote{egal} ob wir 1 oder 3 sicherstellen.

Idee: Einfügen zusätzlicher Knoten.

Meshing Problem in der Ebene:
\begin{enumerate}
\item Gegeben Polygonale Region mit Randgraph $G$, unter umständen mit geforderten Kanten im Inneren
\item Gesucht ist eine Triangulierung von $G$ (und den inneren Kanten) deren Dreiecke alle einen kleinsten Winkel von mindestens $\alpha$ haben.
\end{enumerate}

Kleine Winkel im Eingabepolygon können nicht entfernt werden.


\begin{algorithm}
    \dontprintsemicolon
    \caption{Ruppert's Meshing Algorithmus}
Berechne kleinstes Achsenparalleles Rechteck, das $G$ enthält.\;
Konstruiere 3x3 Gitter, in dem jede Zelle das Achsenparallele Rechteck aus 1 ist. Platziere $G$ in die mittlere Zelle und füge die 12 Knoten auf dem Rand des Gitters zu $G$ hinzu.\;
Bereche die Delaunay-Triangulierung aller Knoten aus 2\;
\end{algorithm}

Ein Aufdringlicher Knoten  ist ein Knoten der im diametrischen Umkreis einer Kante aus $G$ liegt. 

\begin{bemerk}
Falls Kante aus $G$ keinen aufdringlichen Knoten hat, dann gehört sie zur Delaunay-Triangulierung
\end{bemerk}

Probleme: 
\begin{enumerate}
\item Es kann aufdringliche Knoten in Delaunay-Triangulierung aus 3 geben
\item Die Dreiecke aus der Delaunay-Triangulierung aus 3 haben nicht unbedingt einen kleinsten Winkel $\geq \alpha$ 
\end{enumerate}


Operationen: 
\begin{itemize}
\item[Split 1:] Falls $ab \in G$ und $ab \notin $ Delaunay-Triangulierung aus 3, dann füge den mittelpunkt $m$ des Segments $ab$ zur Knotenmenge hinzu und füge $am$ und $mb$ zu $G$ hinzu. Retriangulieren um die Delaunay-Eigenschaft wieder herzustellen. (Flips um alle Kanten wieder lokal Delauny zu machen)

\item[Split 2:] Falls $abc$ ein Dreieck aus der Delaunay-Triangulierung ist, dessen kleinster Winkel kleiner als $\alpha$ ist, dann füge den Mittelpunkt des Umkreises von $abc$ zur Kontenmenge hinzu und re-trianguliere, um Delaunay-Eigenschaft wieder herzustellen.
\end{itemize}


Algorithmus:
\begin{algorithm}
    \dontprintsemicolon
    \caption{}
\While{true}{
  \While{ $\exists$ aufdringlicher Knoten}{
    Wende Split 1 auf die zugehörige Kante an\;
  }
  \If{ $\nexists$ dünnes Dreieck}{
	exit while loop\;
  }
    abc = dünnes Dreieck\;
    p = mittelpunkt des Umkreises von abc\;
    \If{$p$ aufdringlich für Kanten $e_1, \dots, e_k, k \geq 1$ aus $G$}{
      split 1 operation angewand auf $e_1,\dots,e_k$\;
    }{
      split 2 operationen für o, d.\,h. einfügen von p in Delaunay-Triangulierung.\;
    }
}
\end{algorithm}




\clearpage
\appendix
%\begin{thebibliography}{99}
% \bibitem{mathmode} Math mode von Herbert Voss,\\
% \url{http://www.dante.de/CTAN//info/math/voss/mathmode/Mathmode.pdf}

% \bibitem{shmathguide} Short Math Guide for \LaTeX{},\\
%  \url{ftp://ftp.ams.org/pub/tex/doc/amsmath/short-math-guide.pdf}
%\end{thebibliography}

\clearpage
\pdfbookmark[0]{Index}{index}
%\printindex

Prüfung:
unterschied zu Algorithmik: numerik ist relevant
floating point system

grundlegend: delaunay-triangulierung, voronoi, eingeschränkte diagramme, auf welche mengen, was damit machen 
\end{document}
