\RequirePackage[l2tabu,orthodox]{nag}  % nag überprüft den Text auf veraltete
                   % Befehle oder solche, die man nicht in LaTeX verwenden
                   % soll -- l2tabu-Checker in LaTeX

\RequirePackage[ngerman=ngerman-x-latest]{hyphsubst} % einbinden der neuen
                   % Trennmuster, diese korrigieren einige Fehler der alten
                   % und bieten mehr Trennstellen

\documentclass[utf8,ngerman,hyperref={draft=false,colorlinks,bookmarksnumbered,linkcolor=blue,breaklinks}]{beamer}
\includeonlyframes{orga}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{babel}
\usepackage{hyperref}
\usepackage{wasysym}
\usepackage{svn}         % Zum Auswerten und ordentlichen Darstellen der
                         % SVN-Schlüsselwörter (s. vor \begin{document})
                         % dafür muss in SVN noch das Flag svn:keywords
                         % auf "LastChangedRevision LastChangedDate"
                         % gesetzt werden
\usepackage{ellipsis}    % Korrektur für \dots
\usepackage{fixltx2e}
\usepackage[final,babel]{microtype} % Verbesserung der Typographie
\usepackage{todonotes}   % definiert den Befehl \todo{} um sich leicht
                         % Markierungen für offene Aufgaben zu setzen; wird
                         % auch für \help (s.u.) verwendet
\usepackage{amsmath}
\usepackage[all,warning]{onlyamsmath}  % warnt bei Verwendung von nicht
                                       % amsmath-Umgebungen z.\,B. $$...$$
\usepackage{amssymb}     % wird für \R, \C,... gebraucht
\usepackage{fixmath}     % ISO-konforme griech. Buchstaben
\usepackage{graphicx}
\usepackage{pigpen}
\usepackage{pgfpages}

\mode<presentation>{%
  \usetheme{AnnArbor}
  \usecolortheme{beaver}
}

% \mode<handout>{%
%   \pgfpagesuselayout{2 on 1}[a4paper,border shrink=5mm]
% }

\title{IT-Sicherheit}
\author{Jens Kubieziel}
\date{18.\,Oktober 2010}
\subtitle{Organisatorisches und Beispiel Stuxnet}
\institute[FSU Jena]{Fakultät für Mathematik und Informatik}
\pgfdeclareimage[height=1cm]{logo}{bilder/Uni-Jena-logo}
\logo{\pgfuseimage{logo}}

\begin{document}
\begin{frame}[label=orga]
  \titlepage{}
\end{frame}

% \begin{frame}{Gliederung}
%   \tableofcontents
% \end{frame}

\section{Organisatorisches}

\begin{frame}[label=orga]
  \frametitle{Vorlesung und Übung}
  Die Veranstaltung besteht aus:
  \begin{itemize}
  \item 3 SWS Vorlesung und
  \item 1 SWS Übung
  \end{itemize}

  Die Übungen finden im zweiwöchentlichen Rythmus statt. Erster
  Übungstermin ist Freitag, der 29.\,Oktober~2010. Geplant ist die
  Ausgabe von sieben Übungsserien.
\end{frame}

\begin{frame}[label=orga]
  \frametitle{Vorlesung}
  \begin{itemize}
  \item Hauptinhalte auf Folien
  \item erhältlich im CAJ oder unter \url{http://uni-skripte.lug-jena.de/skripte.html?id=kubieziel-itsich}
  \item ggf. diverse Veröffentlichungen zum Download
  \end{itemize}
\end{frame}

\begin{frame}[label=orga]
  \frametitle{Inhalte der Vorlesung}
  \begin{description}
  \item[Kryptographie] (a)symmetrische Algorithmen, Hashfunktionen, Schlüsselmanagement
  \item[Security Engineering] Struktur-, Bedrohungs und Risikoanalyse,
    Konstruktion sicherer Systeme
  \item[Bewertungskriterien] methodische Betrachtung von
    IT"=Sicherheit, TCSEC, ITSEC, Common Criteria
  \item[Sicherheitsmodelle] Zugriffskontroll- und
    Informationsflussmodelle (Bell"=LaPadula, Brewer"=Nash,
    Graham"=Denning etc.)
  \end{description}
\end{frame}

\begin{frame}[label=orga]
  \frametitle{Nicht enthalten}
  \begin{itemize}
  \item Wie werde ich ein k3wl3r H4x0r
  \item Welche Personal Firewall ist die Beste
  \item etc.
  \end{itemize}
\end{frame}

\begin{frame}[label=orga]
  \frametitle{Übungen}
  \begin{itemize}
  \item Abgabe der Übungen ist fakultativ. \smiley{}
  \item Aber dringend angeraten!
  \item Wichtig ist die Mitarbeit an Übungsterminen.
  \end{itemize}
\end{frame}

\begin{frame}[label=orga]
  \frametitle{Scheinvergabe}
  Es wird zwei Klausuren geben:
  \begin{enumerate}
  \item  Übungsklausur
    \begin{itemize}
    \item einfache Aufgaben
    \item schriftlich zu lösen
    \item Test für eigentliche Klausur
    \item Termin: 11.\,Februar 2011 (voraussichtlich)
    \end{itemize}
  \item Schriftliche Prüfungsklausur
    \begin{itemize}
    \item anspruchsvollere Aufgaben
    \item 50\,\% der Punkte zum Bestehen
    \item Bearbeitung der Vorlesung \emph{und} Übung zum Bestehen notwendig
    \item Termin: 25.\,Februar 2011 (voraussichtlich)
    \end{itemize}
  \end{enumerate}
\end{frame}

\begin{frame}[label=orga]
  \frametitle{Kontaktdaten}
  \begin{itemize}
  \item[E-Mail] \href{mailto:jens@kubieziel.de}{<jens@kubieziel.de>}
  \item[Chat] \url{kubieziel@jabber.ccc.de}
  \end{itemize}
\end{frame}

\begin{frame}[label=orga]
  \frametitle{Fragen?}
  \begin{center}
    Gibt es weitere Fragen?
  \end{center}
\end{frame}

\subsection{Ein Beispiel}

\begin{frame}[label=orga]
  \frametitle{Stuxnet}
  \begin{itemize}
  \item hoch spezialisierter Computerwurm
  \item greift SCADA-Systeme an
  \item nutzt mindestens vier 0day-Lücken
  \end{itemize}
\end{frame}

\begin{frame}[label=orga]
  \frametitle{Stuxnet}
  \framesubtitle{Geschichte}
  \begin{itemize}
  \item 17.\,Juni 2010: VirusBlokAda meldet Trojan-Spy.0485 erstmals
  \item Mitte Juli: Siemens gibt Warnung heraus, andere Varianten
    werden gefunden, Advisorys von MSFT und CERTs
  \item Ende Juli: VB-Viren nutzen die LNK-Lücke
  \item seitdem: weitere Untersuchungen
  \end{itemize}
\end{frame}

\begin{frame}[label=orga]
  \frametitle{Stuxnet}
  \framesubtitle{Verbreitung}
  \begin{enumerate}
  \item LNK-Schwachstelle
  \item Print Spooler
  \item Freigegebene Ordner
  \item \texttt{Win32k.sys}
  \end{enumerate}
\end{frame}

\begin{frame}[label=orga]
  \frametitle{Stuxnet}
  \framesubtitle{LNK-Schwachstelle}
  Eine LNK-Datei ist eine Verknüpfung in Windows. Das Icon der
  Verknüpfung wird aus einer CPL-Datei geladen.

  \includegraphics[width=.5\textwidth]{bilder/lnk-hexdump}
\end{frame}

\begin{frame}[label=orga]
  \frametitle{Stuxnet}
  \framesubtitle{LNK-Schwachstelle}
  Sechs Dateien sind mindestens auf dem USB-Stick enthalten:
  \begin{itemize}
  \item \texttt{Copy of Shortcut to.lnk}
  \item \texttt{Copy of Copy of Shortcut to.lnk}
  \item \texttt{Copy of Copy of Copy of Shortcut to.lnk}
  \item \texttt{Copy of Copy of Copy of Copy of Shortcut to.lnk}
  \item \texttt{~WTR4141.TMP} -- ist in Wirklichkeit eine DLL.
  \item \texttt{~WTR4132.TMP} -- wird von obiger Datei geladen.
  \end{itemize}
\end{frame}

\begin{frame}[label=orga]
  \frametitle{Stuxnet}
  \framesubtitle{Printer Spooler}
  Es werden Druckerfreigaben benutzt, sich als Gast angemeldet und die
  Rechte so erweitert, dass der Angreifer nach \texttt{\%SYSTEM\%}
  schreiben kann.
\end{frame}

\begin{frame}[label=orga]
  \frametitle{Stuxnet}
  \framesubtitle{Freigegebene Ordner}
  \begin{itemize}
  \item Durchsucht Netzwerk nach \texttt{c\$}- und \texttt{admin\$}-Freigaben
  \item installiert Datei \texttt{DEFRAG<num>.TMP}
  \item Plant Aufgabe für folgenden Tag
  \item dem Wurm Conficker sehr ähnlich
  \end{itemize}
\end{frame}

\begin{frame}[label=orga]
  \frametitle{Stuxnet}
  \framesubtitle{Win32k.sys}
  Stuxnet versucht, seine Rechte auf die des \texttt{SYSTEM}-Nutzers
  zu erhöhen. Es lädt speziell präpariertes Tastaturlayout.
\end{frame}

\begin{frame}[label=orga]
  \frametitle{Stuxnet}
  \framesubtitle{Nach dem Befall}
  \begin{itemize}
  \item Hauptmodul hat 21~Funktionen
  \item Module als DLLs
  \item injizieren Code in laufende Prozesse
  \end{itemize}
\end{frame}

\begin{frame}[label=orga]
  \frametitle{Stuxnet}
  \framesubtitle{Funktionen im Hauptmodul}
  \begin{itemize}
  \item[1] Start des RPC-Server
  \item[2] Beobachtung von S7P-Dateien
  \item[4, 18] Bereinigung des Systems
  \item[6] Stuxnet-Version
  \item[9, 10] kompiliert und startet Schadcode
  \item[16] installiert Treiber, speichert Konfiguration, injiziert Code
  \end{itemize}
\end{frame}

\begin{frame}[label=orga]
  \frametitle{Stuxnet}
  \framesubtitle{Kommunikation}
  Der Wurm kommuniziert mit \url{www.mypremierfutbol.com} und
  \url{www.todaysfutbol.com}. URLs haben die Form \url{http://
    www.mypremierfutbol.com/index.php?data=data_to_send}
\end{frame}

\begin{frame}[label=orga]
  \frametitle{Stuxnet}
  \begin{itemize}
  \item etwa 8--10 Entwickler, sechs Monate Entwicklung
  \item "`teure"' Sicherheitslücken
  \item Wer war das Ziel? (Bushehr, Natanz, Satellit, Deepwater Horizon)
  \item "`So etwas bauen große Staaten zusammen, wenn die Alternative
    bei einem Misserfolg wäre, einen Krieg anzufangen."'
    (\href{http://www.faz.net/s/RubCEB3712D41B64C3094E31BDC1446D18E/Doc~E8A0D43832567452FBDEE07AF579E893C~ATpl~Ecommon~Scontent.html}{FAZ:
    Der digitale Erstschlag ist erfolgt})
  \end{itemize}
\end{frame}

\begin{frame}[label=orga]
  \frametitle{Stuxnet}
  \framesubtitle{Quellen}
  \begin{itemize}
  \item
    \href{http://www.eset.com/resources/white-papers/Stuxnet_Under_the_Microscope.pdf}{Stuxnet
      Under the Microscope} (PDF), Analyse von ESET
  \item \href{http://www.langner.com/en/}{Ralph Langner analysiert den
      Virus in mehreren Schritten}
  \item
    \href{http://www.f-secure.com/weblog/archives/00002040.html}{Q\&A
      von F-Secure}
  \item
    \href{http://www.symantec.com/connect/blogs/exploring-stuxnet-s-plc-infection-process}{Exploring
      Stuxnet’s PLC Infection Process}
  \end{itemize}
\end{frame}

\section{Einleitung}

\begin{frame}
  \frametitle{Einleitung}
  Das Kapitel definiert einige Grundbegriffe. Üblicherweise werden
  diese in der Literatur verschieden verwendet. Bei uns gelten die
  folgenden Definitionen.
\end{frame}

\begin{frame}
  \frametitle{IT-System}
  IT bezeichnet \emph{Informations}technik. Information?
  \pause{}
  \begin{definition}
    Informationen werden durch Daten (String, Integer etc.)
    repräsentiert und ergeben sich aus festgelegten
    Interpretationsvorschriften.
  \end{definition}\pause{}
  \begin{definition}
    Ein \emph{IT-System} ist ein technisches System mit der Fähigkeit
    zur Speicherung und Verarbeitung von Daten (und Informationen).
  \end{definition}
  \pause{}

  Beispiele?
\end{frame}

\begin{frame}
  \frametitle{Objekte und Subjekte}
  Informationen sind in Datenobjekten gespeichert. Wir unterscheiden
  \begin{itemize}
  \item aktive Objekte
  \item passive Objekte
  \end{itemize}
  \pause{}
  \begin{alertblock}{}
    Informationen und Objekte sind schützenswerte Güter (engl. assets).
  \end{alertblock}
  \pause{}
  \begin{definition}
    \emph{Subjekte} sind Benutzer eines Systems oder Objekte, die im
    Auftrag eines Benutzers aktiv sind.
  \end{definition}
\end{frame}




\section{Kryptographie}

\begin{frame}
  \frametitle{Kryptographie}
  \begin{definition}
    \emph{Kryptographie} ist die Lehre von den Methoden zur Ver- und
    Entschlüsselung von Nachrichten.
  \end{definition}
  \begin{definition}
    \emph{Kryptoanalyse} ist die Lehre von der Entschlüsselung von
    Nachrichten ohne Zugriff auf den Schlüssel.
  \end{definition}
  \begin{definition}
    \emph{Kryptologie} ist der Oberbegriff der beiden Teilgebiete.
  \end{definition}
\end{frame}

\subsection{Kryptosystem}


\begin{frame}
  \frametitle{Kryptosystem}
  \framesubtitle{Alphabet}
  Seien $\Sigma$ und $\Gamma$ zwei endliche Alphabete und
  $\Sigma^{\ast}, \Gamma^{\ast}$ die Menge aller Worte über $\Sigma$
  bzw. $\Gamma$.
\end{frame}

\begin{frame}
  \frametitle{Kryptosystem}
  \framesubtitle{Klartextraum}
  \begin{definition}
    Eine nichtleere Menge von Nachrichten $\mathcal{M}\subseteq\Sigma^{\ast}$
    wird als \emph{Klartextraum} bezeichnet. Ein Element
    $m\in\mathcal{M}$ heißt \emph{Nachricht}.
  \end{definition}
\end{frame}

\begin{frame}
  \frametitle{Kryptosystem}
  \framesubtitle{Geheimtextraum}
  \begin{definition}
    Eine nichtleere Menge von Chiffretexten
    $\mathcal{C}\subseteq\Gamma^{\ast}$ wird als \emph{Geheimtextraum}
    bezeichnet. 
  \end{definition}
\end{frame}

\begin{frame}
  \frametitle{Kryptosystem}
  \framesubtitle{Schlüsselraum}
  \begin{definition}
    Der \emph{Schlüsselraum} besteht aus nichtleeren Mengen $K_{e}$
    und $K_{d}$ sowie einer bijektiven Abbildung $f\colon
    K_{e}\rightarrow K_{d}$.
  \end{definition}
  Somit gibt es für jeden $k_{e}\in K_{E}$ einen passenden $k_{d}\in
  K_{d}$. Also $f(K_{e})= K_{d}$.
\end{frame}

\begin{frame}
  \frametitle{Kryptosystem}
  \framesubtitle{Verschlüsselungsalgorithmus}
  \begin{definition}
    Eine linkstotale und injektive Abbildung $E\colon\mathcal{M}\times
    \mathcal{K}\rightarrow\mathcal{C}$ wird als
    \emph{Verschlüsselungsalgorithmus} bezeichnet.
  \end{definition}
\end{frame}

\begin{frame}
  \frametitle{Kryptosystem}
  \framesubtitle{Entschlüsselungsalgorithmus}
  \begin{definition}
    Eine Abbildung $D\colon \mathcal{C}\times
    \mathcal{K}\rightarrow\mathcal{M}$ mit der Eigenschaft $\forall
    m\in\mathcal{M}\colon D(E(m,k_{e}), k_{d})=m$ für $k_{e}\in K_{e},
    k_{d}\in K_{d}$ und mit $f(K_{e})= K_{d}$ heißt \emph{Entschlüsselungsalgorithmus}.
  \end{definition}
\end{frame}

\begin{frame}
  \frametitle{Kryptosystem}
  \begin{definition}
  Ein \emph{Kryptosystem}~$\mathcal{S}$ ist ein Fünftupel
  $\mathcal{S}=(\mathcal{M}, \mathcal{C}, \mathcal{K}, E, D)$.
  \end{definition}
\end{frame}

\subsection{Geschichtlicher Abriss}


\begin{frame}
  \frametitle{Geschichtlicher Abriss}
  \begin{itemize}
  \item Skytale
  \item Caesar"=Code
  \item Vigenère"=Chiffre (Friedman"=Test)
  \item ENIGMA
  \item DES
  \item Public"=Key"=Kryptographie und RSA
  \item Crypto for the masses: PGP, GnuPG, SSL, FDE
  \item ECC
  \item Quantenkryptographie
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{Geschichtlicher Abriss}
  \framesubtitle{Skytale}
\href{http://upload.wikimedia.org/wikipedia/commons/5/51/Skytale.png}{\includegraphics[width=.75\textwidth]{bilder/Skytale}}

Quelle:
\href{https://secure.wikimedia.org/wikipedia/en/wiki/Scytale}{Wikipedia:
Scytale}
\end{frame}

\subsection{Kryptoanalyse}


\begin{frame}
  \frametitle{Kryptoanalyse}
  Ziel der Kryptoanalyse ist es, aus einem bestehenden Geheimtext und
  eventuellen Zusatzinformationen den Klartext zu ermitteln. Einen
  Versuch bezeichnet man als \emph{Angriff}.
  \pause{}
  \begin{description}
  \item[Ciphertext-only] einer oder mehrere Chiffretexte sind bekannt.
  \item[Known-plaintext] Zu einigen Nachrichten ist sowohl Chiffrat
    wie auch Klartext bekannt.
  \item[Chosen-plaintext] Der zu verschlüsselnde Text kann vom
    Angreifer gewählt werden.
  \item[Adaptive-chosen-plaintext] Spezialfall von oben, basierend auf
    dem Ergebnis der Verschlüsselung wird Klartext modifiziert.
  \end{description}
\end{frame}

\begin{frame}
  \frametitle{Kryptoanalyse}
  \framesubtitle{Rubber-Hose-Angriff}
  \href{http://xkcd.com/538/}{\includegraphics[width=.75\textwidth]{bilder/security}}

  Quelle: \href{http://xkcd.com/}{xkcd}.
\end{frame}

\subsection{Verschlüsselungsalgorithmen}

\begin{frame}
  \frametitle{Substitution}
  \begin{definition}
    Eine \emph{Substitution} bezeichnet die Ersetzung eines
    Klartextbuchstaben durch einen Buchstaben des Chiffretexts.
  \end{definition}
  \pause{}
  Es gibt vier Typen von Substitutionschiffren:
  \begin{enumerate}
  \item Monoalphabetische Chiffre
  \item Homophone Substitutionschiffre
  \item Polygramchiffre
  \item polyalphabetische Chiffre
  \end{enumerate}
\end{frame}

\begin{frame}
  \frametitle{Substitution}
  \framesubtitle{Beispiele}
  \begin{exampleblock}{Freimaurercode}
    {\pigpenfont HEUTZUTAGE NUTZEN DAS EHER SCHULKINDER.}    
  \end{exampleblock}
  \begin{exampleblock}{Caesar-Chiffre}<2->
    KHXWCXWDJHQXWCHQGDVHKHUVFKXONLQGHU
  \end{exampleblock}
  \begin{exampleblock}{ROT-13}<3->
    \texttt{CZHLPDODQJHZHQGHWHUJLEWVLFKGHUNODUWHAW}
    \texttt{ZWEIMALANGEWENDETERGIBTSICHDERKLARTEXT}
  \end{exampleblock}
\end{frame}

\begin{frame}
  \frametitle{Transposition}
  \begin{definition}
    Eine \emph{Transposition} erhält den Klartext und ändert die
    Anordnung der Buchstaben.
  \end{definition}
\end{frame}

\begin{frame}
  \frametitle{Transposition}
  \framesubtitle{Beispiel}
  \begin{itemize}
  \item ADFGVX-Chiffre
  \item Enigma
  \end{itemize}
\end{frame}

\subsubsection{Symmetrische Chiffren}

\begin{frame}
  \frametitle{Symmetrische Chiffren}
  \begin{definition}
    Bei einer \emph{symmetrischen Chiffre} kann der Schlüssel zur
    Verschlüsselung $k_{e}$ aus dem Schlüssel zur Entschlüsselung
    $k_{d}$ und umgekehrt berechnet werden.
  \end{definition}
  
  Bei den meisten Algorithmen gilt: $k_{e}= k_{d}$.  
\end{frame}

\begin{frame}
  \frametitle{Strom- und Blockchiffren}
  Man unterscheidet zwei Arten von symmetrischen Chiffren:
  \begin{itemize}
  \item Stromchiffren
  \item Blockchiffren.
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{Betriebsmodi von Blockchiffren}
  Urspünglich in \href{http://www.itl.nist.gov/fipspubs/fip81.htm}{DES
  modes of operation (FIPS~81)} festgelegt: 
\begin{itemize}
\item Electronic Code Book (ECB)
\item Cipher Block Chaining (CBC)
\item Cipher Feedback (CFB)
\item Output Feedback (OFB)
\end{itemize}

Weitere wurden später entwickelt und spezifiziert. Beispiele sind der
\href{http://csrc.nist.gov/publications/nistpubs/800-38a/sp800-38a.pdf}{Counter
  Modus (CTR)} oder
\href{http://csrc.nist.gov/publications/nistpubs/800-38E/nist-sp-800-38E.pdf}{XEX
  Tweakable Block Cipher with Ciphertext Stealing (XTS-AES)}.
\end{frame}
\end{document}
