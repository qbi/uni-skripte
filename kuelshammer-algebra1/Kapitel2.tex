\chapter{Kongruenzen}
%%%%%%%%%%%%%%%%%%%
% Bemerkung 2.1
%%%%%%%%%%%%%%%%%%%
\begin{bem}\label{bem:2.1}
Bekanntlich ist eine \highl{Relation} ein Tripel $(M, N, R)$, wobei $M, N$ Mengen $R \subseteq M \times N$ sind. Statt $(x, y) \in R$ schreibt man meist $xRy$.\\
Eine \highl{"Aquivalenzrelation}{Äquivalenzrelation} auf einer Menge $M$ ist eine Relation der Form $\left(M,M,R\right)$ mit folgenden Eigenschaften:
\begin{enumerate}[(i)]
  \item $x \in M \Rightarrow xRx$ (Reflexivität)
  \item $xRy \Rightarrow yRx$ (Symmetrie)
  \item $xRy \wedge yRz \Rightarrow xRZ$ (Transitivität)
\end{enumerate}
Wichtige Beispiele sind die Kongruenz von Dreiecken oder die Ähnlichkeit von Matrizen. Für eine beliebige Äquivalenzrelation $(M, M, R)$ und $x \in M$ heißt $[x]_R := {y \in M \colon xRy}$ die Äquivalenzklasse von $x$ bezüglich $R$. Mit $M/R := \left\{[x]_R \colon x \in M\right\}$ bezeichnet man die Menge aller Äquivalenzklassen von $M$ bezüglich $R$. Bekanntlich sind für $x, y \in M$ die folgenden Eigenschaften gleichbedeutent:
\begin{enumerate}[(1)]
  \item $xRy$
  \item $[x]_R = [y]_R$
  \item $[x]_R \cap [y]_R \neq \varnothing$
\end{enumerate}
Daher ist $M/R$ eine Partition von $M$, d.h. eine Menge nichtleerer, paarweise disjunkter Teilmengen von $M$ mit Vereinigung $M$.\\
Bekanntlich erhält man umgekehrt zu jeder Partition $\mathcal{P}$ einer Menge $M$ eine Äquivalenzrelation $(M, M, R)$, wenn man definiert: \[xRy \colon \Leftrightarrow \exists \ P \in \mathcal{P} \colon x, y \in P.\] Ferner ist dann $M/R = \mathcal{P}$.\\
Daher sind Äquivalenzrelationen auf einer Menge $M$ und Partitionen von $M$ verschiedene Sichtweisen des gleichen mathematischen Sachverhaltes.
\end{bem}

%%%%%%%%%%%%%%%%%%%
% Definition 2.1
%%%%%%%%%%%%%%%%%%%
\begin{defi}
Seien $a, b \in \Z, m \in \N$ mit $m\mid a - b$. Dann nennt man $a$ kongruent zu $b$ \highl{Modulo}{modulo} $m$ und schreibt $a \equiv b\pmod m$.
\end{defi}

%%%%%%%%%%%%%%%%%%%
% Satz 2.1
%%%%%%%%%%%%%%%%%%%
\begin{satz}\label{satz:2.1}
Die Kongruenz modulo $m$ ist eine Äquivalenzrelation auf $\Z$. Ferner ist sie mit Addition und Multiplikation \emph{verträglich}, d.h. es gilt: \[a \equiv a'\pmod m \wedge b \equiv b'\pmod m \Rightarrow a \mystackrel{+}{\cdot} b \equiv a' \mystackrel{+}{\cdot}b'\pmod m.\]
\end{satz}

%%%%%%%%%%%%%%%%%%%
% Beweis
%%%%%%%%%%%%%%%%%%%
\begin{beweis}
\emph{Reflexivität:} $a \in \Z \Rightarrow m\mid 0 = a - a \Rightarrow a \equiv a\pmod m$\\
\emph{Symmetrie:} $a \equiv b\pmod m \Rightarrow m\mid a - b \Rightarrow m\mid -(a - b) = b - a \Rightarrow b \equiv a\pmod b$\\
\emph{Transivität:} $a \equiv b\pmod m \wedge b \equiv c\pmod m \Rightarrow m\mid a - b \wedge m\mid b - c \Rightarrow m\mid (a - b) + (b - c) = a - c \Rightarrow a \equiv c\pmod m$\\
\emph{Verträglichkeit:} Sei $a \equiv a'\pmod m$ und $b \equiv b'\pmod m$, d.h. $m\mid a - a'$ und $m\mid b - b'$. Dann ist $m\mid (a - a') + (b - b') = (a + b) - (a' + b')$, d.h. $a + b \equiv a' + b'\pmod m$. Außerdem ist $m\mid (a - a')b + a'(b - b') = ab - a'b'$, d.h. $ab \equiv a'b'\pmod m$.
\end{beweis}

%%%%%%%%%%%%%%%%%%%
% Bemerkung 2.2
%%%%%%%%%%%%%%%%%%%
\begin{bem}
Für $a \in \Z$ und $m \in \N$ heißt 
\[a + m\Z = \left\{a + mz\colon z \in \Z\right\} = \left\{\ldots, a - 2m, a - m, a, a + m, a + 2m, \ldots\right\}\] 
die Restklassen von $a$ modulo $m$. $\left( \text{z.B.: ist } 2 + 6\Z = \left\{\ldots, -10, -4, 2, 8, 14, \ldots\right\}\right)$ Die Bezeichnung "`\highl{Restklasse}"' erklärt sich folgendermaßen: Division mit Rest liefert $q, r \in \Z$ mit $a = qm + r$ und $0 \leq r < m$. Wegen $m\mid qm = a - r$ ist dann $a \equiv r\pmod m$, d.h. $a + m\Z = r + m\Z$.\\ 
(offenbar ist $a + m\Z$ die Äquivalenzklasse von $a$ bezüglich der Kongruenz modulo $m$)\\
Die Menge aller Restklassen ist also \[\left\{a + m\Z \colon a \in \Z\right\} = \left\{0 + m\Z, 1 + m\Z, \ldots, (m - 1) + m\Z\right\} =: \ZmZ{m}\]
Sind $r, s \in \left\{0, \ldots, m - 1\right\}$ mit $r \equiv s\pmod m$, so ist $m\mid r - s$ und $\left|r - s\right| < m$, also $r - s = 0$, d.h. $r = s$.\\
Also: $\left|\ZmZ{m}\right| = m$.
\end{bem}

%%%%%%%%%%%%%%%%%%%
% Satz 2.2
%%%%%%%%%%%%%%%%%%%
\begin{satz}\label{satz:2.2}
Für $a, b, c \in \Z$ und $m \in \N$ gilt:\\
\begin{enumerate}[(i)]
  \item $m\mid ab \wedge \ggT(a, m) = 1 \Rightarrow m\mid b$.
  \item $ab \equiv ac\pmod m \Leftrightarrow b \equiv c \pmod{\frac{m}{\ggT(a, m)}}$.
\end{enumerate}
\end{satz}

%%%%%%%%%%%%%%%%%%%
% Beweis
%%%%%%%%%%%%%%%%%%%
\begin{beweis}
\begin{enumerate}[(i)]
  \item Sei $\ggT(a, m) = 1$. Dann existieren $x, y \in \Z$ mit $xa + ym = 1$, d.h. $xab + ymb = b$. Aus $m\mid ab$ folgt $m\mid b$.
  \item \begin{itemize}
  	\item["`$\Rightarrow$"'] Sei $ab \equiv ac\pmod m$, d.h. $m\mid ab - ac$, etwa $a(b - c) = mz$ für ein $z \in \Z$. Dann $\frac{a}{d}\left(b - c\right) = \frac{m}{d}z$ mit $d := \ggT(a, m)$. Wegen $\ggT\left(\frac{a}{d}, \frac{m}{d}\right) = 1$ folgt aus (i): \[\frac{m}{d}\mid b - c \text{, d.h. } b \equiv c\pmod{\frac{m}{d}}\]
\item["`$\Leftarrow$"'] Sei $b \equiv c\pmod{\frac{m}{d}}$, d.h. $b - c = z\frac{m}{d}$ für ein $z \in \Z$.\\
Dann: $a(b - c) = zm\frac{a}{d}$, d.h. $ab \equiv ac\pmod m$.
\end{itemize}
\end{enumerate}
\end{beweis}

%%%%%%%%%%%%%%%%%%%
% Beispiel 2.1
%%%%%%%%%%%%%%%%%%%
\begin{bsp}[Vorsicht bei Division von Kongruenzen!]
$2 \cdot 6 \equiv 2 \cdot 2\pmod 8$, aber $6 \not\equiv 2\pmod 8$ siehe \autoref{satz:2.2}(ii)!
\end{bsp}

%%%%%%%%%%%%%%%%%%%
% Satz 2.3
%%%%%%%%%%%%%%%%%%%
\begin{satz}\label{satz:2.3}
Seien $a, b \in \Z, m \in \N$ und $d := \ggT(a, m)$. Genau dann hat die Kongruenz $ax \equiv b\pmod m$ eine Lösung $x \in \Z$, wenn $d\mid b$ gilt.\\
Gegebenenfalls bilden die Lösungen \emph{eine Vereinigung} (disjunkte Vereinigung) von $d$ Restklassen modulo $m$.
\end{satz}

%%%%%%%%%%%%%%%%%%%
% Beweis
%%%%%%%%%%%%%%%%%%%
\begin{beweis}
\begin{itemize}
	\item["`$\Rightarrow$"'] Sei $x \in \Z$ mit $ax \equiv b\pmod m$. Dann existiert $y \in \Z$ mit $ax - b = my$.\\
	Folglich: $d\mid ax - my = b$.\\

	\item["`$\Leftarrow$"'] Sei $d\mid b, a_0 := \frac{a}{d}, m_0 := \frac{m}{d}, b_0 := \frac{b}{d}$. Wegen $\ggT(a_0, m_0) = 	1$ existiert $y_0, z_0 \in \Z$ mit $1 = a_0y_0 + m_0z_0$. Daher: $b = \underbrace{a_0b}_{= ab_0}y_0 + \underbrace{m_0b}_{= 	mb_0}z_0 \equiv ax_0\pmod{m}$ mit $x_0 = b_0y_0 \left(\Rightarrow \text{ Existenz einer Lösung}\right)$\\
	Für $x \in \Z$ gilt: 
	\[\begin{array}{lcl}
	ax \equiv b\pmod m & \Leftrightarrow & ax = ax_0\pmod m\\
	& \stackrel{\autoref{satz:2.2}}{\Leftrightarrow} & x \equiv x_0\pmod m\\
	& \Leftrightarrow & x \in x_0 + m_0 \Z
	\end{array}\]
	Sei $z \in \Z$. Division mit Rest liefert $q, r \in \Z$ mit $z = qd + r$ und $0 \leq r < d$.\\
	Also: $zm_0 = q\underbrace{dm_0}_{= m} rm_0 \in rm_0 + m\Z$.\\
	Daher: $m_0\Z = \bigcup\limits_{r = 0}^{d - 1}(rm_0 + m\Z)$ und $x_0 + m_0\Z = \bigcup\limits_{r = 0}^{d - 1}(x_0 + rm_0 + 	m\Z)$
\end{itemize}
\end{beweis}

%%%%%%%%%%%%%%%%%%%
% Beispiel 2.2
%%%%%%%%%%%%%%%%%%%
\begin{bsp}
Zu lösen: $23x \equiv 17\pmod{100}$\\
Erweiterter euklidischer Algorithmus: 
$\begin{array}{llll}
1 & 0 & 100 & \\ 
0 & 1 & 23 & 4\\ 
1 & -4 & 8 & 2\\
-2 & 9 & 7 & 1\\
3 & -13 & 1 & \\
\end{array}$\\
Also: $1 = 3 \cdot 100 - 13 \cdot 23 \equiv 23 \cdot (-13)\pmod{100}$\\
$17 \equiv 23 \cdot (-13) \cdot 17 \equiv 23 \cdot (-221) \equiv 23 \cdot 79 \pmod{100}$
\end{bsp}

%%%%%%%%%%%%%%%%%%%
% Definition
%%%%%%%%%%%%%%%%%%%
\begin{defi}
Seien $a_1, \ldots, a_n \in \Z$.\\
Ein $k \in \N_0$ mit $a_1\mid k, \ldots, a_n\mid k$ heißt \highl{Kleinstes gemeinsames Vielfaches}{kleinstes gemeinsames Vielfaches(kgV)} von $a_1, \ldots, a_n$, wenn $k\mid m$ für alle $m \in \Z$ mit $a_1\mid m, \ldots, a_n\mid m$ gilt.
\end{defi}

%%%%%%%%%%%%%%%%%%%
% Bemerkung 2.3
%%%%%%%%%%%%%%%%%%%
\begin{bem}
Im Fall $a_i = 0$ für ein $i \in \left\{1, \ldots, n\right\}$ ist $0$ das einzige gemeinsame Vielfache, also auch das einzige kgV von $a_1, \ldots, a_n$.\\
Sei also $a_1 \cdot \ldots \cdot a_n \neq 0$, und sei $a_i = \prod\limits_{p \in \PZ} p^{b_{ip}}\ (i = 1, \ldots, n)$.\\
Die gemeinsamen Vielfachen von $a_1, \ldots, a_n$ haben dann die Form:
\[\prod_{p \in \PZ}p^{c_p} \text{ mit } c_p \geq \max{\left\{b_{1p}, \ldots, b_{np}\right\}} \text{ für alle } p \in \PZ.\]
Daher ist $k := \prod\limits_{p \in \PZ}p^{\max{\left\{b_{1p}, \ldots, b_{np}\right\}}}$ das einzige kgV von $a_1, \ldots, a_n$. Dies zeigt, dass beliebige $a_1, \ldots, a_n \in \Z$ stets genau ein kgV haben. Man schreibt: $k = \kgV(a_1, \ldots, a_n)$.
\end{bem}

%%%%%%%%%%%%%%%%%%%
% Satz 2.4
%%%%%%%%%%%%%%%%%%%
\begin{satz}\label{satz:2.4}
Für $a_1, \ldots, a_n \in \Z$ gilt stets:
\begin{enumerate}[(i)]
	\item $\kgV(a_1, \ldots, a_n) = \kgV(a_1, \kgV(a_2, \ldots, a_n))$ \randbem{(Assoziativgesetz)}
	\item $\kgV(a_1, \ggT(a_2, \ldots, a_n)) = \ggT(\kgV(a_1, a_2), \ldots, \kgV(a_1, a_n))$ \randbem{(Distributivgesetz)}
	\item $\ggT(a_1, \kgV(a_2, \ldots, a_n)) = \kgV(\ggT(a_1, a_2), \ldots, \ggT(a_1, a_n))$
\end{enumerate}
\end{satz}

%%%%%%%%%%%%%%%%%%%
% Beweis
%%%%%%%%%%%%%%%%%%%
\begin{beweis}
Wir beweisen nur (iii) [Rest analog].\\
Im Fall $a_1 = 0$ steht auf beiden Seiten $\kgV(a_2, \ldots, a_n)$.\\
Sei also $a_1 \neq 0$. Im Fall $a_i = 0$ für ein $i \in \left\{2, \ldots, n\right\}$ steht links $\ggT(a_1, 0) = a_1$.\\
Wegen $\ggT(a_1, a_2), \ldots, \ggT(a_1, a_n)\mid a_1 = \ggT(a_1, a_i)$ steht auch rechts $a_1$.\
Sei also $a_1 \cdot \ldots \cdot a_n \neq 0$. Schreibe $a_i = \prod\limits_{p \in \PZ}p^{b_{ip}} \ (i = 1, \ldots, n)$. Dann:
\[\text{\underline{links:}} \prod_{p \in \PZ}p^{\min{\left\{b_{1p}, \max{\left\{b_{2p}, \ldots, b_{np}\right\}}\right\}}} \ \ \ \text{ \underline{rechts:}} \prod_{p \in \PZ}p^{\max{\left\{\min{\left\{b_{1p}, b_{2p}\right\}}, \ldots, \min{\left\{b_{1p}, b_{np}\right\}}\right\}}}\]
Beide Seiten sind gleich, da für alle $p \in \PZ$ gilt:
\[\min{\left\{b_{1p}, \max{\left\{b_{2p}, \ldots, b_{np}\right\}}\right\}} = \max{\left\{\min{\left\{b_{1p}, b_{2p}\right\}}, \ldots, \min{\left\{b_{1p}, b_{np}\right\}}\right\}}\].
\end{beweis}

%%%%%%%%%%%%%%%%%%%
% Satz 2.5
%%%%%%%%%%%%%%%%%%%
\begin{satz}[Chinesischer Restsatz]\label{satz:2.5}
Seien $a_1, \ldots, a_k \in \Z$ und $m_1, \ldots, m_k$.\randbem{Stand in einem chinesischen Buch über Militärführung.} Genau dann ist das System von Kongruenzen:
\[(\ast) \ x \equiv a_i \pmod{m_i} \ \ (i = 1, \ldots, k)\]
simultan lösbar, wenn gilt:
\[(\ast\ast) \ a_i \equiv a_j \pmod{\ggT(m_i, m_j)} \ \ (i, j = 1, \ldots, k)\]
Gegebenenfalls bilden die Lösungen eine Restklasse modulo $\kgV(m_1, \ldots, m_k)$
\end{satz}

%%%%%%%%%%%%%%%%%%%
% Beweis
%%%%%%%%%%%%%%%%%%%
\begin{beweis}
\begin{itemize}
	\item["`$\Rightarrow$"'] Sei ($\ast$) erfüllt. Für $i, j = 1, \ldots, k$ gilt dann:\\
	$a_i \equiv x \equiv a_j \pmod{\ggT(m_i, m_j)}$.\\
	\item["`$\Leftarrow$"'] Sei ($\ast\ast$) erfüllt. Wie argumentieren mit Induktion.\\
	Im Fall $k = 1$ ist nichts zu tun. \footnotesize(können einfach $x = a_1$ wählen)\normalsize\\
	Sei also $k \geq 2$, $d := \ggT(m_1, m_2)$, $e := \kgV(m_1, m_2)$.\\
	Schreibe $d = ym_1 + zm_2 (y, z \in \Z)$.\\
	Setze: $b := a_1 + (a_2 - a_1)\frac{ym_1}{d} = a_2 + (a_1 - a_2)\frac{zm_2}{d}$.\\
	Dann: $b \equiv a_1 \pmod{m_1}$ \footnotesize ($a_1 \equiv a_2 \pmod{d} \Rightarrow d\mid a_2 - a_1$) \normalsize und $b \equiv a_2 \pmod{m_2}$.\\
	Im Fall $k = 2$ ist also ($\ast$) lösbar.\\
	Sei also $k \geq 3$. Für $i = 3, \ldots, k$ ist $a_i \equiv a_1 \equiv b \pmod{\ggT(m_i, m_1)}$ und $a_i \equiv a_2 \equiv b \pmod{\ggT(m_i, m_2)}$.\\
	Daraus folgt: $a_i \equiv b \pmod{\kgV(\ggT(m_i, m_1), \ggT(m_i, m_2))} \stackrel{\autoref{satz:2.3}(iii)}{=} \ggT(m_i, \kgV(m_1, m_2)) = \ggT(m_i, e)$.\\
Nach Induktion existiert ein $x \in \Z$ mit $x \equiv b \pmod{e}$ und $x \equiv a_i \pmod{m_i}$ für $i = 3, \ldots, k$ \footnotesize(Man muss hierfür ($\ast\ast$) für dieses System von Kongruenzen überprüfen)\\ \normalsize
Für $i = 1,2$ ist $x \stackrel{x \equiv b \pmod{e}}{\equiv} b \equiv a_i \pmod{m_i}$.\\
\emph{Eindeutigkeit:} Sei $x' \in \Z$ weitere Lösung von ($\ast$). Dann: $x' \equiv a_i \equiv x \pmod{m_i}$ für $i = 1, \ldots, k$, d.h. $x' \equiv x \pmod{\kgV(m_1, \ldots, m_k)}$. Dann ist $x' \equiv x \equiv a_i \pmod{m_i} \ \ (i = 1, \ldots, k)$, d.h. $x'$ ist auch Lösung von ($\ast$).
\end{itemize}
\end{beweis}

%%%%%%%%%%%%%%%%%%%
% Beispiel 2.3
%%%%%%%%%%%%%%%%%%%
\begin{bsp}\hfill\\
Zu Lösen: $(\ast) \left\{\begin{array}{lll}x & \equiv & 3 \pmod{14}\\ x & \equiv & 5 \pmod{12}\\ x & \equiv & 1 \pmod{10}\end{array}\right.$ \randbem{Um Lösbarkeit erstmal keine Gedanken machen, wird man schon im Laufe der Rechnung feststellen, anderenfalls $\Rightarrow$ ($\ast\ast$) muss man nicht zuerst überprüfen}\\
Allgemeine Lösung von $x \equiv 3 \pmod{14}$: $3 + 14\Z$\\
$3 + 14y \equiv 5 \pmod{12} \Leftrightarrow 2y \equiv 2 \pmod{12} \Leftarrow y = 1$ \randbem{Man braucht nicht allg. Lösung $\Rightarrow$ es reicht, wenn man eine sieht.}\\
$\kgV(14, 12) = 14 \cdot 6 = 84$\\
Allgemeine Lösung von $x \equiv 3 \pmod{14}$ und $x \equiv 5 \pmod{12}$: $17 + 84\Z$\\
$17 + 84z \equiv 1 \pmod{10} \Leftrightarrow 4z \equiv 4 \pmod{10} \Leftarrow z = 1$\\
$\kgV(84, 10) = 84 \cdot 5 = 420$\\
$\Rightarrow$ Allgemeine Lösung von ($\ast$): $101 + 420\Z$
\end{bsp}